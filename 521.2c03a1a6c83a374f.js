(self.webpackChunktool_box=self.webpackChunktool_box||[]).push([[521],{94902:($,e,E)=>{"use strict";E.r(e),E.d(e,{PdfToImgComponent:()=>u});var n=E(10467),f=E(73301),I=E(20717),k=E(60177),w=E(54438);function A(p,r){1&p&&w.EFF(0),2&p&&w.SpI(" ",r.$implicit.name," ")}let h=(()=>{class p{constructor(){this.onFileUploaded=new w.bkB,this.fileList=[]}onFileChosen(g){this.fileList=g.target?.files,this.onFileUploaded.emit(g)}static{this.\u0275fac=function(b){return new(b||p)}}static{this.\u0275cmp=w.VBU({type:p,selectors:[["app-file-uploader"]],outputs:{onFileUploaded:"onFileUploaded"},standalone:!0,features:[w.aNF],decls:8,vars:0,consts:[["for","file",1,"labelFile"],[1,"fa-solid","fa-cloud-arrow-up"],[1,"file-list"],["name","text","id","file","type","file","accept","application/pdf",1,"input",3,"change"]],template:function(b,M){1&b&&(w.j41(0,"label",0),w.nrm(1,"i",1),w.j41(2,"p"),w.EFF(3,"drag and drop your file here or click to select a file!"),w.k0s(),w.j41(4,"div",2),w.Z7z(5,A,1,1,null,null,w.fX1),w.k0s()(),w.j41(7,"input",3),w.bIt("change",function(D){return M.onFileChosen(D)}),w.k0s()),2&b&&(w.R7$(5),w.Dyx(M.fileList))},styles:[".input[_ngcontent-%COMP%]{max-width:190px;display:none}.labelFile[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;width:100%;height:190px;border:2px dashed #ccc;align-items:center;text-align:center;padding:5px;color:#b5b5b5;cursor:pointer}.labelFile[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem}.labelFile[_ngcontent-%COMP%]   .file-list[_ngcontent-%COMP%]{width:100%;text-align:center;font-weight:900}"]})}}return p})();function a(p,r){if(1&p&&(w.j41(0,"div",8),w.nrm(1,"img",9),w.k0s()),2&p){const g=r.$implicit;w.R7$(),w.Y8G("src",g,w.B4B)}}function d(p,r){if(1&p&&(w.j41(0,"div",4)(1,"h3",5),w.EFF(2,"Converted Images:"),w.k0s(),w.j41(3,"div",6),w.DNE(4,a,2,1,"div",7),w.k0s()()),2&p){const g=w.XpG();w.R7$(4),w.Y8G("ngForOf",g.images)}}let u=(()=>{class p{constructor(){this.images=[]}onFileSelected(g){var b=this;return(0,n.A)(function*(){const M=g.target.files[0];if(M){const T=new FileReader;T.readAsArrayBuffer(M),T.onload=(0,n.A)(function*(){T.result&&(yield b.convertPdfToImages(T.result))})}})()}convertPdfToImages(g){var b=this;return(0,n.A)(function*(){I.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";const M=yield I.getDocument({data:g}).promise;b.images=[];for(let T=1;T<=M.numPages;T++){const D=yield M.getPage(T),_=document.createElement("canvas"),s=_.getContext("2d"),l=D.getViewport({scale:2});_.width=l.width,_.height=l.height,s&&(yield D.render({canvasContext:s,viewport:l}).promise,b.images.push(_.toDataURL("image/png")))}})()}static{this.\u0275fac=function(b){return new(b||p)}}static{this.\u0275cmp=w.VBU({type:p,selectors:[["app-pdf-to-img"]],standalone:!0,features:[w.aNF],decls:4,vars:1,consts:[["header","PDF to Images","description","PDF to Images"],[1,"container"],[3,"onFileUploaded"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"m-0"],[1,"row"],["class","col-2 mt-2 image-container",4,"ngFor","ngForOf"],[1,"col-2","mt-2","image-container"],["alt","PDF Page",1,"pdf-image",3,"src"]],template:function(b,M){1&b&&(w.nrm(0,"app-page-header",0),w.j41(1,"div",1)(2,"app-file-uploader",2),w.bIt("onFileUploaded",function(D){return M.onFileSelected(D)}),w.k0s(),w.DNE(3,d,5,1,"div",3),w.k0s()),2&b&&(w.R7$(3),w.Y8G("ngIf",M.images.length))},dependencies:[f.y,k.bT,k.Sq,h],styles:[".image-container[_ngcontent-%COMP%]{width:200px}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}"]})}}return p})()},73301:($,e,E)=>{"use strict";E.d(e,{y:()=>f});var n=E(54438);let f=(()=>{class I{constructor(){this.header="",this.description=""}static{this.\u0275fac=function(A){return new(A||I)}}static{this.\u0275cmp=n.VBU({type:I,selectors:[["app-page-header"]],inputs:{header:"header",description:"description"},standalone:!0,features:[n.aNF],decls:5,vars:2,consts:[[1,"mb-0"],[1,"my-1"],[1,"text-muted"]],template:function(A,h){1&A&&(n.j41(0,"h1",0),n.EFF(1),n.k0s(),n.nrm(2,"hr",1),n.j41(3,"small",2),n.EFF(4),n.k0s()),2&A&&(n.R7$(),n.JRh(h.header),n.R7$(3),n.JRh(h.description))}})}}return I})()},20717:(module,__unused_webpack_exports,__webpack_require__)=>{var _asyncToGenerator=__webpack_require__(29293).default,E;globalThis,E=()=>(()=>{"use strict";var __webpack_modules__=[,($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.UNSUPPORTED_FEATURES=e.TextRenderingMode=e.StreamType=e.RenderingIntentFlag=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FontType=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.AnnotationType=e.AnnotationStateModelType=e.AnnotationReviewState=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationMarkedState=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.arrayByteLength=st,e.arraysToBytes=function it(Q){const G=Q.length;if(1===G&&Q[0]instanceof Uint8Array)return Q[0];let H=0;for(let dt=0;dt<G;dt++)H+=st(Q[dt]);let rt=0;const ct=new Uint8Array(H);for(let dt=0;dt<G;dt++){let ht=Q[dt];ht instanceof Uint8Array||(ht="string"==typeof ht?J(ht):new Uint8Array(ht));const Et=ht.byteLength;ct.set(ht,rt),rt+=Et}return ct},e.assert=function P(Q,G){Q||S(G)},e.bytesToString=function et(Q){("object"!=typeof Q||null===Q||void 0===Q.length)&&S("Invalid argument for bytesToString");const G=Q.length,H=8192;if(G<H)return String.fromCharCode.apply(null,Q);const rt=[];for(let ct=0;ct<G;ct+=H){const dt=Math.min(ct+H,G),ht=Q.subarray(ct,dt);rt.push(String.fromCharCode.apply(null,ht))}return rt.join("")},e.createPromiseCapability=function qt(){const Q=Object.create(null);let G=!1;return Object.defineProperty(Q,"settled",{get:()=>G}),Q.promise=new Promise(function(H,rt){Q.resolve=function(ct){G=!0,H(ct)},Q.reject=function(ct){G=!0,rt(ct)}}),Q},e.createValidAbsoluteUrl=function i(Q,G=null,H=null){if(!Q)return null;try{if(H&&"string"==typeof Q){if(H.addDefaultProtocol&&Q.startsWith("www.")){const ct=Q.match(/\./g);ct&&ct.length>=2&&(Q=`http://${Q}`)}if(H.tryConvertEncoding)try{Q=Rt(Q)}catch{}}const rt=G?new URL(Q,G):new URL(Q);if(function t(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(rt))return rt}catch{}return null},e.escapeString=function Tt(Q){return Q.replace(/([()\\\n\r])/g,G=>"\n"===G?"\\n":"\r"===G?"\\r":`\\${G}`)},e.getModificationDate=function Wt(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")},e.getVerbosityLevel=function C(){return B},e.info=function o(Q){B>=tt.INFOS&&console.log(`Info: ${Q}`)},e.isArrayBuffer=function Ut(Q){return"object"==typeof Q&&null!==Q&&void 0!==Q.byteLength},e.isArrayEqual=function Bt(Q,G){if(Q.length!==G.length)return!1;for(let H=0,rt=Q.length;H<rt;H++)if(Q[H]!==G[H])return!1;return!0},e.isAscii=function _t(Q){return/^[\x00-\x7F]*$/.test(Q)},e.objectFromMap=function nt(Q){const G=Object.create(null);for(const[H,rt]of Q)G[H]=rt;return G},e.objectSize=function ot(Q){return Object.keys(Q).length},e.setVerbosityLevel=function X(Q){Number.isInteger(Q)&&(B=Q)},e.shadow=m,e.string32=function at(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,255&Q)},e.stringToBytes=J,e.stringToPDFString=function At(Q){if(Q[0]>="\xef"){let H;if("\xfe"===Q[0]&&"\xff"===Q[1]?H="utf-16be":"\xff"===Q[0]&&"\xfe"===Q[1]?H="utf-16le":"\xef"===Q[0]&&"\xbb"===Q[1]&&"\xbf"===Q[2]&&(H="utf-8"),H)try{const rt=new TextDecoder(H,{fatal:!0}),ct=J(Q);return rt.decode(ct)}catch(rt){c(`stringToPDFString: "${rt}".`)}}const G=[];for(let H=0,rt=Q.length;H<rt;H++){const ct=St[Q.charCodeAt(H)];G.push(ct?String.fromCharCode(ct):Q.charAt(H))}return G.join("")},e.stringToUTF16BEString=function pt(Q){const G=["\xfe\xff"];for(let H=0,rt=Q.length;H<rt;H++){const ct=Q.charCodeAt(H);G.push(String.fromCharCode(ct>>8&255),String.fromCharCode(255&ct))}return G.join("")},e.stringToUTF8String=Rt,e.unreachable=S,e.utf8StringToString=function jt(Q){return unescape(encodeURIComponent(Q))},e.warn=c,E(2),e.IDENTITY_MATRIX=[1,0,0,1,0,0],e.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],e.LINE_FACTOR=1.35,e.LINE_DESCENT_FACTOR=.35,e.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},e.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},e.AnnotationEditorPrefix="pdfjs_internal_editor_",e.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},e.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},e.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},e.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},e.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},e.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},e.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},e.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},e.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},e.AnnotationReplyType={GROUP:"Group",REPLY:"R"},e.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},e.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},e.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},e.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},e.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},e.PageActionEventType={O:"PageOpen",C:"PageClose"},e.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},e.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const tt={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=tt,e.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},e.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},e.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},e.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let B=tt.WARNINGS;function c(Q){B>=tt.WARNINGS&&console.log(`Warning: ${Q}`)}function S(Q){throw new Error(Q)}function m(Q,G,H){return Object.defineProperty(Q,G,{value:H,enumerable:!0,configurable:!0,writable:!1}),H}const v=function(){function G(H,rt){this.constructor===G&&S("Cannot initialize BaseException."),this.message=H,this.name=rt}return G.prototype=new Error,G.constructor=G,G}();function J(Q){"string"!=typeof Q&&S("Invalid argument for stringToBytes");const G=Q.length,H=new Uint8Array(G);for(let rt=0;rt<G;++rt)H[rt]=255&Q.charCodeAt(rt);return H}function st(Q){return void 0!==Q.length?Q.length:void 0!==Q.byteLength?Q.byteLength:void S("Invalid argument for arrayByteLength")}e.BaseException=v,e.PasswordException=class x extends v{constructor(G,H){super(G,"PasswordException"),this.code=H}},e.UnknownErrorException=class O extends v{constructor(G,H){super(G,"UnknownErrorException"),this.details=H}},e.InvalidPDFException=class L extends v{constructor(G){super(G,"InvalidPDFException")}},e.MissingPDFException=class W extends v{constructor(G){super(G,"MissingPDFException")}},e.UnexpectedResponseException=class z extends v{constructor(G,H){super(G,"UnexpectedResponseException"),this.status=H}},e.FormatError=class q extends v{constructor(G){super(G,"FormatError")}},e.AbortException=class K extends v{constructor(G){super(G,"AbortException")}},e.FeatureTest=class lt{static get isLittleEndian(){return m(this,"isLittleEndian",function ft(){const Q=new Uint8Array(4);return Q[0]=1,1===new Uint32Array(Q.buffer,0,1)[0]}())}static get isEvalSupported(){return m(this,"isEvalSupported",function mt(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return m(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}};const ut=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class gt{static makeHexColor(G,H,rt){return`#${ut[G]}${ut[H]}${ut[rt]}`}static scaleMinMax(G,H){let rt;G[0]?(G[0]<0&&(rt=H[0],H[0]=H[1],H[1]=rt),H[0]*=G[0],H[1]*=G[0],G[3]<0&&(rt=H[2],H[2]=H[3],H[3]=rt),H[2]*=G[3],H[3]*=G[3]):(rt=H[0],H[0]=H[2],H[2]=rt,rt=H[1],H[1]=H[3],H[3]=rt,G[1]<0&&(rt=H[2],H[2]=H[3],H[3]=rt),H[2]*=G[1],H[3]*=G[1],G[2]<0&&(rt=H[0],H[0]=H[1],H[1]=rt),H[0]*=G[2],H[1]*=G[2]),H[0]+=G[4],H[1]+=G[4],H[2]+=G[5],H[3]+=G[5]}static transform(G,H){return[G[0]*H[0]+G[2]*H[1],G[1]*H[0]+G[3]*H[1],G[0]*H[2]+G[2]*H[3],G[1]*H[2]+G[3]*H[3],G[0]*H[4]+G[2]*H[5]+G[4],G[1]*H[4]+G[3]*H[5]+G[5]]}static applyTransform(G,H){return[G[0]*H[0]+G[1]*H[2]+H[4],G[0]*H[1]+G[1]*H[3]+H[5]]}static applyInverseTransform(G,H){const rt=H[0]*H[3]-H[1]*H[2];return[(G[0]*H[3]-G[1]*H[2]+H[2]*H[5]-H[4]*H[3])/rt,(-G[0]*H[1]+G[1]*H[0]+H[4]*H[1]-H[5]*H[0])/rt]}static getAxialAlignedBoundingBox(G,H){const rt=gt.applyTransform(G,H),ct=gt.applyTransform(G.slice(2,4),H),dt=gt.applyTransform([G[0],G[3]],H),ht=gt.applyTransform([G[2],G[1]],H);return[Math.min(rt[0],ct[0],dt[0],ht[0]),Math.min(rt[1],ct[1],dt[1],ht[1]),Math.max(rt[0],ct[0],dt[0],ht[0]),Math.max(rt[1],ct[1],dt[1],ht[1])]}static inverseTransform(G){const H=G[0]*G[3]-G[1]*G[2];return[G[3]/H,-G[1]/H,-G[2]/H,G[0]/H,(G[2]*G[5]-G[4]*G[3])/H,(G[4]*G[1]-G[5]*G[0])/H]}static apply3dTransform(G,H){return[G[0]*H[0]+G[1]*H[1]+G[2]*H[2],G[3]*H[0]+G[4]*H[1]+G[5]*H[2],G[6]*H[0]+G[7]*H[1]+G[8]*H[2]]}static singularValueDecompose2dScale(G){const H=[G[0],G[2],G[1],G[3]],rt=G[0]*H[0]+G[1]*H[2],ht=G[2]*H[1]+G[3]*H[3],Et=(rt+ht)/2,Pt=Math.sqrt((rt+ht)**2-4*(rt*ht-(G[2]*H[0]+G[3]*H[2])*(G[0]*H[1]+G[1]*H[3])))/2,yt=Et-Pt||1;return[Math.sqrt(Et+Pt||1),Math.sqrt(yt)]}static normalizeRect(G){const H=G.slice(0);return G[0]>G[2]&&(H[0]=G[2],H[2]=G[0]),G[1]>G[3]&&(H[1]=G[3],H[3]=G[1]),H}static intersect(G,H){const rt=Math.max(Math.min(G[0],G[2]),Math.min(H[0],H[2])),ct=Math.min(Math.max(G[0],G[2]),Math.max(H[0],H[2]));if(rt>ct)return null;const dt=Math.max(Math.min(G[1],G[3]),Math.min(H[1],H[3])),ht=Math.min(Math.max(G[1],G[3]),Math.max(H[1],H[3]));return dt>ht?null:[rt,dt,ct,ht]}static bezierBoundingBox(G,H,rt,ct,dt,ht,Et,Pt){const xt=[],yt=[[],[]];let wt,Ct,Mt,bt,Ot,Dt,It,Lt;for(let Nt=0;Nt<2;++Nt)if(0===Nt?(Ct=6*G-12*rt+6*dt,wt=-3*G+9*rt-9*dt+3*Et,Mt=3*rt-3*G):(Ct=6*H-12*ct+6*ht,wt=-3*H+9*ct-9*ht+3*Pt,Mt=3*ct-3*H),Math.abs(wt)<1e-12){if(Math.abs(Ct)<1e-12)continue;bt=-Mt/Ct,0<bt&&bt<1&&xt.push(bt)}else It=Ct*Ct-4*Mt*wt,Lt=Math.sqrt(It),!(It<0)&&(Ot=(-Ct+Lt)/(2*wt),0<Ot&&Ot<1&&xt.push(Ot),Dt=(-Ct-Lt)/(2*wt),0<Dt&&Dt<1&&xt.push(Dt));let vt,kt=xt.length;const Ft=kt;for(;kt--;)bt=xt[kt],vt=1-bt,yt[0][kt]=vt*vt*vt*G+3*vt*vt*bt*rt+3*vt*bt*bt*dt+bt*bt*bt*Et,yt[1][kt]=vt*vt*vt*H+3*vt*vt*bt*ct+3*vt*bt*bt*ht+bt*bt*bt*Pt;return yt[0][Ft]=G,yt[1][Ft]=H,yt[0][Ft+1]=Et,yt[1][Ft+1]=Pt,yt[0].length=yt[1].length=Ft+2,[Math.min(...yt[0]),Math.min(...yt[1]),Math.max(...yt[0]),Math.max(...yt[1])]}}e.Util=gt;const St=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Rt(Q){return decodeURIComponent(escape(Q))}},($,e,E)=>{E(3)},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeJS=void 0;const E=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);e.isNodeJS=E},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:$,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:E}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=$,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=E}function setPDFNetworkStreamFactory($){createPDFNetworkStream=$}function getDocument($){const e=new PDFDocumentLoadingTask;let E;if("string"==typeof $||$ instanceof URL)E={url:$};else if((0,_util.isArrayBuffer)($))E={data:$};else if($ instanceof PDFDataRangeTransport)E={range:$};else{if("object"!=typeof $)throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!$.url&&!$.data&&!$.range)throw new Error("Invalid parameter object: need either .data, .range or .url");E=$}const n=Object.create(null);let f=null,I=null;for(const w in E){const A=E[w];switch(w){case"url":if(typeof window<"u")try{n[w]=new URL(A,window.location).href;continue}catch(h){(0,_util.warn)(`Cannot create valid URL: "${h}".`)}else if("string"==typeof A||A instanceof URL){n[w]=A.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":f=A;continue;case"worker":I=A;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)n[w]=new Uint8Array(A);else{if(A instanceof Uint8Array)break;if("string"==typeof A)n[w]=(0,_util.stringToBytes)(A);else if("object"!=typeof A||null===A||isNaN(A.length)){if(!(0,_util.isArrayBuffer)(A))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");n[w]=new Uint8Array(A)}else n[w]=new Uint8Array(A)}continue}n[w]=A}if(n.CMapReaderFactory=n.CMapReaderFactory||DefaultCMapReaderFactory,n.StandardFontDataFactory=n.StandardFontDataFactory||DefaultStandardFontDataFactory,n.ignoreErrors=!0!==n.stopAtErrors,n.fontExtraProperties=!0===n.fontExtraProperties,n.pdfBug=!0===n.pdfBug,n.enableXfa=!0===n.enableXfa,(!Number.isInteger(n.rangeChunkSize)||n.rangeChunkSize<1)&&(n.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof n.docBaseUrl||(0,_display_utils.isDataScheme)(n.docBaseUrl))&&(n.docBaseUrl=null),(!Number.isInteger(n.maxImageSize)||n.maxImageSize<-1)&&(n.maxImageSize=-1),"string"!=typeof n.cMapUrl&&(n.cMapUrl=null),"string"!=typeof n.standardFontDataUrl&&(n.standardFontDataUrl=null),"boolean"!=typeof n.useWorkerFetch&&(n.useWorkerFetch=n.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&n.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof n.isEvalSupported&&(n.isEvalSupported=!0),"boolean"!=typeof n.disableFontFace&&(n.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof n.useSystemFonts&&(n.useSystemFonts=!_is_node.isNodeJS&&!n.disableFontFace),("object"!=typeof n.ownerDocument||null===n.ownerDocument)&&(n.ownerDocument=globalThis.document),"boolean"!=typeof n.disableRange&&(n.disableRange=!1),"boolean"!=typeof n.disableStream&&(n.disableStream=!1),"boolean"!=typeof n.disableAutoFetch&&(n.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(n.verbosity),!I){const w={verbosity:n.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};I=w.port?PDFWorker.fromPort(w):new PDFWorker(w),e._worker=I}const k=e.docId;return I.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const w=_fetchDocument(I,n,f,k),A=new Promise(function(h){let a;f?a=new _transport_stream.PDFDataTransportStream({length:n.length,initialData:n.initialData,progressiveDone:n.progressiveDone,contentDispositionFilename:n.contentDispositionFilename,disableRange:n.disableRange,disableStream:n.disableStream},f):n.data||(a=createPDFNetworkStream({url:n.url,length:n.length,httpHeaders:n.httpHeaders,withCredentials:n.withCredentials,rangeChunkSize:n.rangeChunkSize,disableRange:n.disableRange,disableStream:n.disableStream})),h(a)});return Promise.all([w,A]).then(function([h,a]){if(e.destroyed)throw new Error("Loading aborted");const d=new _message_handler.MessageHandler(k,h,I.port),u=new WorkerTransport(d,e,a,n);e._transport=u,d.send("Ready",null)})}).catch(e._capability.reject),e}function _fetchDocument($,e,E,n){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(function*($,e,E,n){if($.destroyed)throw new Error("Worker was destroyed");E&&(e.length=E.length,e.initialData=E.initialData,e.progressiveDone=E.progressiveDone,e.contentDispositionFilename=E.contentDispositionFilename);const f=yield $.messageHandler.sendWithPromise("GetDocRequest",{docId:n,apiVersion:"2.16.105",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,docBaseUrl:e.docBaseUrl,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties,enableXfa:e.enableXfa,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null});if(e.data&&(e.data=null),$.destroyed)throw new Error("Worker was destroyed");return f})).apply(this,arguments)}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){var e=this;return _asyncToGenerator(function*(){e.destroyed=!0,yield e._transport?.destroy(),e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)})()}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,E,n=!1,f=null){this.length=e,this.initialData=E,this.progressiveDone=n,this.contentDispositionFilename=f,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,E){for(const n of this._rangeListeners)n(e,E)}onDataProgress(e,E){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,E)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const E of this._progressiveReadListeners)E(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,E){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,E){var f,n=this;this._pdfInfo=e,this._transport=E,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:(f=_asyncToGenerator(function*(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),n.stats||{streamTypes:{},fontTypes:{}}}),function(){return f.apply(this,arguments)})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,E,n,f,I=!1){this._pageIndex=e,this._pageInfo=E,this._ownerDocument=f,this._transport=n,this._stats=I?new _display_utils.StatTimer:null,this._pdfBug=I,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:E=this.rotate,offsetX:n=0,offsetY:f=0,dontFlip:I=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:E,offsetX:n,offsetY:f,dontFlip:I})}getAnnotations({intent:e="display"}={}){const E=this._transport.getRenderingIntent(e);let n=this._annotationPromises.get(E.cacheKey);return n||(n=this._transport.getAnnotations(this._pageIndex,E.renderingIntent),this._annotationPromises.set(E.cacheKey,n),n=n.then(f=>{for(const I of f)void 0!==I.titleObj&&Object.defineProperty(I,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),I.titleObj.str)}),void 0!==I.contentsObj&&Object.defineProperty(I,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),I.contentsObj.str)});return f})),n}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}getXfa(){var e=this;return _asyncToGenerator(function*(){return e._transport._htmlForXfa?.children[e._pageIndex]||null})()}render({canvasContext:e,viewport:E,intent:n="display",annotationMode:f=_util.AnnotationMode.ENABLE,transform:I=null,imageLayer:k=null,canvasFactory:w=null,background:A=null,optionalContentConfigPromise:h=null,annotationCanvasMap:a=null,pageColors:d=null,printAnnotationStorage:u=null}){void 0!==arguments[0]?.renderInteractiveForms&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_FORMS)),void 0!==arguments[0]?.includeAnnotationStorage&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const p=this._transport.getRenderingIntent(n,f,u);this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let r=this._intentStates.get(p.cacheKey);r||(r=Object.create(null),this._intentStates.set(p.cacheKey,r)),r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null);const g=w||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),b=!!(p.renderingIntent&_util.RenderingIntentFlag.PRINT);r.displayReadyCapability||(r.displayReadyCapability=(0,_util.createPromiseCapability)(),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(p));const M=_=>{r.renderTasks.delete(T),(this.cleanupAfterRender||b)&&(this.pendingCleanup=!0),this._tryCleanup(),_?(T.capability.reject(_),this._abortOperatorList({intentState:r,reason:_ instanceof Error?_:new Error(_)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},T=new InternalRenderTask({callback:M,params:{canvasContext:e,viewport:E,transform:I,imageLayer:k,background:A},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:a,operatorList:r.operatorList,pageIndex:this._pageIndex,canvasFactory:g,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:d});(r.renderTasks||=new Set).add(T);const D=T.task;return Promise.all([r.displayReadyCapability.promise,h]).then(([_,s])=>{this.pendingCleanup?M():(this._stats&&this._stats.time("Rendering"),T.initializeGraphics({transparency:_,optionalContentConfig:s}),T.operatorListChanged())}).catch(M),D}getOperatorList({intent:e="display",annotationMode:E=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){const I=this._transport.getRenderingIntent(e,E,n,!0);let w,k=this._intentStates.get(I.cacheKey);return k||(k=Object.create(null),this._intentStates.set(I.cacheKey,k)),k.opListReadCapability||(w=Object.create(null),w.operatorListChanged=function f(){k.operatorList.lastChunk&&(k.opListReadCapability.resolve(k.operatorList),k.renderTasks.delete(w))},k.opListReadCapability=(0,_util.createPromiseCapability)(),(k.renderTasks||=new Set).add(w),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(I)),k.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:E=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==e,includeMarkedContent:!0===E},{highWaterMark:100,size:f=>f.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>_xfa_text.XfaText.textContent(n));const E=this.streamTextContent(e);return new Promise(function(n,f){const k=E.getReader(),w={items:[],styles:Object.create(null)};!function I(){k.read().then(function({value:A,done:h}){h?n(w):(Object.assign(w.styles,A.styles),w.items.push(...A.items),I())},f)}()})}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const E of this._intentStates.values())if(this._abortOperatorList({intentState:E,reason:new Error("Page was destroyed."),force:!0}),!E.opListReadCapability)for(const n of E.renderTasks)e.push(n.completed),n.cancel();this.objs.clear();for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:E,operatorList:n}of this._intentStates.values())if(E.size>0||!n.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,E){const n=this._intentStates.get(E);n&&(this._stats&&this._stats.timeEnd("Page Request"),n.displayReadyCapability&&n.displayReadyCapability.resolve(e))}_renderPageChunk(e,E){for(let n=0,f=e.length;n<f;n++)E.operatorList.fnArray.push(e.fnArray[n]),E.operatorList.argsArray.push(e.argsArray[n]);E.operatorList.lastChunk=e.lastChunk,E.operatorList.separateAnnots=e.separateAnnots;for(const n of E.renderTasks)n.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:E,annotationStorageMap:n}){const I=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:E,annotationStorage:n}).getReader(),k=this._intentStates.get(E);k.streamReader=I;const w=()=>{I.read().then(({value:A,done:h})=>{h?k.streamReader=null:this._transport.destroyed||(this._renderPageChunk(A,k),w())},A=>{if(k.streamReader=null,!this._transport.destroyed){if(k.operatorList){k.operatorList.lastChunk=!0;for(const h of k.renderTasks)h.operatorListChanged();this._tryCleanup()}if(k.displayReadyCapability)k.displayReadyCapability.reject(A);else{if(!k.opListReadCapability)throw A;k.opListReadCapability.reject(A)}}})};w()}_abortOperatorList({intentState:e,reason:E,force:n=!1}){if(e.streamReader){if(!n){if(e.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException)return void(e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:E,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(e.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[f,I]of this._intentStates)if(I===e){this._intentStates.delete(f);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,E){const n={data:structuredClone(e,E)};this._deferred.then(()=>{for(const f of this._listeners)f.call(this,n)})}addEventListener(e,E){this._listeners.push(E)}removeEventListener(e,E){const n=this._listeners.indexOf(E);this._listeners.splice(n,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const $=document?.currentScript?.src;$&&(PDFWorkerUtil.fallbackWorkerSrc=$.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function($,e){let E;try{if(E=new URL($),!E.origin||"null"===E.origin)return!1}catch{return!1}const n=new URL(e,E);return E.origin===n.origin},PDFWorkerUtil.createCDNWrapper=function($){return URL.createObjectURL(new Blob([`importScripts("${$}");`]))};class PDFWorker{static#workerPorts=new WeakMap;constructor({name:$=null,port:e=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){if(e&&PDFWorker.#workerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=$,this.destroyed=!1,this.verbosity=E,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e)return PDFWorker.#workerPorts.set(e,this),void this._initializeFromPort(e);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort($){this._port=$,this._messageHandler=new _message_handler.MessageHandler("main","worker",$),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:$}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,$)||($=PDFWorkerUtil.createCDNWrapper(new URL($,window.location).href));const e=new Worker($),E=new _message_handler.MessageHandler("main","worker",e),n=()=>{e.removeEventListener("error",f),E.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},f=()=>{this._webWorker||n()};e.addEventListener("error",f),E.on("test",k=>{e.removeEventListener("error",f),this.destroyed?n():k?(this._messageHandler=E,this._port=e,this._webWorker=e,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),e.terminate())}),E.on("ready",k=>{if(e.removeEventListener("error",f),this.destroyed)n();else try{I()}catch{this._setupFakeWorker()}});const I=()=>{const k=new Uint8Array;E.send("test",k,[k.buffer])};return void I()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then($=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new LoopbackPort;this._port=e;const E="fake"+PDFWorkerUtil.fakeWorkerId++,n=new _message_handler.MessageHandler(E+"_worker",E,e);$.setup(n,e);const f=new _message_handler.MessageHandler(E,E+"_worker",e);this._messageHandler=f,this._readyCapability.resolve(),f.send("configure",{verbosity:this.verbosity})}).catch($=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${$.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort($){if(!$?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has($.port)?this.#workerPorts.get($.port):new PDFWorker($)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){var _this4=this;const loader=function(){var _ref2=_asyncToGenerator(function*(){const mainWorkerMessageHandler=_this4._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(_this4.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(_this4.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return function $(){return _ref2.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#t=null;#e=new Map;#i=new Map;#n=null;constructor(e,E,n,f){this.messageHandler=e,this.loadingTask=E,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:E.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:f.ownerDocument,styleElement:f.styleElement}),this._params=f,f.useWorkerFetch||(this.CMapReaderFactory=new f.CMapReaderFactory({baseUrl:f.cMapUrl,isCompressed:f.cMapPacked}),this.StandardFontDataFactory=new f.StandardFontDataFactory({baseUrl:f.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#t}getRenderingIntent(e,E=_util.AnnotationMode.ENABLE,n=null,f=!1){let I=_util.RenderingIntentFlag.DISPLAY,k=null;switch(e){case"any":I=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":I=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(E){case _util.AnnotationMode.DISABLE:I+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:I+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:I+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,k=(I&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${E}`)}return f&&(I+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:I,cacheKey:`${I}_${_annotation_storage.AnnotationStorage.getHash(k)}`,annotationStorageMap:k}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#e.values())e.push(n._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const E=this.messageHandler.sendWithPromise("Terminate",null);return e.push(E),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#n=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:E}=this;e.on("GetReader",(n,f)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=I=>{this._lastProgress={loaded:I.loaded,total:I.total}},f.onPull=()=>{this._fullReader.read().then(function({value:I,done:k}){k?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(I),"GetReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(I),1,[I]))}).catch(I=>{f.error(I)})},f.onCancel=I=>{this._fullReader.cancel(I),f.ready.catch(k=>{if(!this.destroyed)throw k})}}),e.on("ReaderHeadersReady",n=>{const f=(0,_util.createPromiseCapability)(),I=this._fullReader;return I.headersReady.then(()=>{(!I.isStreamingSupported||!I.isRangeSupported)&&(this._lastProgress&&E.onProgress?.(this._lastProgress),I.onProgress=k=>{E.onProgress?.({loaded:k.loaded,total:k.total})}),f.resolve({isStreamingSupported:I.isStreamingSupported,isRangeSupported:I.isRangeSupported,contentLength:I.contentLength})},f.reject),f.promise}),e.on("GetRangeReader",(n,f)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const I=this._networkStream.getRangeReader(n.begin,n.end);I?(f.onPull=()=>{I.read().then(function({value:k,done:w}){w?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(k),"GetRangeReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(k),1,[k]))}).catch(k=>{f.error(k)})},f.onCancel=k=>{I.cancel(k),f.ready.catch(w=>{if(!this.destroyed)throw w})}):f.close()}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,E._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",function(n){let f;switch(n.name){case"PasswordException":f=new _util.PasswordException(n.message,n.code);break;case"InvalidPDFException":f=new _util.InvalidPDFException(n.message);break;case"MissingPDFException":f=new _util.MissingPDFException(n.message);break;case"UnexpectedResponseException":f=new _util.UnexpectedResponseException(n.message,n.status);break;case"UnknownErrorException":f=new _util.UnknownErrorException(n.message,n.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}E._capability.reject(f)}),e.on("PasswordRequest",n=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),E.onPassword){const f=I=>{I instanceof Error?this._passwordCapability.reject(I):this._passwordCapability.resolve({password:I})};try{E.onPassword(f,n.code)}catch(I){this._passwordCapability.reject(I)}}else this._passwordCapability.reject(new _util.PasswordException(n.message,n.code));return this._passwordCapability.promise}),e.on("DataLoaded",n=>{E.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{this.destroyed||this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,f,I])=>{if(!this.destroyed&&!this.commonObjs.has(n))switch(f){case"Font":const k=this._params;if("error"in I){const h=I.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}let w=null;k.pdfBug&&globalThis.FontInspector?.enabled&&(w={registerFont(h,a){globalThis.FontInspector.fontAdded(h,a)}});const A=new _font_loader.FontFaceObject(I,{isEvalSupported:k.isEvalSupported,disableFontFace:k.disableFontFace,ignoreErrors:k.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:w});this.fontLoader.bind(A).catch(h=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!k.fontExtraProperties&&A.data&&(A.data=null),this.commonObjs.resolve(n,A)});break;case"FontPath":case"Image":this.commonObjs.resolve(n,I);break;default:throw new Error(`Got unknown common object type ${f}`)}}),e.on("obj",([n,f,I,k])=>{if(this.destroyed)return;const w=this.#e.get(f);if(!w.objs.has(n))switch(I){case"Image":w.objs.resolve(n,k);const A=8e6;if(k){let h;if(k.bitmap){const{bitmap:a,width:d,height:u}=k;h=d*u*4,w._bitmaps.add(a)}else h=k.data?.length||0;h>A&&(w.cleanupAfterRender=!0)}break;case"Pattern":w.objs.resolve(n,k);break;default:throw new Error(`Got unknown object type ${I}`)}}),e.on("DocProgress",n=>{this.destroyed||E.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("DocStats",n=>{this.destroyed||(this.#t=Object.freeze({streamTypes:Object.freeze(n.streamTypes),fontTypes:Object.freeze(n.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const E=e-1,n=this.#i.get(E);if(n)return n;const f=this.messageHandler.sendWithPromise("GetPage",{pageIndex:E}).then(I=>{if(this.destroyed)throw new Error("Transport destroyed");const k=new PDFPageProxy(E,I,this,this._params.ownerDocument,this._params.pdfBug);return this.#e.set(E,k),k});return this.#i.set(E,f),f}getPageIndex(e){return"object"!=typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,E){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:E})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#n||=this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){var E=this;return _asyncToGenerator(function*(){if(yield E.messageHandler.sendWithPromise("Cleanup",null),!E.destroyed){for(const n of E.#e.values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);E.commonObjs.clear(),e||E.fontLoader.clear(),E.#n=null,E._getFieldObjectsPromise=null,E._hasJSActionsPromise=null}})()}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}class PDFObjects{#t=Object.create(null);#e(e){return this.#t[e]||(this.#t[e]={capability:(0,_util.createPromiseCapability)(),data:null})}get(e,E=null){if(E){const f=this.#e(e);return f.capability.promise.then(()=>E(f.data)),null}const n=this.#t[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){return this.#t[e]?.capability.settled||!1}resolve(e,E=null){const n=this.#e(e);n.data=E,n.capability.resolve()}clear(){this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(e){this.#t=e,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(){this.#t.cancel()}get separateAnnots(){const{separateAnnots:e}=this.#t.operatorList;if(!e)return!1;const{annotationCanvasMap:E}=this.#t;return e.form||e.canvas&&E?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:e,params:E,objs:n,commonObjs:f,annotationCanvasMap:I,operatorList:k,pageIndex:w,canvasFactory:A,useRequestAnimationFrame:h=!1,pdfBug:a=!1,pageColors:d=null}){this.callback=e,this.params=E,this.objs=n,this.commonObjs=f,this.annotationCanvasMap=I,this.operatorListIdx=null,this.operatorList=k,this._pageIndex=w,this.canvasFactory=A,this._pdfBug=a,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:E}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:f,transform:I,imageLayer:k,background:w}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,k,E,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:I,viewport:f,transparency:e,background:w}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){var e=this;return _asyncToGenerator(function*(){e.cancelled||(e.operatorListIdx=e.gfx.executeOperatorList(e.operatorList,e.operatorListIdx,e._continueBound,e.stepper),e.operatorListIdx===e.operatorList.argsArray.length&&(e.running=!1,e.operatorList.lastChunk&&(e.gfx.endDrawing(),e._canvas&&InternalRenderTask.#t.delete(e._canvas),e.callback())))})()}}const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=E(1),f=E(6),I=E(10);class k{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(h,a){const d=this._storage.get(h);return void 0===d?a:Object.assign(a,d)}getRawValue(h){return this._storage.get(h)}remove(h){if(this._storage.delete(h),0===this._storage.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const a of this._storage.values())if(a instanceof f.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(h,a){const d=this._storage.get(h);let u=!1;if(void 0!==d)for(const[p,r]of Object.entries(a))d[p]!==r&&(u=!0,d[p]=r);else u=!0,this._storage.set(h,a);u&&this.#t(),a instanceof f.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(a.constructor._type)}has(h){return this._storage.has(h)}getAll(){return this._storage.size>0?(0,n.objectFromMap)(this._storage):null}get size(){return this._storage.size}#t(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new w(this)}get serializable(){if(0===this._storage.size)return null;const h=new Map;for(const[a,d]of this._storage){const u=d instanceof f.AnnotationEditor?d.serialize():d;u&&h.set(a,u)}return h}static getHash(h){if(!h)return"";const a=new I.MurmurHash3_64;for(const[d,u]of h)a.update(`${d}:${JSON.stringify(u)}`);return a.hexdigest()}}e.AnnotationStorage=k;class w extends k{#t=null;constructor(h){super(),this.#t=structuredClone(h.serializable)}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}e.PrintAnnotationStorage=w},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=E(7),f=E(1);class I{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#i=!1;#n=!1;#r=!1;#h=I._zIndex++;static _colorManager=new n.ColorManager;static _zIndex=1;constructor(w){this.constructor===I&&(0,f.unreachable)("Cannot initialize AnnotationEditor."),this.parent=w.parent,this.id=w.id,this.width=this.height=null,this.pageIndex=w.parent.pageIndex,this.name=w.name,this.div=null;const[A,h]=this.parent.viewportBaseDimensions;this.x=w.x/A,this.y=w.y/h,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,f.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#h}focusin(w){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(w){!this.isAttachedToDOM||w.relatedTarget?.closest(`#${this.id}`)||(w.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(w){const A=this.parent.div.getBoundingClientRect();this.startX=w.clientX-A.x,this.startY=w.clientY-A.y,w.dataTransfer.setData("text/plain",this.id),w.dataTransfer.effectAllowed="move"}setAt(w,A,h,a){const[d,u]=this.parent.viewportBaseDimensions;[h,a]=this.screenToPageTranslation(h,a),this.x=(w+h)/d,this.y=(A+a)/u,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(w,A){const[h,a]=this.parent.viewportBaseDimensions;[w,A]=this.screenToPageTranslation(w,A),this.x+=w/h,this.y+=A/a,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(w,A){const{rotation:h}=this.parent.viewport;switch(h){case 90:return[A,-w];case 180:return[-w,-A];case 270:return[-A,w];default:return[w,A]}}setDims(w,A){const[h,a]=this.parent.viewportBaseDimensions;this.div.style.width=100*w/h+"%",this.div.style.height=100*A/a+"%"}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);const[w,A]=this.getInitialTranslation();return this.translate(w,A),(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(w){const A=n.KeyboardManager.platform.isMac;0!==w.button||w.ctrlKey&&A?w.preventDefault():(w.ctrlKey&&!A||w.shiftKey||w.metaKey&&A?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0)}getRect(w,A){const[h,a]=this.parent.viewportBaseDimensions,[d,u]=this.parent.pageDimensions,p=d*w/h,r=u*A/a,g=this.x*d,b=this.y*u,M=this.width*d,T=this.height*u;switch(this.rotation){case 0:return[g+p,u-b-r-T,g+p+M,u-b-r];case 90:return[g+r,u-b+p,g+r+T,u-b+p+M];case 180:return[g-p-M,u-b+r,g-p,u-b+r+T];case 270:return[g-r-T,u-b-p-M,g-r,u-b-p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(w,A){const[h,a,d,u]=w,p=d-h,r=u-a;switch(this.rotation){case 0:return[h,A-u,p,r];case 90:return[h,A-a,r,p];case 180:return[d,A-a,p,r];case 270:return[d,A-u,r,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,f.unreachable)("An editor must be serializable")}static deserialize(w,A){const h=new this.prototype.constructor({parent:A,id:A.getNextId()});h.rotation=w.rotation;const[a,d]=A.pageDimensions,[u,p,r,g]=h.getRectInCurrentCoords(w.rect,d);return h.x=u/a,h.y=p/d,h.width=r/a,h.height=g/d,h}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(w,A){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#n}set isEditing(w){this.#n=w,w?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}e.AnnotationEditor=I},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=function I(p,r,g){for(const b of g)r.addEventListener(b,p[b].bind(p))},e.opacityToHex=function k(p){return Math.round(Math.min(255,Math.max(1,255*p))).toString(16).padStart(2,"0")};var n=E(1),f=E(8);class w{#t=0;getId(){return`${n.AnnotationEditorPrefix}${this.#t++}`}}class A{#t=[];#e=!1;#i;#n=-1;constructor(r=128){this.#i=r}add({cmd:r,undo:g,mustExec:b,type:M=NaN,overwriteIfSameType:T=!1,keepUndo:D=!1}){if(b&&r(),this.#e)return;const _={cmd:r,undo:g,type:M};if(-1===this.#n)return this.#t.length>0&&(this.#t.length=0),this.#n=0,void this.#t.push(_);if(T&&this.#t[this.#n].type===M)return D&&(_.undo=this.#t[this.#n].undo),void(this.#t[this.#n]=_);const s=this.#n+1;s===this.#i?this.#t.splice(0,1):(this.#n=s,s<this.#t.length&&this.#t.splice(s)),this.#t.push(_)}undo(){-1!==this.#n&&(this.#e=!0,this.#t[this.#n].undo(),this.#e=!1,this.#n-=1)}redo(){this.#n<this.#t.length-1&&(this.#n+=1,this.#e=!0,this.#t[this.#n].cmd(),this.#e=!1)}hasSomethingToUndo(){return-1!==this.#n}hasSomethingToRedo(){return this.#n<this.#t.length-1}destroy(){this.#t=null}}e.CommandManager=A;class h{constructor(r){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const g=h.platform.isMac;for(const[b,M]of r)for(const T of b){const D=T.startsWith("mac+");g&&D?(this.callbacks.set(T.slice(4),M),this.allKeys.add(T.split("+").at(-1))):!g&&!D&&(this.callbacks.set(T,M),this.allKeys.add(T.split("+").at(-1)))}}static get platform(){const r=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:r.includes("Win"),isMac:r.includes("Mac")})}#t(r){r.altKey&&this.buffer.push("alt"),r.ctrlKey&&this.buffer.push("ctrl"),r.metaKey&&this.buffer.push("meta"),r.shiftKey&&this.buffer.push("shift"),this.buffer.push(r.key);const g=this.buffer.join("+");return this.buffer.length=0,g}exec(r,g){if(!this.allKeys.has(g.key))return;const b=this.callbacks.get(this.#t(g));b&&(b.bind(r)(),g.stopPropagation(),g.preventDefault())}}e.KeyboardManager=h;class a{#t=null;copy(r){r&&(Array.isArray(r)?this.#t=r.map(g=>g.serialize()):this.#t=[r.serialize()],this.#t=this.#t.filter(g=>!!g),0===this.#t.length&&(this.#t=null))}paste(){return this.#t}isEmpty(){return null===this.#t}destroy(){this.#t=null}}class d{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const r=new Map([["CanvasText",null],["Canvas",null]]);return(0,f.getColorValues)(r),(0,n.shadow)(this,"_colors",r)}convert(r){const g=(0,f.getRGB)(r);if(!window.matchMedia("(forced-colors: active)").matches)return g;for(const[b,M]of this._colors)if(M.every((T,D)=>T===g[D]))return d._colorsMapping.get(b);return g}getHexCode(r){const g=this._colors.get(r);return g?n.Util.makeHexColor(...g):r}}e.ColorManager=d;class u{#t=null;#e=new Map;#i=new Map;#n=new a;#r=new A;#h=0;#o=null;#s=null;#u=new w;#l=!1;#c=n.AnnotationEditorType.NONE;#a=new Set;#m=this.keydown.bind(this);#p=this.onEditingAction.bind(this);#C=this.onPageChanging.bind(this);#T={isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#b=null;static _keyboardManager=new h([[["ctrl+a","mac+meta+a"],u.prototype.selectAll],[["ctrl+c","mac+meta+c"],u.prototype.copy],[["ctrl+v","mac+meta+v"],u.prototype.paste],[["ctrl+x","mac+meta+x"],u.prototype.cut],[["ctrl+z","mac+meta+z"],u.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],u.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],u.prototype.delete],[["Escape","mac+Escape"],u.prototype.unselectAll]]);constructor(r,g){this.#b=r,this.#s=g,this.#s._on("editingaction",this.#p),this.#s._on("pagechanging",this.#C)}destroy(){this.#y(),this.#s._off("editingaction",this.#p),this.#s._off("pagechanging",this.#C);for(const r of this.#i.values())r.destroy();this.#i.clear(),this.#e.clear(),this.#t=null,this.#a.clear(),this.#n.destroy(),this.#r.destroy()}onPageChanging({pageNumber:r}){this.#h=r-1}focusMainContainer(){this.#b.focus()}#x(){this.#b.addEventListener("keydown",this.#m)}#y(){this.#b.removeEventListener("keydown",this.#m)}keydown(r){this.getActive()?.shouldGetKeyboardEvents()||u._keyboardManager.exec(this,r)}onEditingAction(r){["undo","redo","cut","copy","paste","delete","selectAll"].includes(r.name)&&this[r.name]()}#d(r){Object.entries(r).some(([b,M])=>this.#T[b]!==M)&&this.#s.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#T,r)})}#A(r){this.#s.dispatch("annotationeditorparamschanged",{source:this,details:r})}setEditingState(r){r?(this.#x(),this.#d({isEditing:this.#c!==n.AnnotationEditorType.NONE,isEmpty:this.#g(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:this.#n.isEmpty()})):(this.#y(),this.#d({isEditing:!1}))}registerEditorTypes(r){this.#o=r;for(const g of this.#o)this.#A(g.defaultPropertiesToUpdate)}getId(){return this.#u.getId()}addLayer(r){this.#i.set(r.pageIndex,r),this.#l?r.enable():r.disable()}removeLayer(r){this.#i.delete(r.pageIndex)}updateMode(r){if(this.#c=r,r===n.AnnotationEditorType.NONE)this.setEditingState(!1),this.#f();else{this.setEditingState(!0),this.#P();for(const g of this.#i.values())g.updateMode(r)}}updateToolbar(r){r!==this.#c&&this.#s.dispatch("switchannotationeditormode",{source:this,mode:r})}updateParams(r,g){for(const b of this.#a)b.updateParams(r,g);for(const b of this.#o)b.updateDefaultParams(r,g)}#P(){if(!this.#l){this.#l=!0;for(const r of this.#i.values())r.enable()}}#f(){if(this.unselectAll(),this.#l){this.#l=!1;for(const r of this.#i.values())r.disable()}}getEditors(r){const g=[];for(const b of this.#e.values())b.pageIndex===r&&g.push(b);return g}getEditor(r){return this.#e.get(r)}addEditor(r){this.#e.set(r.id,r)}removeEditor(r){this.#e.delete(r.id),this.unselect(r)}#v(r){const g=this.#i.get(r.pageIndex);g?g.addOrRebuild(r):this.addEditor(r)}setActiveEditor(r){this.#t!==r&&(this.#t=r,r&&this.#A(r.propertiesToUpdate))}toggleSelected(r){if(this.#a.has(r))return this.#a.delete(r),r.unselect(),void this.#d({hasSelectedEditor:this.hasSelection});this.#a.add(r),r.select(),this.#A(r.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}setSelected(r){for(const g of this.#a)g!==r&&g.unselect();this.#a.clear(),this.#a.add(r),r.select(),this.#A(r.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}isSelected(r){return this.#a.has(r)}unselect(r){r.unselect(),this.#a.delete(r),this.#d({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#a.size}undo(){this.#r.undo(),this.#d({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#g()})}redo(){this.#r.redo(),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#g()})}addCommands(r){this.#r.add(r),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#g()})}#g(){if(0===this.#e.size)return!0;if(1===this.#e.size)for(const r of this.#e.values())return r.isEmpty();return!1}delete(){if(this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const r=[...this.#a];this.addCommands({cmd:()=>{for(const M of r)M.remove()},undo:()=>{for(const M of r)this.#v(M)},mustExec:!0})}copy(){if(this.#t&&this.#t.commitOrRemove(),this.hasSelection){const r=[];for(const g of this.#a)g.isEmpty()||r.push(g);if(0===r.length)return;this.#n.copy(r),this.#d({hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(this.#n.isEmpty())return;this.unselectAll();const r=this.#i.get(this.#h),g=this.#n.paste().map(T=>r.deserialize(T));this.addCommands({cmd:()=>{for(const T of g)this.#v(T);this.#_(g)},undo:()=>{for(const T of g)T.remove()},mustExec:!0})}#_(r){this.#a.clear();for(const g of r)g.isEmpty()||(this.#a.add(g),g.select());this.#d({hasSelectedEditor:!0})}selectAll(){for(const r of this.#a)r.commit();this.#_(this.#e.values())}unselectAll(){if(this.#t)this.#t.commitOrRemove();else if(0!==this.#_.size){for(const r of this.#a)r.unselect();this.#a.clear(),this.#d({hasSelectedEditor:!1})}}isActive(r){return this.#t===r}getActive(){return this.#t}getMode(){return this.#c}}e.AnnotationEditorUIManager=u},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=function y(V){console.log("Deprecated API usage: "+V)},e.getColorValues=function tt(V){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const B of V.keys()){U.style.color=B;const X=window.getComputedStyle(U).color;V.set(B,N(X))}U.remove()},e.getCurrentTransform=function Z(V){const{a:U,b:B,c:X,d:C,e:o,f:c}=V.getTransform();return[U,B,X,C,o,c]},e.getCurrentTransformInverse=function Y(V){const{a:U,b:B,c:X,d:C,e:o,f:c}=V.getTransform().invertSelf();return[U,B,X,C,o,c]},e.getFilenameFromUrl=function T(V){const U=V.indexOf("#"),B=V.indexOf("?"),X=Math.min(U>0?U:V.length,B>0?B:V.length);return V.substring(V.lastIndexOf("/",X)+1,X)},e.getPdfFilenameFromUrl=function D(V,U="document.pdf"){if("string"!=typeof V)return U;if(b(V))return(0,f.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const X=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,C=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(V);let o=X.exec(C[1])||X.exec(C[2])||X.exec(C[3]);if(o&&(o=o[0],o.includes("%")))try{o=X.exec(decodeURIComponent(o))[0]}catch{}return o||U},e.getRGB=N,e.getXfaPageViewport=function j(V,{scale:U=1,rotation:B=0}){const{width:X,height:C}=V.attributes.style,o=[0,0,parseInt(X),parseInt(C)];return new r({viewBox:o,scale:U,rotation:B})},e.isDataScheme=b,e.isPdfFile=function M(V){return"string"==typeof V&&/\.pdf$/i.test(V)},e.isValidFetchUrl=s,e.loadScript=function l(V,U=!1){return new Promise((B,X)=>{const C=document.createElement("script");C.src=V,C.onload=function(o){U&&C.remove(),B(o)},C.onerror=function(){X(new Error(`Cannot load script at: ${C.src}`))},(document.head||document.documentElement).append(C)})};var n=E(9),f=E(1);function h(V){return a.apply(this,arguments)}function a(){return(a=_asyncToGenerator(function*(V,U=!1){if(s(V,document.baseURI)){const B=yield fetch(V);if(!B.ok)throw new Error(B.statusText);return U?new Uint8Array(yield B.arrayBuffer()):(0,f.stringToBytes)(yield B.text())}return new Promise((B,X)=>{const C=new XMLHttpRequest;C.open("GET",V,!0),U&&(C.responseType="arraybuffer"),C.onreadystatechange=()=>{if(C.readyState===XMLHttpRequest.DONE){if(200===C.status||0===C.status){let o;if(U&&C.response?o=new Uint8Array(C.response):!U&&C.responseText&&(o=(0,f.stringToBytes)(C.responseText)),o)return void B(o)}X(new Error(C.statusText))}},C.send(null)})})).apply(this,arguments)}e.AnnotationPrefix="pdfjs_internal_id_",e.PixelsPerInch=class w{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF},e.DOMCanvasFactory=class A extends n.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,B){const X=this._document.createElement("canvas");return X.width=U,X.height=B,X}},e.DOMCMapReaderFactory=class d extends n.BaseCMapReaderFactory{_fetchData(U,B){return h(U,this.isCompressed).then(X=>({cMapData:X,compressionType:B}))}},e.DOMStandardFontDataFactory=class u extends n.BaseStandardFontDataFactory{_fetchData(U){return h(U,!0)}},e.DOMSVGFactory=class p extends n.BaseSVGFactory{_createSVG(U){return document.createElementNS("http://www.w3.org/2000/svg",U)}};class r{constructor({viewBox:U,scale:B,rotation:X,offsetX:C=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=U,this.scale=B,this.rotation=X,this.offsetX=C,this.offsetY=o;const S=(U[2]+U[0])/2,P=(U[3]+U[1])/2;let t,i,m,v,x,O,L,W;switch((X%=360)<0&&(X+=360),X){case 180:t=-1,i=0,m=0,v=1;break;case 90:t=0,i=1,m=1,v=0;break;case 270:t=0,i=-1,m=-1,v=0;break;case 0:t=1,i=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(m=-m,v=-v),0===t?(x=Math.abs(P-U[1])*B+C,O=Math.abs(S-U[0])*B+o,L=Math.abs(U[3]-U[1])*B,W=Math.abs(U[2]-U[0])*B):(x=Math.abs(S-U[0])*B+C,O=Math.abs(P-U[1])*B+o,L=Math.abs(U[2]-U[0])*B,W=Math.abs(U[3]-U[1])*B),this.transform=[t*B,i*B,m*B,v*B,x-t*B*S-m*B*P,O-i*B*S-v*B*P],this.width=L,this.height=W}clone({scale:U=this.scale,rotation:B=this.rotation,offsetX:X=this.offsetX,offsetY:C=this.offsetY,dontFlip:o=!1}={}){return new r({viewBox:this.viewBox.slice(),scale:U,rotation:B,offsetX:X,offsetY:C,dontFlip:o})}convertToViewportPoint(U,B){return f.Util.applyTransform([U,B],this.transform)}convertToViewportRectangle(U){const B=f.Util.applyTransform([U[0],U[1]],this.transform),X=f.Util.applyTransform([U[2],U[3]],this.transform);return[B[0],B[1],X[0],X[1]]}convertToPdfPoint(U,B){return f.Util.applyInverseTransform([U,B],this.transform)}}function b(V){const U=V.length;let B=0;for(;B<U&&""===V[B].trim();)B++;return"data:"===V.substring(B,B+5).toLowerCase()}function s(V,U){try{const{protocol:B}=U?new URL(V,U):new URL(V);return"http:"===B||"https:"===B}catch{return!1}}let F;function N(V){if(V.startsWith("#")){const U=parseInt(V.slice(1),16);return[(16711680&U)>>16,(65280&U)>>8,255&U]}return V.startsWith("rgb(")?V.slice(4,-1).split(",").map(U=>parseInt(U)):V.startsWith("rgba(")?V.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,f.warn)(`Not a valid color format: "${V}"`),[0,0,0])}e.PageViewport=r,e.RenderingCancelledException=class g extends f.BaseException{constructor(U,B){super(U,"RenderingCancelledException"),this.type=B}},e.StatTimer=class _{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,f.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,f.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let B=0;for(const X of this.times){const C=X.name;C.length>B&&(B=C.length)}for(const X of this.times){const C=X.end-X.start;U.push(`${X.name.padEnd(B)} ${C}ms\n`)}return U.join("")}},e.PDFDateString=class R{static toDateObject(U){if(!U||"string"!=typeof U)return null;F||(F=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const B=F.exec(U);if(!B)return null;const X=parseInt(B[1],10);let C=parseInt(B[2],10);C=C>=1&&C<=12?C-1:0;let o=parseInt(B[3],10);o=o>=1&&o<=31?o:1;let c=parseInt(B[4],10);c=c>=0&&c<=23?c:0;let S=parseInt(B[5],10);S=S>=0&&S<=59?S:0;let P=parseInt(B[6],10);P=P>=0&&P<=59?P:0;const t=B[7]||"Z";let i=parseInt(B[8],10);i=i>=0&&i<=23?i:0;let m=parseInt(B[9],10)||0;return m=m>=0&&m<=59?m:0,"-"===t?(c+=i,S+=m):"+"===t&&(c-=i,S-=m),new Date(Date.UTC(X,C,o,c,S,P))}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=E(1);class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,a){if(h<=0||a<=0)throw new Error("Invalid canvas size");const d=this._createCanvas(h,a);return{canvas:d,context:d.getContext("2d")}}reset(h,a,d){if(!h.canvas)throw new Error("Canvas is not specified");if(a<=0||d<=0)throw new Error("Invalid canvas size");h.canvas.width=a,h.canvas.height=d}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,a){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=f;class I{constructor({baseUrl:h=null,isCompressed:a=!1}){this.constructor===I&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=a}fetch({name:h}){var a=this;return _asyncToGenerator(function*(){if(!a.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const d=a.baseUrl+h+(a.isCompressed?".bcmap":"");return a._fetchData(d,a.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE).catch(p=>{throw new Error(`Unable to load ${a.isCompressed?"binary ":""}CMap at: ${d}`)})})()}_fetchData(h,a){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=I;class k{constructor({baseUrl:h=null}){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}fetch({filename:h}){var a=this;return _asyncToGenerator(function*(){if(!a.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const d=`${a.baseUrl}${h}`;return a._fetchData(d).catch(u=>{throw new Error(`Unable to load font data at: ${d}`)})})()}_fetchData(h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=k;class w{constructor(){this.constructor===w&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,a,d=!1){if(h<=0||a<=0)throw new Error("Invalid SVG dimensions");const u=this._createSVG("svg:svg");return u.setAttribute("version","1.1"),d||(u.setAttribute("width",`${h}px`),u.setAttribute("height",`${a}px`)),u.setAttribute("preserveAspectRatio","none"),u.setAttribute("viewBox",`0 0 ${h} ${a}`),u}createElement(h){if("string"!=typeof h)throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=w},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=E(1);const f=3285377520,I=4294901760,k=65535;e.MurmurHash3_64=class w{constructor(h){this.h1=h?4294967295&h:f,this.h2=h?4294967295&h:f}update(h){let a,d;if("string"==typeof h){a=new Uint8Array(2*h.length),d=0;for(let y=0,F=h.length;y<F;y++){const R=h.charCodeAt(y);R<=255?a[d++]=R:(a[d++]=R>>>8,a[d++]=255&R)}}else{if(!(0,n.isArrayBuffer)(h))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");a=h.slice(),d=a.byteLength}const u=d>>2,p=d-4*u,r=new Uint32Array(a.buffer,0,u);let g=0,b=0,M=this.h1,T=this.h2;const D=3432918353,_=461845907,s=D&k,l=_&k;for(let y=0;y<u;y++)1&y?(g=r[y],g=g*D&I|g*s&k,g=g<<15|g>>>17,g=g*_&I|g*l&k,M^=g,M=M<<13|M>>>19,M=5*M+3864292196):(b=r[y],b=b*D&I|b*s&k,b=b<<15|b>>>17,b=b*_&I|b*l&k,T^=b,T=T<<13|T>>>19,T=5*T+3864292196);switch(g=0,p){case 3:g^=a[4*u+2]<<16;case 2:g^=a[4*u+1]<<8;case 1:g^=a[4*u],g=g*D&I|g*s&k,g=g<<15|g>>>17,g=g*_&I|g*l&k,1&u?M^=g:T^=g}this.h1=M,this.h2=T}hexdigest(){let h=this.h1,a=this.h2;h^=a>>>1,h=3981806797*h&I|36045*h&k,a=4283543511*a&I|(2950163797*(a<<16|h>>>16)&I)>>>16,h^=a>>>1,h=444984403*h&I|60499*h&k,a=3301882366*a&I|(3120437893*(a<<16|h>>>16)&I)>>>16,h^=a>>>1;const d=(h>>>0).toString(16),u=(a>>>0).toString(16);return d.padStart(8,"0")+u.padStart(8,"0")}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=E(1);class f{constructor({docId:A,onUnsupportedFeature:h,ownerDocument:a=globalThis.document,styleElement:d=null}){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=A,this._onUnsupportedFeature=h,this._document=a,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(A){this.nativeFontFaces.push(A),this._document.fonts.add(A)}insertRule(A){let h=this.styleElement;h||(h=this.styleElement=this._document.createElement("style"),h.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(h));const a=h.sheet;a.insertRule(A,a.cssRules.length)}clear(){for(const A of this.nativeFontFaces)this._document.fonts.delete(A);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}bind(A){var h=this;return _asyncToGenerator(function*(){if(A.attached||A.missingFile)return;if(A.attached=!0,h.isFontLoadingAPISupported){const d=A.createNativeFontFace();if(d){h.addNativeFontFace(d);try{yield d.loaded}catch(u){throw h._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${d.family}': '${u}'.`),A.disableFontFace=!0,u}}return}const a=A.createFontFaceRule();if(a){if(h.insertRule(a),h.isSyncFontLoadingSupported)return;yield new Promise(d=>{const u=h._queueLoadingCallback(d);h._prepareFontLoadEvent([a],[A],u)})}})()}_queueLoadingCallback(A){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){return(0,n.shadow)(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(A,h,a){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let I;e.FontLoader=I,e.FontLoader=I=class extends f{constructor(A){super(A),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let A=!1;return(typeof navigator>"u"||/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14)&&(A=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",A)}_queueLoadingCallback(A){const a=this.loadingContext,d={id:"pdfjs-font-loading-"+a.nextRequestId++,done:!1,complete:function h(){for((0,n.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;a.requests.length>0&&a.requests[0].done;){const u=a.requests.shift();setTimeout(u.callback,0)}},callback:A};return a.requests.push(d),d}get _loadTestFont(){return(0,n.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(A,h,a){function d(Z,Y){return Z.charCodeAt(Y)<<24|Z.charCodeAt(Y+1)<<16|Z.charCodeAt(Y+2)<<8|255&Z.charCodeAt(Y+3)}function u(Z,Y,V,U){return Z.substring(0,Y)+U+Z.substring(Y+V)}let p,r;const g=this._document.createElement("canvas");g.width=1,g.height=1;const b=g.getContext("2d");let M=0;const D=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=u(_,976,D.length,D);const y=1482184792;let F=d(_,16);for(p=0,r=D.length-3;p<r;p+=4)F=F-y+d(D,p)|0;p<D.length&&(F=F-y+d(D+"XXX",p)|0),_=u(_,16,4,(0,n.string32)(F));const R=`url(data:font/opentype;base64,${btoa(_)});`;this.insertRule(`@font-face {font-family:"${D}";src:${R}}`);const N=[];for(const Z of h)N.push(Z.loadedName);N.push(D);const tt=this._document.createElement("div");tt.style.visibility="hidden",tt.style.width=tt.style.height="10px",tt.style.position="absolute",tt.style.top=tt.style.left="0px";for(const Z of N){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=Z,tt.append(Y)}this._document.body.append(tt),function T(Z,Y){if(M++,M>30)return(0,n.warn)("Load test font never loaded."),void Y();b.font="30px "+Z,b.fillText(".",0,20),b.getImageData(0,0,1,1).data[3]>0?Y():setTimeout(T.bind(null,Z,Y))}(D,()=>{tt.remove(),a.complete()})}},e.FontFaceObject=class k{constructor(A,{isEvalSupported:h=!0,disableFontFace:a=!1,ignoreErrors:d=!1,onUnsupportedFeature:u,fontRegistry:p=null}){this.compiledGlyphs=Object.create(null);for(const r in A)this[r]=A[r];this.isEvalSupported=!1!==h,this.disableFontFace=!0===a,this.ignoreErrors=!0===d,this._onUnsupportedFeature=u,this.fontRegistry=p}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let A;if(this.cssFontInfo){const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),A=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}else A=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),A}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const A=(0,n.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(A)});`;let a;if(this.cssFontInfo){let d=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(d+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),a=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${d}src:${h}}`}else a=`@font-face {font-family:"${this.loadedName}";src:${h}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,h),a}getPathGenerator(A,h){if(void 0!==this.compiledGlyphs[h])return this.compiledGlyphs[h];let a;try{a=A.get(this.loadedName+"_path_"+h)}catch(d){if(!this.ignoreErrors)throw d;return this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${d}".`),this.compiledGlyphs[h]=function(u,p){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const d=[];for(const u of a){const p=void 0!==u.args?u.args.join(","):"";d.push("c.",u.cmd,"(",p,");\n")}return this.compiledGlyphs[h]=new Function("c","size",d.join(""))}return this.compiledGlyphs[h]=function(d,u){for(const p of a)"scale"===p.cmd&&(p.args=[u,-u]),d[p.cmd].apply(d,p.args)}}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=E(8),f=E(1),I=E(13),k=E(14),w=E(3);const a=4096,p=w.isNodeJS&&typeof Path2D>"u"?-1:1e3,r=16;class b{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,c,S){let P;return void 0!==this.cache[o]?(P=this.cache[o],this.canvasFactory.reset(P,c,S)):(P=this.canvasFactory.create(c,S),this.cache[o]=P),P}delete(o){delete this.cache[o]}clear(){for(const o in this.cache)this.canvasFactory.destroy(this.cache[o]),delete this.cache[o]}}function M(C,o,c,S,P,t,i,m,v,x){const[O,L,W,z,q,K]=(0,n.getCurrentTransform)(C);if(0===L&&0===W){const it=Math.round(i*O+q),ot=Math.round(m*z+K),ft=Math.abs(Math.round((i+v)*O+q)-it)||1,lt=Math.abs(Math.round((m+x)*z+K)-ot)||1;return C.setTransform(Math.sign(O),0,0,Math.sign(z),it,ot),C.drawImage(o,c,S,P,t,0,0,ft,lt),C.setTransform(O,L,W,z,q,K),[ft,lt]}if(0===O&&0===z){const it=Math.round(m*W+q),ot=Math.round(i*L+K),ft=Math.abs(Math.round((m+x)*W+q)-it)||1,lt=Math.abs(Math.round((i+v)*L+K)-ot)||1;return C.setTransform(0,Math.sign(L),Math.sign(W),0,it,ot),C.drawImage(o,c,S,P,t,0,0,lt,ft),C.setTransform(O,L,W,z,q,K),[lt,ft]}return C.drawImage(o,c,S,P,t,i,m,v,x),[Math.hypot(O,L)*v,Math.hypot(W,z)*x]}class D{constructor(o,c){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=f.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=f.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,o,c])}clone(){const o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,c){this.x=o,this.y=c}updatePathMinMax(o,c,S){[c,S]=f.Util.applyTransform([c,S],o),this.minX=Math.min(this.minX,c),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,c),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(o,c){const S=f.Util.applyTransform(c,o),P=f.Util.applyTransform(c.slice(2),o);this.minX=Math.min(this.minX,S[0],P[0]),this.minY=Math.min(this.minY,S[1],P[1]),this.maxX=Math.max(this.maxX,S[0],P[0]),this.maxY=Math.max(this.maxY,S[1],P[1])}updateScalingPathMinMax(o,c){f.Util.scaleMinMax(o,c),this.minX=Math.min(this.minX,c[0]),this.maxX=Math.max(this.maxX,c[1]),this.minY=Math.min(this.minY,c[2]),this.maxY=Math.max(this.maxY,c[3])}updateCurvePathMinMax(o,c,S,P,t,i,m,v,x,O){const L=f.Util.bezierBoundingBox(c,S,P,t,i,m,v,x);if(O)return O[0]=Math.min(O[0],L[0],L[2]),O[1]=Math.max(O[1],L[0],L[2]),O[2]=Math.min(O[2],L[1],L[3]),void(O[3]=Math.max(O[3],L[1],L[3]));this.updateRectMinMax(o,L)}getPathBoundingBox(o=I.PathType.FILL,c=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(o===I.PathType.STROKE){c||(0,f.unreachable)("Stroke bounding box must include transform.");const P=f.Util.singularValueDecompose2dScale(c),t=P[0]*this.lineWidth/2,i=P[1]*this.lineWidth/2;S[0]-=t,S[1]-=i,S[2]+=t,S[3]+=i}return S}updateClipFromPath(){const o=f.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=I.PathType.FILL,c=null){return f.Util.intersect(this.clipBox,this.getPathBoundingBox(o,c))}}function _(C,o,c=null){if(typeof ImageData<"u"&&o instanceof ImageData)return void C.putImageData(o,0,0);const S=o.height,P=o.width,t=S%r,i=(S-t)/r,m=0===t?i:i+1,v=C.createImageData(P,r);let O,x=0;const L=o.data,W=v.data;let z,q,K,et,J,st,it,at;if(c)switch(c.length){case 1:J=c[0],st=c[0],it=c[0],at=c[0];break;case 4:J=c[0],st=c[1],it=c[2],at=c[3]}if(o.kind===f.ImageKind.GRAYSCALE_1BPP){const ot=L.byteLength,nt=new Uint32Array(W.buffer,0,W.byteLength>>2),ft=nt.length,mt=P+7>>3;let lt=4294967295,ut=f.FeatureTest.isLittleEndian?4278190080:255;for(at&&255===at[0]&&0===at[255]&&([lt,ut]=[ut,lt]),z=0;z<m;z++){for(K=z<i?r:t,O=0,q=0;q<K;q++){const gt=ot-x;let St=0;const At=gt>mt?P:8*gt-7,Tt=-8&At;let _t=0,pt=0;for(;St<Tt;St+=8)pt=L[x++],nt[O++]=128&pt?lt:ut,nt[O++]=64&pt?lt:ut,nt[O++]=32&pt?lt:ut,nt[O++]=16&pt?lt:ut,nt[O++]=8&pt?lt:ut,nt[O++]=4&pt?lt:ut,nt[O++]=2&pt?lt:ut,nt[O++]=1&pt?lt:ut;for(;St<At;St++)0===_t&&(pt=L[x++],_t=128),nt[O++]=pt&_t?lt:ut,_t>>=1}for(;O<ft;)nt[O++]=0;C.putImageData(v,0,z*r)}}else if(o.kind===f.ImageKind.RGBA_32BPP){const ot=!!(J||st||it);for(q=0,et=P*r*4,z=0;z<i;z++){if(W.set(L.subarray(x,x+et)),x+=et,ot)for(let nt=0;nt<et;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,q),q+=r}if(z<m){if(et=P*t*4,W.set(L.subarray(x,x+et)),ot)for(let nt=0;nt<et;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,q)}}else{if(o.kind!==f.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${o.kind}`);{const ot=!!(J||st||it);for(K=r,et=P*K,z=0;z<m;z++){for(z>=i&&(K=t,et=P*K),O=0,q=et;q--;)W[O++]=L[x++],W[O++]=L[x++],W[O++]=L[x++],W[O++]=255;if(ot)for(let nt=0;nt<O;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,z*r)}}}}function s(C,o){if(o.bitmap)return void C.drawImage(o.bitmap,0,0);const c=o.height,S=o.width,P=c%r,t=(c-P)/r,i=0===P?t:t+1,m=C.createImageData(S,r);let v=0;const x=o.data,O=m.data;for(let L=0;L<i;L++){const W=L<t?r:P;({srcPos:v}=(0,k.applyMaskImageData)({src:x,srcPos:v,dest:O,width:S,height:W})),C.putImageData(m,0,L*r)}}function l(C,o){const c=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let S=0,P=c.length;S<P;S++){const t=c[S];void 0!==C[t]&&(o[t]=C[t])}void 0!==C.setLineDash&&(o.setLineDash(C.getLineDash()),o.lineDashOffset=C.lineDashOffset)}function y(C,o){C.strokeStyle=C.fillStyle=o||"#000000",C.fillRule="nonzero",C.globalAlpha=1,C.lineWidth=1,C.lineCap="butt",C.lineJoin="miter",C.miterLimit=10,C.globalCompositeOperation="source-over",C.font="10px sans-serif",void 0!==C.setLineDash&&(C.setLineDash([]),C.lineDashOffset=0)}function F(C,o,c,S){const P=C.length;for(let t=3;t<P;t+=4){const i=C[t];if(0===i)C[t-3]=o,C[t-2]=c,C[t-1]=S;else if(i<255){const m=255-i;C[t-3]=C[t-3]*i+o*m>>8,C[t-2]=C[t-2]*i+c*m>>8,C[t-1]=C[t-1]*i+S*m>>8}}}function R(C,o,c){const S=C.length;for(let t=3;t<S;t+=4)o[t]=o[t]*(c?c[C[t]]:C[t])*.00392156862745098|0}function j(C,o,c){const S=C.length;for(let P=3;P<S;P+=4){const t=77*C[P-3]+152*C[P-2]+28*C[P-1];o[P]=c?o[P]*c[t>>8]>>8:o[P]*t>>16}}function Z(C,o){const c=f.Util.singularValueDecompose2dScale(C);c[0]=Math.fround(c[0]),c[1]=Math.fround(c[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*n.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==o?o:c[0]<=S||c[1]<=S}const Y=["butt","round","square"],V=["miter","round","bevel"],U={},B={};class X{constructor(o,c,S,P,t,i,m,v){this.ctx=o,this.current=new D(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=c,this.objs=S,this.canvasFactory=P,this.imageLayer=t,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=i,this.cachedCanvases=new b(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=m,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=v?.background||null,this.foregroundColor=v?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,c=null){return"string"==typeof o?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):c}beginDrawing({transform:o,viewport:c,transparency:S=!1,background:P=null}){const t=this.ctx.canvas.width,i=this.ctx.canvas.height,m=P||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const v=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const x=this.backgroundColor=this.ctx.fillStyle;let O=!0,L=m;if(this.ctx.fillStyle=m,L=this.ctx.fillStyle,O="string"==typeof L&&/^#[0-9A-Fa-f]{6}$/.test(L),"#000000"===v&&"#ffffff"===x||v===x||!O)this.foregroundColor=this.backgroundColor=null;else{const[W,z,q]=(0,n.getRGB)(L),K=J=>(J/=255)<=.03928?J/12.92:((J+.055)/1.055)**2.4,et=Math.round(.2126*K(W)+.7152*K(z)+.0722*K(q));this.selectColor=(J,st,it)=>{const at=.2126*K(J)+.7152*K(st)+.0722*K(it);return Math.round(at)===et?x:v}}}if(this.ctx.fillStyle=this.backgroundColor||m,this.ctx.fillRect(0,0,t,i),this.ctx.restore(),S){const v=this.cachedCanvases.getCanvas("transparent",t,i);this.compositeCtx=this.ctx,this.transparentCanvas=v.canvas,this.ctx=v.context,this.ctx.save(),this.ctx.transform(...(0,n.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),y(this.ctx,this.foregroundColor),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...c.transform),this.viewportScale=c.scale,this.baseTransform=(0,n.getCurrentTransform)(this.ctx),this.imageLayer&&((0,n.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(o,c,S,P){const t=o.argsArray,i=o.fnArray;let m=c||0;const v=t.length;if(v===m)return m;const x=v-m>10&&"function"==typeof S,O=x?Date.now()+15:0;let L=0;const W=this.commonObjs,z=this.objs;let q;for(;;){if(void 0!==P&&m===P.nextBreakPoint)return P.breakIt(m,S),m;if(q=i[m],q!==f.OPS.dependency)this[q].apply(this,t[m]);else for(const K of t[m]){const et=K.startsWith("g_")?W:z;if(!et.has(K))return et.get(K,S),m}if(m++,m===v)return m;if(x&&++L>10){if(Date.now()>O)return S(),m;L=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const o of this._cachedBitmapsMap.values()){for(const c of o.values())typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement&&(c.width=c.height=0);o.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(o,c){const S=o.width,P=o.height;let O,L,t=Math.max(Math.hypot(c[0],c[1]),1),i=Math.max(Math.hypot(c[2],c[3]),1),m=S,v=P,x="prescale1";for(;t>2&&m>1||i>2&&v>1;){let W=m,z=v;t>2&&m>1&&(W=Math.ceil(m/2),t/=m/W),i>2&&v>1&&(z=Math.ceil(v/2),i/=v/z),O=this.cachedCanvases.getCanvas(x,W,z),L=O.context,L.clearRect(0,0,W,z),L.drawImage(o,0,0,m,v,0,0,W,z),o=O.canvas,m=W,v=z,x="prescale1"===x?"prescale2":"prescale1"}return{img:o,paintWidth:m,paintHeight:v}}_createMaskCanvas(o){const c=this.ctx,{width:S,height:P}=o,t=this.current.fillColor,i=this.current.patternFill,m=(0,n.getCurrentTransform)(c);let v,x,O,L;if((o.bitmap||o.data)&&o.count>1){const ft=o.bitmap||o.data.buffer,mt=m.slice(0,4);x=JSON.stringify(i?mt:[mt,t]),v=this._cachedBitmapsMap.get(ft),v||(v=new Map,this._cachedBitmapsMap.set(ft,v));const lt=v.get(x);if(lt&&!i)return{canvas:lt,offsetX:Math.round(Math.min(m[0],m[2])+m[4]),offsetY:Math.round(Math.min(m[1],m[3])+m[5])};O=lt}O||(L=this.cachedCanvases.getCanvas("maskCanvas",S,P),s(L.context,o));let W=f.Util.transform(m,[1/S,0,0,-1/P,0,0]);W=f.Util.transform(W,[1,0,0,1,0,-P]);const z=f.Util.applyTransform([0,0],W),q=f.Util.applyTransform([S,P],W),K=f.Util.normalizeRect([z[0],z[1],q[0],q[1]]),et=Math.round(K[2]-K[0])||1,J=Math.round(K[3]-K[1])||1,st=this.cachedCanvases.getCanvas("fillCanvas",et,J),it=st.context,at=Math.min(z[0],q[0]),ot=Math.min(z[1],q[1]);it.translate(-at,-ot),it.transform(...W),O||(O=this._scaleImage(L.canvas,(0,n.getCurrentTransformInverse)(it)),O=O.img,v&&i&&v.set(x,O)),it.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(it),o.interpolate),M(it,O,0,0,O.width,O.height,0,0,S,P),it.globalCompositeOperation="source-in";const nt=f.Util.transform((0,n.getCurrentTransformInverse)(it),[1,0,0,1,-at,-ot]);return it.fillStyle=i?t.getPattern(c,this,nt,I.PathType.FILL):t,it.fillRect(0,0,S,P),v&&!i&&(this.cachedCanvases.delete("fillCanvas"),v.set(x,st.canvas)),{canvas:st.canvas,offsetX:Math.round(at),offsetY:Math.round(ot)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=Y[o]}setLineJoin(o){this.ctx.lineJoin=V[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,c){const S=this.ctx;void 0!==S.setLineDash&&(S.setLineDash(o),S.lineDashOffset=c)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let c=0,S=o.length;c<S;c++){const P=o[c],i=P[1];switch(P[0]){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=P[1];break;case"ca":this.current.fillAlpha=P[1],this.ctx.globalAlpha=P[1];break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=i}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const P=this.cachedCanvases.getCanvas("smaskGroupAt"+this.groupLevel,this.ctx.canvas.width,this.ctx.canvas.height);this.suspendedCtx=this.ctx,this.ctx=P.context;const t=this.ctx;t.setTransform(...(0,n.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,t),function g(C,o){if(C._removeMirroring)throw new Error("Context is already forwarding operations.");C.__originalSave=C.save,C.__originalRestore=C.restore,C.__originalRotate=C.rotate,C.__originalScale=C.scale,C.__originalTranslate=C.translate,C.__originalTransform=C.transform,C.__originalSetTransform=C.setTransform,C.__originalResetTransform=C.resetTransform,C.__originalClip=C.clip,C.__originalMoveTo=C.moveTo,C.__originalLineTo=C.lineTo,C.__originalBezierCurveTo=C.bezierCurveTo,C.__originalRect=C.rect,C.__originalClosePath=C.closePath,C.__originalBeginPath=C.beginPath,C._removeMirroring=()=>{C.save=C.__originalSave,C.restore=C.__originalRestore,C.rotate=C.__originalRotate,C.scale=C.__originalScale,C.translate=C.__originalTranslate,C.transform=C.__originalTransform,C.setTransform=C.__originalSetTransform,C.resetTransform=C.__originalResetTransform,C.clip=C.__originalClip,C.moveTo=C.__originalMoveTo,C.lineTo=C.__originalLineTo,C.bezierCurveTo=C.__originalBezierCurveTo,C.rect=C.__originalRect,C.closePath=C.__originalClosePath,C.beginPath=C.__originalBeginPath,delete C._removeMirroring},C.save=function(){o.save(),this.__originalSave()},C.restore=function(){o.restore(),this.__originalRestore()},C.translate=function(S,P){o.translate(S,P),this.__originalTranslate(S,P)},C.scale=function(S,P){o.scale(S,P),this.__originalScale(S,P)},C.transform=function(S,P,t,i,m,v){o.transform(S,P,t,i,m,v),this.__originalTransform(S,P,t,i,m,v)},C.setTransform=function(S,P,t,i,m,v){o.setTransform(S,P,t,i,m,v),this.__originalSetTransform(S,P,t,i,m,v)},C.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},C.rotate=function(S){o.rotate(S),this.__originalRotate(S)},C.clip=function(S){o.clip(S),this.__originalClip(S)},C.moveTo=function(c,S){o.moveTo(c,S),this.__originalMoveTo(c,S)},C.lineTo=function(c,S){o.lineTo(c,S),this.__originalLineTo(c,S)},C.bezierCurveTo=function(c,S,P,t,i,m){o.bezierCurveTo(c,S,P,t,i,m),this.__originalBezierCurveTo(c,S,P,t,i,m)},C.rect=function(c,S,P,t){o.rect(c,S,P,t),this.__originalRect(c,S,P,t)},C.closePath=function(){o.closePath(),this.__originalClosePath()},C.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}(t,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){this.current.activeSMask&&(o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height],function tt(C,o,c,S){const P=S[0],t=S[1],i=S[2]-P,m=S[3]-t;0===i||0===m||(function N(C,o,c,S,P,t,i,m,v,x,O){const L=!!t,W=L?t[0]:0,z=L?t[1]:0,q=L?t[2]:0;let K;K="Luminosity"===P?j:R;const J=Math.min(S,Math.ceil(1048576/c));for(let st=0;st<S;st+=J){const it=Math.min(J,S-st),at=C.getImageData(m-x,st+(v-O),c,it),ot=o.getImageData(m,st+v,c,it);L&&F(at.data,W,z,q),K(at.data,ot.data,i),o.putImageData(ot,m,st+v)}}(o.context,c,i,m,o.subtype,o.backdrop,o.transferMap,P,t,o.offsetX,o.offsetY),C.save(),C.globalAlpha=1,C.globalCompositeOperation="source-over",C.setTransform(1,0,0,1,0,0),C.drawImage(c.canvas,0,0),C.restore())}(this.suspendedCtx,this.current.activeSMask,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore())}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(o,c,S,P,t,i){this.ctx.transform(o,c,S,P,t,i),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(o,c,S){const P=this.ctx,t=this.current;let v,x,i=t.x,m=t.y;const O=(0,n.getCurrentTransform)(P),L=0===O[0]&&0===O[3]||0===O[1]&&0===O[2],W=L?S.slice(0):null;for(let z=0,q=0,K=o.length;z<K;z++)switch(0|o[z]){case f.OPS.rectangle:i=c[q++],m=c[q++];const et=c[q++],J=c[q++],st=i+et,it=m+J;P.moveTo(i,m),0===et||0===J?P.lineTo(st,it):(P.lineTo(st,m),P.lineTo(st,it),P.lineTo(i,it)),L||t.updateRectMinMax(O,[i,m,st,it]),P.closePath();break;case f.OPS.moveTo:i=c[q++],m=c[q++],P.moveTo(i,m),L||t.updatePathMinMax(O,i,m);break;case f.OPS.lineTo:i=c[q++],m=c[q++],P.lineTo(i,m),L||t.updatePathMinMax(O,i,m);break;case f.OPS.curveTo:v=i,x=m,i=c[q+4],m=c[q+5],P.bezierCurveTo(c[q],c[q+1],c[q+2],c[q+3],i,m),t.updateCurvePathMinMax(O,v,x,c[q],c[q+1],c[q+2],c[q+3],i,m,W),q+=6;break;case f.OPS.curveTo2:v=i,x=m,P.bezierCurveTo(i,m,c[q],c[q+1],c[q+2],c[q+3]),t.updateCurvePathMinMax(O,v,x,i,m,c[q],c[q+1],c[q+2],c[q+3],W),i=c[q+2],m=c[q+3],q+=4;break;case f.OPS.curveTo3:v=i,x=m,i=c[q+2],m=c[q+3],P.bezierCurveTo(c[q],c[q+1],i,m,i,m),t.updateCurvePathMinMax(O,v,x,c[q],c[q+1],i,m,i,m,W),q+=4;break;case f.OPS.closePath:P.closePath()}L&&t.updateScalingPathMinMax(O,W),t.setCurrentPoint(i,m)}closePath(){this.ctx.closePath()}stroke(o){o=!(typeof o<"u")||o;const c=this.ctx,S=this.current.strokeColor;c.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof S&&S?.getPattern?(c.save(),c.strokeStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),I.PathType.STROKE),this.rescaleAndStroke(!1),c.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),c.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o){o=!(typeof o<"u")||o;const c=this.ctx,S=this.current.fillColor;let t=!1;this.current.patternFill&&(c.save(),c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),I.PathType.FILL),t=!0);const i=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==i&&(this.pendingEOFill?(c.fill("evenodd"),this.pendingEOFill=!1):c.fill()),t&&c.restore(),o&&this.consumePath(i)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=U}eoClip(){this.pendingClip=B}beginText(){this.current.textMatrix=f.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const o=this.pendingTextPaths,c=this.ctx;if(void 0!==o){c.save(),c.beginPath();for(const S of o)c.setTransform(...S.transform),c.translate(S.x,S.y),S.addToPath(c,S.fontSize);c.restore(),c.clip(),c.beginPath(),delete this.pendingTextPaths}else c.beginPath()}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,c){const S=this.commonObjs.get(o),P=this.current;if(!S)throw new Error(`Can't find font for ${o}`);if(P.fontMatrix=S.fontMatrix||f.FONT_IDENTITY_MATRIX,(0===P.fontMatrix[0]||0===P.fontMatrix[3])&&(0,f.warn)("Invalid font matrix for font "+o),c<0?(c=-c,P.fontDirection=-1):P.fontDirection=1,this.current.font=S,this.current.fontSize=c,S.isType3Font)return;let i="normal";S.black?i="900":S.bold&&(i="bold");const m=S.italic?"italic":"normal",v=`"${S.loadedName||"sans-serif"}", ${S.fallbackName}`;let x=c;c<16?x=16:c>100&&(x=100),this.current.fontSizeScale=c/x,this.ctx.font=`${m} ${i} ${x}px ${v}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,c){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=c}setLeadingMoveText(o,c){this.setLeading(-c),this.moveText(o,c)}setTextMatrix(o,c,S,P,t,i){this.current.textMatrix=[o,c,S,P,t,i],this.current.textMatrixScale=Math.hypot(o,c),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,c,S,P){const t=this.ctx,i=this.current,m=i.font,v=i.textRenderingMode,x=i.fontSize/i.fontSizeScale,O=v&f.TextRenderingMode.FILL_STROKE_MASK,L=!!(v&f.TextRenderingMode.ADD_TO_PATH_FLAG),W=i.patternFill&&!m.missingFile;let z;(m.disableFontFace||L||W)&&(z=m.getPathGenerator(this.commonObjs,o)),m.disableFontFace||W?(t.save(),t.translate(c,S),t.beginPath(),z(t,x),P&&t.setTransform(...P),(O===f.TextRenderingMode.FILL||O===f.TextRenderingMode.FILL_STROKE)&&t.fill(),(O===f.TextRenderingMode.STROKE||O===f.TextRenderingMode.FILL_STROKE)&&t.stroke(),t.restore()):((O===f.TextRenderingMode.FILL||O===f.TextRenderingMode.FILL_STROKE)&&t.fillText(o,c,S),(O===f.TextRenderingMode.STROKE||O===f.TextRenderingMode.FILL_STROKE)&&t.strokeText(o,c,S)),L&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,n.getCurrentTransform)(t),x:c,y:S,fontSize:x,addToPath:z})}get isFontSubpixelAAEnabled(){const{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);const c=o.getImageData(0,0,10,10).data;let S=!1;for(let P=3;P<c.length;P+=4)if(c[P]>0&&c[P]<255){S=!0;break}return(0,f.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(o){const c=this.current,S=c.font;if(S.isType3Font)return this.showType3Text(o);const P=c.fontSize;if(0===P)return;const t=this.ctx,i=c.fontSizeScale,m=c.charSpacing,v=c.wordSpacing,x=c.fontDirection,O=c.textHScale*x,L=o.length,W=S.vertical,z=W?1:-1,q=S.defaultVMetrics,K=P*c.fontMatrix[0],et=c.textRenderingMode===f.TextRenderingMode.FILL&&!S.disableFontFace&&!c.patternFill;let J;if(t.save(),t.transform(...c.textMatrix),t.translate(c.x,c.y+c.textRise),t.scale(O,x>0?-1:1),c.patternFill){t.save();const nt=c.fillColor.getPattern(t,this,(0,n.getCurrentTransformInverse)(t),I.PathType.FILL);J=(0,n.getCurrentTransform)(t),t.restore(),t.fillStyle=nt}let st=c.lineWidth;const it=c.textMatrixScale;if(0===it||0===st){const nt=c.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;(nt===f.TextRenderingMode.STROKE||nt===f.TextRenderingMode.FILL_STROKE)&&(st=this.getSinglePixelWidth())}else st/=it;1!==i&&(t.scale(i,i),st/=i),t.lineWidth=st;let ot,at=0;for(ot=0;ot<L;++ot){const nt=o[ot];if("number"==typeof nt){at+=z*nt*P/1e3;continue}let ft=!1;const mt=(nt.isSpace?v:0)+m,lt=nt.fontChar,ut=nt.accent;let gt,St,Tt,At=nt.width;if(W){const _t=nt.vmetric||q,pt=-(nt.vmetric?_t[1]:.5*At)*K;At=_t?-_t[0]:At,gt=pt/i,St=(at+_t[2]*K)/i}else gt=at/i,St=0;if(S.remeasure&&At>0){const _t=1e3*t.measureText(lt).width/P*i;if(At<_t&&this.isFontSubpixelAAEnabled){const pt=At/_t;ft=!0,t.save(),t.scale(pt,1),gt/=pt}else At!==_t&&(gt+=(At-_t)/2e3*P/i)}this.contentVisible&&(nt.isInFont||S.missingFile)&&(et&&!ut?t.fillText(lt,gt,St):(this.paintChar(lt,gt,St,J),ut&&this.paintChar(ut.fontChar,gt+P*ut.offset.x/i,St-P*ut.offset.y/i,J))),Tt=W?At*K-mt*x:At*K+mt*x,at+=Tt,ft&&t.restore()}W?c.y-=at:c.x+=at*O,t.restore(),this.compose()}showType3Text(o){const c=this.ctx,S=this.current,P=S.font,t=S.fontSize,i=S.fontDirection,m=P.vertical?1:-1,v=S.charSpacing,x=S.wordSpacing,O=S.textHScale*i,L=S.fontMatrix||f.FONT_IDENTITY_MATRIX,W=o.length;let q,K,et,J;if(S.textRenderingMode!==f.TextRenderingMode.INVISIBLE&&0!==t){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,c.save(),c.transform(...S.textMatrix),c.translate(S.x,S.y),c.scale(O,i),q=0;q<W;++q){if(K=o[q],"number"==typeof K){J=m*K*t/1e3,this.ctx.translate(J,0),S.x+=J*O;continue}const st=(K.isSpace?x:0)+v,it=P.charProcOperatorList[K.operatorListId];it?(this.contentVisible&&(this.processingType3=K,this.save(),c.scale(t,t),c.transform(...L),this.executeOperatorList(it),this.restore()),et=f.Util.applyTransform([K.width,0],L)[0]*t+st,c.translate(et,0),S.x+=et*O):(0,f.warn)(`Type3 character "${K.operatorListId}" is not available.`)}c.restore(),this.processingType3=null}}setCharWidth(o,c){}setCharWidthAndBounds(o,c,S,P,t,i){this.ctx.rect(S,P,t-S,i-P),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let c;if("TilingPattern"===o[0]){const S=o[1],P=this.baseTransform||(0,n.getCurrentTransform)(this.ctx);c=new I.TilingPattern(o,S,this.ctx,{createCanvasGraphics:i=>new X(i,this.commonObjs,this.objs,this.canvasFactory)},P)}else c=this._getPattern(o[1],o[2]);return c}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,c,S){const P=this.selectColor?.(o,c,S)||f.Util.makeHexColor(o,c,S);this.ctx.strokeStyle=P,this.current.strokeColor=P}setFillRGBColor(o,c,S){const P=this.selectColor?.(o,c,S)||f.Util.makeHexColor(o,c,S);this.ctx.fillStyle=P,this.current.fillColor=P,this.current.patternFill=!1}_getPattern(o,c=null){let S;return this.cachedPatterns.has(o)?S=this.cachedPatterns.get(o):(S=(0,I.getShadingPattern)(this.objs.get(o)),this.cachedPatterns.set(o,S)),c&&(S.matrix=c),S}shadingFill(o){if(!this.contentVisible)return;const c=this.ctx;this.save();const S=this._getPattern(o);c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),I.PathType.SHADING);const P=(0,n.getCurrentTransformInverse)(c);if(P){const t=c.canvas,i=t.width,m=t.height,v=f.Util.applyTransform([0,0],P),x=f.Util.applyTransform([0,m],P),O=f.Util.applyTransform([i,0],P),L=f.Util.applyTransform([i,m],P),W=Math.min(v[0],x[0],O[0],L[0]),z=Math.min(v[1],x[1],O[1],L[1]),q=Math.max(v[0],x[0],O[0],L[0]),K=Math.max(v[1],x[1],O[1],L[1]);this.ctx.fillRect(W,z,q-W,K-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,f.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,f.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,c){this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&6===o.length&&this.transform(...o),this.baseTransform=(0,n.getCurrentTransform)(this.ctx),c)&&(this.ctx.rect(c[0],c[1],c[2]-c[0],c[3]-c[1]),this.current.updateRectMinMax((0,n.getCurrentTransform)(this.ctx),c),this.clip(),this.endPath())}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const c=this.ctx;o.isolated||(0,f.info)("TODO: Support non-isolated groups."),o.knockout&&(0,f.warn)("Knockout groups not supported.");const S=(0,n.getCurrentTransform)(c);if(o.matrix&&c.transform(...o.matrix),!o.bbox)throw new Error("Bounding box is required.");let P=f.Util.getAxialAlignedBoundingBox(o.bbox,(0,n.getCurrentTransform)(c));P=f.Util.intersect(P,[0,0,c.canvas.width,c.canvas.height])||[0,0,0,0];const i=Math.floor(P[0]),m=Math.floor(P[1]);let v=Math.max(Math.ceil(P[2])-i,1),x=Math.max(Math.ceil(P[3])-m,1),O=1,L=1;v>a&&(O=v/a,v=a),x>a&&(L=x/a,x=a),this.current.startNewPathAndClipBox([0,0,v,x]);let W="groupAt"+this.groupLevel;o.smask&&(W+="_smask_"+this.smaskCounter++%2);const z=this.cachedCanvases.getCanvas(W,v,x),q=z.context;q.scale(1/O,1/L),q.translate(-i,-m),q.transform(...S),o.smask?this.smaskStack.push({canvas:z.canvas,context:q,offsetX:i,offsetY:m,scaleX:O,scaleY:L,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(c.setTransform(1,0,0,1,0,0),c.translate(i,m),c.scale(O,L),c.save()),l(c,q),this.ctx=q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;const c=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const P=(0,n.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...P);const t=f.Util.getAxialAlignedBoundingBox([0,0,c.canvas.width,c.canvas.height],P);this.ctx.drawImage(c.canvas,0,0),this.ctx.restore(),this.compose(t)}}beginAnnotation(o,c,S,P,t){if(this.#t(),y(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(c)&&4===c.length){const i=c[2]-c[0],m=c[3]-c[1];if(t&&this.annotationCanvasMap){(S=S.slice())[4]-=c[0],S[5]-=c[1],(c=c.slice())[0]=c[1]=0,c[2]=i,c[3]=m;const[v,x]=f.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(this.ctx)),{viewportScale:O}=this,L=Math.ceil(i*this.outputScaleX*O),W=Math.ceil(m*this.outputScaleY*O);this.annotationCanvas=this.canvasFactory.create(L,W);const{canvas:z,context:q}=this.annotationCanvas;this.annotationCanvasMap.set(o,z),this.annotationCanvas.savedCtx=this.ctx,this.ctx=q,this.ctx.setTransform(v,0,0,-x,0,m*x),y(this.ctx,this.foregroundColor)}else y(this.ctx,this.foregroundColor),this.ctx.rect(c[0],c[1],i,m),this.ctx.clip(),this.endPath()}this.current=new D(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;const c=o.count;(o=this.getObject(o.data,o)).count=c;const S=this.ctx,P=this.processingType3;if(P&&(void 0===P.compiled&&(P.compiled=function T(C){const{width:o,height:c}=C;if(o>p||c>p)return null;const P=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),t=o+1;let m,v,x,i=new Uint8Array(t*(c+1));const O=o+7&-8;let L=new Uint8Array(O*c),W=0;for(const J of C.data){let st=128;for(;st>0;)L[W++]=J&st?0:255,st>>=1}let z=0;for(W=0,0!==L[W]&&(i[0]=1,++z),v=1;v<o;v++)L[W]!==L[W+1]&&(i[v]=L[W]?2:1,++z),W++;for(0!==L[W]&&(i[v]=2,++z),m=1;m<c;m++){W=m*O,x=m*t,L[W-O]!==L[W]&&(i[x]=L[W]?1:8,++z);let J=(L[W]?4:0)+(L[W-O]?8:0);for(v=1;v<o;v++)J=(J>>2)+(L[W+1]?4:0)+(L[W-O+1]?8:0),P[J]&&(i[x+v]=P[J],++z),W++;if(L[W-O]!==L[W]&&(i[x+v]=L[W]?2:4,++z),z>1e3)return null}for(W=O*(c-1),x=m*t,0!==L[W]&&(i[x]=8,++z),v=1;v<o;v++)L[W]!==L[W+1]&&(i[x+v]=L[W]?4:8,++z),W++;if(0!==L[W]&&(i[x+v]=4,++z),z>1e3)return null;const q=new Int32Array([0,t,-1,0,-t,0,0,0,1]),K=new Path2D;for(m=0;z&&m<=c;m++){let J=m*t;const st=J+o;for(;J<st&&!i[J];)J++;if(J===st)continue;K.moveTo(J%t,m);const it=J;let at=i[J];do{const ot=q[at];do{J+=ot}while(!i[J]);const nt=i[J];5!==nt&&10!==nt?(at=nt,i[J]=0):(at=nt&51*at>>4,i[J]&=at>>2|at<<2),K.lineTo(J%t,J/t|0),i[J]||--z}while(it!==J);--m}return L=null,i=null,function(J){J.save(),J.scale(1/o,-1/c),J.translate(0,-c),J.fill(K),J.beginPath(),J.restore()}}(o)),P.compiled))return void P.compiled(S);const t=this._createMaskCanvas(o),i=t.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(i,t.offsetX,t.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(o,c,S=0,P=0,t,i){if(!this.contentVisible)return;o=this.getObject(o.data,o);const m=this.ctx;m.save();const v=(0,n.getCurrentTransform)(m);m.transform(c,S,P,t,0,0);const x=this._createMaskCanvas(o);m.setTransform(1,0,0,1,0,0);for(let O=0,L=i.length;O<L;O+=2){const W=f.Util.transform(v,[c,S,P,t,i[O],i[O+1]]),[z,q]=f.Util.applyTransform([0,0],W);m.drawImage(x.canvas,z,q)}m.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;const c=this.ctx,S=this.current.fillColor,P=this.current.patternFill;for(const t of o){const{data:i,width:m,height:v,transform:x}=t,O=this.cachedCanvases.getCanvas("maskCanvas",m,v),L=O.context;L.save(),s(L,this.getObject(i,t)),L.globalCompositeOperation="source-in",L.fillStyle=P?S.getPattern(L,this,(0,n.getCurrentTransformInverse)(c),I.PathType.FILL):S,L.fillRect(0,0,m,v),L.restore(),c.save(),c.transform(...x),c.scale(1,-1),M(c,O.canvas,0,0,m,v,0,-1,1,1),c.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;const c=this.getObject(o);c?this.paintInlineImageXObject(c):(0,f.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(o,c,S,P){if(!this.contentVisible)return;const t=this.getObject(o);if(!t)return void(0,f.warn)("Dependent image isn't ready yet");const i=t.width,m=t.height,v=[];for(let x=0,O=P.length;x<O;x+=2)v.push({transform:[c,0,0,S,P[x],P[x+1]],x:0,y:0,w:i,h:m});this.paintInlineImageXObjectGroup(t,v)}paintInlineImageXObject(o){if(!this.contentVisible)return;const c=o.width,S=o.height,P=this.ctx;let t;if(this.save(),P.scale(1/c,-1/S),"function"==typeof HTMLElement&&o instanceof HTMLElement||!o.data)t=o;else{const x=this.cachedCanvases.getCanvas("inlineImage",c,S);_(x.context,o,this.current.transferMaps),t=x.canvas}const i=this._scaleImage(t,(0,n.getCurrentTransformInverse)(P));P.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(P),o.interpolate);const[m,v]=M(P,i.img,0,0,i.paintWidth,i.paintHeight,0,-S,c,S);if(this.imageLayer){const[x,O]=f.Util.applyTransform([0,-S],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:o,left:x,top:O,width:m,height:v})}this.compose(),this.restore()}paintInlineImageXObjectGroup(o,c){if(!this.contentVisible)return;const S=this.ctx,P=o.width,t=o.height,i=this.cachedCanvases.getCanvas("inlineImage",P,t);_(i.context,o,this.current.transferMaps);for(const v of c){if(S.save(),S.transform(...v.transform),S.scale(1,-1),M(S,i.canvas,v.x,v.y,v.w,v.h,0,-1,1,1),this.imageLayer){const[x,O]=f.Util.applyTransform([v.x,v.y],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:o,left:x,top:O,width:P,height:t})}S.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,c){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,c){this.markedContentStack.push("OC"===o?{visible:this.optionalContentConfig.isVisible(c)}:{visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){const c=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);const S=this.ctx;this.pendingClip&&(c||(this.pendingClip===B?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const o=(0,n.getCurrentTransform)(this.ctx);if(0===o[1]&&0===o[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{const c=Math.abs(o[0]*o[3]-o[2]*o[1]),S=Math.hypot(o[0],o[2]),P=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(S,P)/c}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:o}=this.current,c=(0,n.getCurrentTransform)(this.ctx);let S,P;if(0===c[1]&&0===c[2]){const t=Math.abs(c[0]),i=Math.abs(c[3]);if(0===o)S=1/t,P=1/i;else{const m=t*o,v=i*o;S=m<1?1/m:1,P=v<1?1/v:1}}else{const t=Math.abs(c[0]*c[3]-c[2]*c[1]),i=Math.hypot(c[0],c[1]),m=Math.hypot(c[2],c[3]);if(0===o)S=m/t,P=i/t;else{const v=o*t;S=m>v?m/v:1,P=i>v?i/v:1}}this._cachedScaleForStroking=[S,P]}return this._cachedScaleForStroking}rescaleAndStroke(o){const{ctx:c}=this,{lineWidth:S}=this.current,[P,t]=this.getScaleForStroking();if(c.lineWidth=S||1,1===P&&1===t)return void c.stroke();let i,m,v;o&&(i=(0,n.getCurrentTransform)(c),m=c.getLineDash().slice(),v=c.lineDashOffset),c.scale(P,t);const x=Math.max(P,t);c.setLineDash(c.getLineDash().map(O=>O/x)),c.lineDashOffset/=x,c.stroke(),o&&(c.setTransform(...i),c.setLineDash(m),c.lineDashOffset=v)}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}}e.CanvasGraphics=X;for(const C in f.OPS)void 0!==X.prototype[C]&&(X.prototype[f.OPS[C]]=X.prototype[C])},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=function r(M){switch(M[0]){case"RadialAxial":return new h(M);case"Mesh":return new u(M);case"Dummy":return new p}throw new Error(`Unknown IR type: ${M[0]}`)};var n=E(1),f=E(8),I=E(3);const k={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function w(M,T){if(!T||I.isNodeJS)return;const D=T[2]-T[0],_=T[3]-T[1],s=new Path2D;s.rect(T[0],T[1],D,_),M.clip(s)}e.PathType=k;class A{constructor(){this.constructor===A&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends A{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let D;"axial"===this._type?D=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(D=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const _ of this._colorStops)D.addColorStop(_[0],_[1]);return D}getPattern(T,D,_,s){let l;if(s===k.STROKE||s===k.FILL){const y=D.current.getClippedPathBoundingBox(s,(0,f.getCurrentTransform)(T))||[0,0,0,0],F=Math.ceil(y[2]-y[0])||1,R=Math.ceil(y[3]-y[1])||1,j=D.cachedCanvases.getCanvas("pattern",F,R,!0),N=j.context;N.clearRect(0,0,N.canvas.width,N.canvas.height),N.beginPath(),N.rect(0,0,N.canvas.width,N.canvas.height),N.translate(-y[0],-y[1]),_=n.Util.transform(_,[1,0,0,1,y[0],y[1]]),N.transform(...D.baseTransform),this.matrix&&N.transform(...this.matrix),w(N,this._bbox),N.fillStyle=this._createGradient(N),N.fill(),l=T.createPattern(j.canvas,"no-repeat");const tt=new DOMMatrix(_);try{l.setTransform(tt)}catch(Z){(0,n.warn)(`RadialAxialShadingPattern.getPattern: "${Z?.message}".`)}}else w(T,this._bbox),l=this._createGradient(T);return l}}function a(M,T,D,_,s,l,y,F){const R=T.coords,j=T.colors,N=M.data,tt=4*M.width;let Z;R[D+1]>R[_+1]&&(Z=D,D=_,_=Z,Z=l,l=y,y=Z),R[_+1]>R[s+1]&&(Z=_,_=s,s=Z,Z=y,y=F,F=Z),R[D+1]>R[_+1]&&(Z=D,D=_,_=Z,Z=l,l=y,y=Z);const Y=(R[D]+T.offsetX)*T.scaleX,V=(R[D+1]+T.offsetY)*T.scaleY,U=(R[_]+T.offsetX)*T.scaleX,B=(R[_+1]+T.offsetY)*T.scaleY,X=(R[s]+T.offsetX)*T.scaleX,C=(R[s+1]+T.offsetY)*T.scaleY;if(V>=C)return;const o=j[l],c=j[l+1],S=j[l+2],P=j[y],t=j[y+1],i=j[y+2],m=j[F],v=j[F+1],x=j[F+2],O=Math.round(V),L=Math.round(C);let W,z,q,K,et,J,st,it;for(let at=O;at<=L;at++){if(at<B){let lt;lt=at<V?0:(V-at)/(V-B),W=Y-(Y-U)*lt,z=o-(o-P)*lt,q=c-(c-t)*lt,K=S-(S-i)*lt}else{let lt;lt=at>C?1:B===C?0:(B-at)/(B-C),W=U-(U-X)*lt,z=P-(P-m)*lt,q=t-(t-v)*lt,K=i-(i-x)*lt}let ot;ot=at<V?0:at>C?1:(V-at)/(V-C),et=Y-(Y-X)*ot,J=o-(o-m)*ot,st=c-(c-v)*ot,it=S-(S-x)*ot;const nt=Math.round(Math.min(W,et)),ft=Math.round(Math.max(W,et));let mt=tt*at+4*nt;for(let lt=nt;lt<=ft;lt++)ot=(W-lt)/(W-et),ot<0?ot=0:ot>1&&(ot=1),N[mt++]=z-(z-J)*ot|0,N[mt++]=q-(q-st)*ot|0,N[mt++]=K-(K-it)*ot|0,N[mt++]=255}}function d(M,T,D){const _=T.coords,s=T.colors;let l,y;switch(T.type){case"lattice":const F=T.verticesPerRow,R=Math.floor(_.length/F)-1,j=F-1;for(l=0;l<R;l++){let N=l*F;for(let tt=0;tt<j;tt++,N++)a(M,D,_[N],_[N+1],_[N+F],s[N],s[N+1],s[N+F]),a(M,D,_[N+F+1],_[N+1],_[N+F],s[N+F+1],s[N+1],s[N+F])}break;case"triangles":for(l=0,y=_.length;l<y;l+=3)a(M,D,_[l],_[l+1],_[l+2],s[l],s[l+1],s[l+2]);break;default:throw new Error("illegal figure")}}class u extends A{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,D,_){const F=Math.floor(this._bounds[0]),R=Math.floor(this._bounds[1]),j=Math.ceil(this._bounds[2])-F,N=Math.ceil(this._bounds[3])-R,tt=Math.min(Math.ceil(Math.abs(j*T[0]*1.1)),3e3),Z=Math.min(Math.ceil(Math.abs(N*T[1]*1.1)),3e3),Y=j/tt,V=N/Z,U={coords:this._coords,colors:this._colors,offsetX:-F,offsetY:-R,scaleX:1/Y,scaleY:1/V},C=_.getCanvas("mesh",tt+4,Z+4,!1),o=C.context,c=o.createImageData(tt,Z);if(D){const P=c.data;for(let t=0,i=P.length;t<i;t+=4)P[t]=D[0],P[t+1]=D[1],P[t+2]=D[2],P[t+3]=255}for(const P of this._figures)d(c,P,U);return o.putImageData(c,2,2),{canvas:C.canvas,offsetX:F-2*Y,offsetY:R-2*V,scaleX:Y,scaleY:V}}getPattern(T,D,_,s){let l;if(w(T,this._bbox),s===k.SHADING)l=n.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(T));else if(l=n.Util.singularValueDecompose2dScale(D.baseTransform),this.matrix){const F=n.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*F[0],l[1]*F[1]]}const y=this._createMeshCanvas(l,s===k.SHADING?null:this._background,D.cachedCanvases);return s!==k.SHADING&&(T.setTransform(...D.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(y.offsetX,y.offsetY),T.scale(y.scaleX,y.scaleY),T.createPattern(y.canvas,"no-repeat")}}class p extends A{getPattern(){return"hotpink"}}class b{static get MAX_PATTERN_SIZE(){return(0,n.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(T,D,_,s,l){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=D,this.ctx=_,this.canvasGraphicsFactory=s,this.baseTransform=l}createPatternCanvas(T){const D=this.operatorList,_=this.bbox,s=this.xstep,l=this.ystep,y=this.paintType,R=this.color,j=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+this.tilingType);const N=_[0],tt=_[1],Z=_[2],Y=_[3],V=n.Util.singularValueDecompose2dScale(this.matrix),U=n.Util.singularValueDecompose2dScale(this.baseTransform),B=[V[0]*U[0],V[1]*U[1]],X=this.getSizeAndScale(s,this.ctx.canvas.width,B[0]),C=this.getSizeAndScale(l,this.ctx.canvas.height,B[1]),o=T.cachedCanvases.getCanvas("pattern",X.size,C.size,!0),c=o.context,S=j.createCanvasGraphics(c);S.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(S,y,R);let P=N,t=tt,i=Z,m=Y;return N<0&&(P=0,i+=Math.abs(N)),tt<0&&(t=0,m+=Math.abs(tt)),c.translate(-X.scale*P,-C.scale*t),S.transform(X.scale,0,0,C.scale,0,0),c.save(),this.clipBbox(S,P,t,i,m),S.baseTransform=(0,f.getCurrentTransform)(S.ctx),S.executeOperatorList(D),S.endDrawing(),{canvas:o.canvas,scaleX:X.scale,scaleY:C.scale,offsetX:P,offsetY:t}}getSizeAndScale(T,D,_){T=Math.abs(T);const s=Math.max(b.MAX_PATTERN_SIZE,D);let l=Math.ceil(T*_);return l>=s?l=s:_=l/T,{scale:_,size:l}}clipBbox(T,D,_,s,l){T.ctx.rect(D,_,s-D,l-_),T.current.updateRectMinMax((0,f.getCurrentTransform)(T.ctx),[D,_,s,l]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,D,_){const s=T.ctx,l=T.current;switch(D){case 1:const y=this.ctx;s.fillStyle=y.fillStyle,s.strokeStyle=y.strokeStyle,l.fillColor=y.fillStyle,l.strokeColor=y.strokeStyle;break;case 2:const F=n.Util.makeHexColor(_[0],_[1],_[2]);s.fillStyle=F,s.strokeStyle=F,l.fillColor=F,l.strokeColor=F;break;default:throw new n.FormatError(`Unsupported paint type: ${D}`)}}getPattern(T,D,_,s){let l=_;s!==k.SHADING&&(l=n.Util.transform(l,D.baseTransform),this.matrix&&(l=n.Util.transform(l,this.matrix)));const y=this.createPatternCanvas(D);let F=new DOMMatrix(l);F=F.translate(y.offsetX,y.offsetY),F=F.scale(1/y.scaleX,1/y.scaleY);const R=T.createPattern(y.canvas,"repeat");try{R.setTransform(F)}catch(j){(0,n.warn)(`TilingPattern.getPattern: "${j?.message}".`)}return R}}e.TilingPattern=b},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.applyMaskImageData=function f({src:I,srcPos:k=0,dest:w,destPos:A=0,width:h,height:a,inverseDecode:d=!1}){const u=n.FeatureTest.isLittleEndian?4278190080:255,[p,r]=d?[0,u]:[u,0],g=h>>3,b=7&h,M=I.length;w=new Uint32Array(w.buffer);for(let T=0;T<a;T++){for(const _=k+g;k<_;k++){const s=k<M?I[k]:255;w[A++]=128&s?r:p,w[A++]=64&s?r:p,w[A++]=32&s?r:p,w[A++]=16&s?r:p,w[A++]=8&s?r:p,w[A++]=4&s?r:p,w[A++]=2&s?r:p,w[A++]=1&s?r:p}if(0===b)continue;const D=k<M?I[k++]:255;for(let _=0;_<b;_++)w[A++]=D&1<<7-_?r:p}return{srcPos:k,destPos:A}};var n=E(1)},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const E=Object.create(null);e.GlobalWorkerOptions=E,E.workerPort=void 0===E.workerPort?null:E.workerPort,E.workerSrc=void 0===E.workerSrc?"":E.workerSrc},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=E(1);function k(A){switch(A instanceof Error||"object"==typeof A&&null!==A||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),A.name){case"AbortException":return new n.AbortException(A.message);case"MissingPDFException":return new n.MissingPDFException(A.message);case"PasswordException":return new n.PasswordException(A.message,A.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(A.message,A.status);case"UnknownErrorException":return new n.UnknownErrorException(A.message,A.details);default:return new n.UnknownErrorException(A.message,A.toString())}}e.MessageHandler=class w{constructor(h,a,d){this.sourceName=h,this.targetName=a,this.comObj=d,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=u=>{const p=u.data;if(p.targetName!==this.sourceName)return;if(p.stream)return void this._processStreamMessage(p);if(p.callback){const g=p.callbackId,b=this.callbackCapabilities[g];if(!b)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],1===p.callback)b.resolve(p.data);else{if(2!==p.callback)throw new Error("Unexpected callback case");b.reject(k(p.reason))}return}const r=this.actionHandler[p.action];if(!r)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){const g=this.sourceName,b=p.sourceName;new Promise(function(M){M(r(p.data))}).then(function(M){d.postMessage({sourceName:g,targetName:b,callback:1,callbackId:p.callbackId,data:M})},function(M){d.postMessage({sourceName:g,targetName:b,callback:2,callbackId:p.callbackId,reason:k(M)})})}else p.streamId?this._createStreamSink(p):r(p.data)},d.addEventListener("message",this._onComObjOnMessage)}on(h,a){const d=this.actionHandler;if(d[h])throw new Error(`There is already an actionName called "${h}"`);d[h]=a}send(h,a,d){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:a},d)}sendWithPromise(h,a,d){const u=this.callbackId++,p=(0,n.createPromiseCapability)();this.callbackCapabilities[u]=p;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:u,data:a},d)}catch(r){p.reject(r)}return p.promise}sendWithStream(h,a,d,u){const p=this.streamId++,r=this.sourceName,g=this.targetName,b=this.comObj;return new ReadableStream({start:M=>{const T=(0,n.createPromiseCapability)();return this.streamControllers[p]={controller:M,startCall:T,pullCall:null,cancelCall:null,isClosed:!1},b.postMessage({sourceName:r,targetName:g,action:h,streamId:p,data:a,desiredSize:M.desiredSize},u),T.promise},pull:M=>{const T=(0,n.createPromiseCapability)();return this.streamControllers[p].pullCall=T,b.postMessage({sourceName:r,targetName:g,stream:6,streamId:p,desiredSize:M.desiredSize}),T.promise},cancel:M=>{(0,n.assert)(M instanceof Error,"cancel must have a valid reason");const T=(0,n.createPromiseCapability)();return this.streamControllers[p].cancelCall=T,this.streamControllers[p].isClosed=!0,b.postMessage({sourceName:r,targetName:g,stream:1,streamId:p,reason:k(M)}),T.promise}},d)}_createStreamSink(h){const a=h.streamId,d=this.sourceName,u=h.sourceName,p=this.comObj,r=this,g=this.actionHandler[h.action],b={enqueue(M,T=1,D){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=T,_>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),p.postMessage({sourceName:d,targetName:u,stream:4,streamId:a,chunk:M},D)},close(){this.isCancelled||(this.isCancelled=!0,p.postMessage({sourceName:d,targetName:u,stream:3,streamId:a}),delete r.streamSinks[a])},error(M){(0,n.assert)(M instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,p.postMessage({sourceName:d,targetName:u,stream:5,streamId:a,reason:k(M)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[a]=b,new Promise(function(M){M(g(h.data,b))}).then(function(){p.postMessage({sourceName:d,targetName:u,stream:8,streamId:a,success:!0})},function(M){p.postMessage({sourceName:d,targetName:u,stream:8,streamId:a,reason:k(M)})})}_processStreamMessage(h){const a=h.streamId,d=this.sourceName,u=h.sourceName,p=this.comObj,r=this.streamControllers[a],g=this.streamSinks[a];switch(h.stream){case 8:h.success?r.startCall.resolve():r.startCall.reject(k(h.reason));break;case 7:h.success?r.pullCall.resolve():r.pullCall.reject(k(h.reason));break;case 6:if(!g){p.postMessage({sourceName:d,targetName:u,stream:7,streamId:a,success:!0});break}g.desiredSize<=0&&h.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=h.desiredSize,new Promise(function(b){b(g.onPull&&g.onPull())}).then(function(){p.postMessage({sourceName:d,targetName:u,stream:7,streamId:a,success:!0})},function(b){p.postMessage({sourceName:d,targetName:u,stream:7,streamId:a,reason:k(b)})});break;case 4:if((0,n.assert)(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(h.chunk);break;case 3:if((0,n.assert)(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this._deleteStreamController(r,a);break;case 5:(0,n.assert)(r,"error should have stream controller"),r.controller.error(k(h.reason)),this._deleteStreamController(r,a);break;case 2:h.success?r.cancelCall.resolve():r.cancelCall.reject(k(h.reason)),this._deleteStreamController(r,a);break;case 1:if(!g)break;new Promise(function(b){b(g.onCancel&&g.onCancel(k(h.reason)))}).then(function(){p.postMessage({sourceName:d,targetName:u,stream:2,streamId:a,success:!0})},function(b){p.postMessage({sourceName:d,targetName:u,stream:2,streamId:a,reason:k(b)})}),g.sinkCapability.reject(k(h.reason)),g.isCancelled=!0,delete this.streamSinks[a];break;default:throw new Error("Unexpected stream case")}}_deleteStreamController(h,a){var d=this;return _asyncToGenerator(function*(){yield Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete d.streamControllers[a]})()}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=E(1);e.Metadata=class f{#t;#e;constructor({parsedData:k,rawData:w}){this.#t=k,this.#e=w}getRaw(){return this.#e}get(k){return this.#t.get(k)??null}getAll(){return(0,n.objectFromMap)(this.#t)}has(k){return this.#t.has(k)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=E(1);const f=Symbol("INTERNAL");class I{#t=!0;constructor(A,h){this.name=A,this.intent=h}get visible(){return this.#t}_setVisible(A,h){A!==f&&(0,n.unreachable)("Internal method `_setVisible` called."),this.#t=h}}e.OptionalContentConfig=class k{#t=!0;#e=new Map;#i=null;#n=null;constructor(A){if(this.name=null,this.creator=null,null!==A){this.name=A.name,this.creator=A.creator,this.#n=A.order;for(const h of A.groups)this.#e.set(h.id,new I(h.name,h.intent));if("OFF"===A.baseState)for(const h of this.#e.values())h._setVisible(f,!1);for(const h of A.on)this.#e.get(h)._setVisible(f,!0);for(const h of A.off)this.#e.get(h)._setVisible(f,!1);this.#i=new Map;for(const[h,a]of this.#e)this.#i.set(h,a.visible)}}#r(A){const h=A.length;if(h<2)return!0;const a=A[0];for(let d=1;d<h;d++){const u=A[d];let p;if(Array.isArray(u))p=this.#r(u);else{if(!this.#e.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;p=this.#e.get(u).visible}switch(a){case"And":if(!p)return!1;break;case"Or":if(p)return!0;break;case"Not":return!p;default:return!0}}return"And"===a}isVisible(A){if(0===this.#e.size)return!0;if(!A)return(0,n.warn)("Optional content group not defined."),!0;if("OCG"===A.type)return this.#e.has(A.id)?this.#e.get(A.id).visible:((0,n.warn)(`Optional content group not found: ${A.id}`),!0);if("OCMD"===A.type){if(A.expression)return this.#r(A.expression);if(!A.policy||"AnyOn"===A.policy){for(const h of A.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(this.#e.get(h).visible)return!0}return!1}if("AllOn"===A.policy){for(const h of A.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!this.#e.get(h).visible)return!1}return!0}if("AnyOff"===A.policy){for(const h of A.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!this.#e.get(h).visible)return!0}return!1}if("AllOff"===A.policy){for(const h of A.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(this.#e.get(h).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${A.policy}.`),!0}return(0,n.warn)(`Unknown group type ${A.type}.`),!0}setVisibility(A,h=!0){this.#e.has(A)?(this.#e.get(A)._setVisible(f,!!h),this.#t=null):(0,n.warn)(`Optional content group not found: ${A}`)}get hasInitialVisibility(){if(null!==this.#t)return this.#t;for(const[A,h]of this.#e){const a=this.#i.get(A);if(h.visible!==a)return this.#t=!1}return this.#t=!0}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,n.objectFromMap)(this.#e):null}getGroup(A){return this.#e.get(A)||null}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=E(1),f=E(8);e.PDFDataTransportStream=class I{constructor(h,a){(0,n.assert)(a,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h.progressiveDone||!1,this._contentDispositionFilename=h.contentDispositionFilename||null;const d=h.initialData;if(d?.length>0){const u=new Uint8Array(d).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=a,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._contentLength=h.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,p)=>{this._onReceiveData({begin:u,chunk:p})}),this._pdfDataRangeTransport.addProgressListener((u,p)=>{this._onProgress({loaded:u,total:p})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(h){const a=new Uint8Array(h.chunk).buffer;if(void 0===h.begin)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const d=this._rangeReaders.some(function(u){return u._begin===h.begin&&(u._enqueue(a),!0)});(0,n.assert)(d,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){if(void 0===h.total){const a=this._rangeReaders[0];a?.onProgress&&a.onProgress({loaded:h.loaded})}else{const a=this._fullRequestReader;a?.onProgress&&a.onProgress({loaded:h.loaded,total:h.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const a=this._rangeReaders.indexOf(h);a>=0&&this._rangeReaders.splice(a,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new k(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,a){if(a<=this._progressiveDataLength)return null;const d=new w(this,h,a);return this._pdfDataRangeTransport.requestDataRange(h,a),this._rangeReaders.push(d),d}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const a of this._rangeReaders.slice(0))a.cancel(h);this._pdfDataRangeTransport.abort()}};class k{constructor(h,a,d=!1,u=null){this._stream=h,this._done=d||!1,this._filename=(0,f.isPdfFile)(u)?u:null,this._queuedChunks=a||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){var h=this;return _asyncToGenerator(function*(){if(h._queuedChunks.length>0)return{value:h._queuedChunks.shift(),done:!1};if(h._done)return{value:void 0,done:!0};const a=(0,n.createPromiseCapability)();return h._requests.push(a),a.promise})()}cancel(h){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class w{constructor(h,a,d){this._stream=h,this._begin=a,this._end=d,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(0===this._requests.length)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){var h=this;return _asyncToGenerator(function*(){if(h._queuedChunk){const d=h._queuedChunk;return h._queuedChunk=null,{value:d,done:!1}}if(h._done)return{value:void 0,done:!0};const a=(0,n.createPromiseCapability)();return h._requests.push(a),a.promise})()}cancel(h){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class E{static textContent(f){const I=[],k={items:I,styles:Object.create(null)};return function w(A){if(!A)return;let h=null;const a=A.name;if("#text"===a)h=A.value;else{if(!E.shouldBuildText(a))return;A?.attributes?.textContent?h=A.attributes.textContent:A.value&&(h=A.value)}if(null!==h&&I.push({str:h}),A.children)for(const d of A.children)w(d)}(f),k}static shouldBuildText(f){return!("textarea"===f||"input"===f||"option"===f||"select"===f)}}e.XfaText=E},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=E(9);const f=function(A){return new Promise((h,a)=>{__webpack_require__(23237).readFile(A,(u,p)=>{!u&&p?h(new Uint8Array(p)):a(new Error(u))})})};e.NodeCanvasFactory=class I extends n.BaseCanvasFactory{_createCanvas(h,a){return __webpack_require__(17640).createCanvas(h,a)}},e.NodeCMapReaderFactory=class k extends n.BaseCMapReaderFactory{_fetchData(h,a){return f(h).then(d=>({cMapData:d,compressionType:a}))}},e.NodeStandardFontDataFactory=class w extends n.BaseStandardFontDataFactory{_fetchData(h){return f(h)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=E(7),f=E(1),I=E(23),k=E(24);e.AnnotationEditorLayer=(()=>{class A{#t;#e=!1;#i=this.pointerup.bind(this);#n=this.pointerdown.bind(this);#r=new Map;#h=!1;#o=!1;#s;static _initialized=!1;constructor(a){A._initialized||(A._initialized=!0,I.FreeTextEditor.initialize(a.l10n),k.InkEditor.initialize(a.l10n),a.uiManager.registerEditorTypes([I.FreeTextEditor,k.InkEditor])),this.#s=a.uiManager,this.annotationStorage=a.annotationStorage,this.pageIndex=a.pageIndex,this.div=a.div,this.#t=a.accessibilityManager,this.#s.addLayer(this)}updateToolbar(a){this.#s.updateToolbar(a)}updateMode(a=this.#s.getMode()){this.#a(),a===f.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#s.unselectAll()}addInkEditorIfNeeded(a){if(a||this.#s.getMode()===f.AnnotationEditorType.INK){if(!a)for(const u of this.#r.values())if(u.isEmpty())return void u.setInBackground();this.#c({offsetX:0,offsetY:0}).setInBackground()}}setEditingState(a){this.#s.setEditingState(a)}addCommands(a){this.#s.addCommands(a)}enable(){this.div.style.pointerEvents="auto";for(const a of this.#r.values())a.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const a of this.#r.values())a.disableEditing()}setActiveEditor(a){this.#s.getActive()!==a&&this.#s.setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",this.#n),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#n),this.div.removeEventListener("pointerup",this.#i)}attach(a){this.#r.set(a.id,a)}detach(a){this.#r.delete(a.id),this.#t?.removePointerInTextLayer(a.contentDiv)}remove(a){this.#s.removeEditor(a),this.detach(a),this.annotationStorage.remove(a.id),a.div.style.display="none",setTimeout(()=>{a.div.style.display="",a.div.remove(),a.isAttachedToDOM=!1,document.activeElement===document.body&&this.#s.focusMainContainer()},0),this.#o||this.addInkEditorIfNeeded(!1)}#u(a){a.parent!==this&&(this.attach(a),a.pageIndex=this.pageIndex,a.parent?.detach(a),a.parent=this,a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))}add(a){if(this.#u(a),this.#s.addEditor(a),this.attach(a),!a.isAttachedToDOM){const d=a.render();this.div.append(d),a.isAttachedToDOM=!0}this.moveEditorInDOM(a),a.onceAdded(),this.addToAnnotationStorage(a)}moveEditorInDOM(a){this.#t?.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addToAnnotationStorage(a){!a.isEmpty()&&!this.annotationStorage.has(a.id)&&this.annotationStorage.setValue(a.id,a)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addANewEditor(a){this.addCommands({cmd:()=>{this.addOrRebuild(a)},undo:()=>{a.remove()},mustExec:!0})}addUndoableEditor(a){this.addCommands({cmd:()=>{this.addOrRebuild(a)},undo:()=>{a.remove()},mustExec:!1})}getNextId(){return this.#s.getId()}#l(a){switch(this.#s.getMode()){case f.AnnotationEditorType.FREETEXT:return new I.FreeTextEditor(a);case f.AnnotationEditorType.INK:return new k.InkEditor(a)}return null}deserialize(a){switch(a.annotationType){case f.AnnotationEditorType.FREETEXT:return I.FreeTextEditor.deserialize(a,this);case f.AnnotationEditorType.INK:return k.InkEditor.deserialize(a,this)}return null}#c(a){const d=this.getNextId(),u=this.#l({parent:this,id:d,x:a.offsetX,y:a.offsetY});return u&&this.add(u),u}setSelected(a){this.#s.setSelected(a)}toggleSelected(a){this.#s.toggleSelected(a)}isSelected(a){return this.#s.isSelected(a)}unselect(a){this.#s.unselect(a)}pointerup(a){if(!(0!==a.button||a.ctrlKey&&n.KeyboardManager.platform.isMac)&&a.target===this.div&&this.#h){if(this.#h=!1,!this.#e)return void(this.#e=!0);this.#c(a)}}pointerdown(a){if(0!==a.button||a.ctrlKey&&n.KeyboardManager.platform.isMac||a.target!==this.div)return;this.#h=!0;const u=this.#s.getActive();this.#e=!u||u.isEmpty()}drop(a){const d=a.dataTransfer.getData("text/plain"),u=this.#s.getEditor(d);if(!u)return;a.preventDefault(),a.dataTransfer.dropEffect="move",this.#u(u);const p=this.div.getBoundingClientRect();u.translate(a.clientX-p.x-u.startX,a.clientY-p.y-u.startY),this.moveEditorInDOM(u),u.div.focus()}dragover(a){a.preventDefault()}destroy(){this.#s.getActive()?.parent===this&&this.#s.setActiveEditor(null);for(const a of this.#r.values())this.#t?.removePointerInTextLayer(a.contentDiv),a.isAttachedToDOM=!1,a.div.remove(),a.parent=null;this.div=null,this.#r.clear(),this.#s.removeLayer(this)}#a(){this.#o=!0;for(const a of this.#r.values())a.isEmpty()&&a.remove();this.#o=!1}render(a){this.viewport=a.viewport,(0,n.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const d of this.#s.getEditors(this.pageIndex))this.add(d);this.updateMode()}update(a){this.viewport=a.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[a,d,u,p]=this.viewport.viewBox;return[u-a,p-d]}get viewportBaseDimensions(){const{width:a,height:d,rotation:u}=this.viewport;return u%180==0?[a,d]:[d,a]}setDimensions(){const{width:a,height:d,rotation:u}=this.viewport,p=u%180!=0,r=Math.floor(a)+"px",g=Math.floor(d)+"px";this.div.style.width=p?g:r,this.div.style.height=p?r:g,this.div.setAttribute("data-main-rotation",u)}}return A})()},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=E(1),f=E(7),I=E(6);class k extends I.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivKeydown.bind(this);#n;#r="";#h=!1;#o;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new f.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.prototype.commitOrRemove]]);static _type="freetext";constructor(A){super({...A,name:"freeTextEditor"}),this.#n=A.color||k._defaultColor||I.AnnotationEditor._defaultLineColor,this.#o=A.fontSize||k._defaultFontSize}static initialize(A){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(a=>[a,A.get(a)]));const h=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(h.getPropertyValue("--freetext-padding"))}static updateDefaultParams(A,h){switch(A){case n.AnnotationEditorParamsType.FREETEXT_SIZE:k._defaultFontSize=h;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:k._defaultColor=h}}updateParams(A,h){switch(A){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#s(h);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#u(h)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,k._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,k._defaultColor||I.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#o],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#n]]}#s(A){const h=d=>{this.editorDiv.style.fontSize=`calc(${d}px * var(--scale-factor))`,this.translate(0,-(d-this.#o)*this.parent.scaleFactor),this.#o=d,this.#c()},a=this.#o;this.parent.addCommands({cmd:()=>{h(A)},undo:()=>{h(a)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#u(A){const h=this.#n;this.parent.addCommands({cmd:()=>{this.#n=A,this.editorDiv.style.color=A},undo:()=>{this.#n=h,this.editorDiv.style.color=h},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){return[-k._internalPadding*this.parent.scaleFactor,-(k._internalPadding+this.#o)*this.parent.scaleFactor]}rebuild(){super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.div.focus(),this.isEditing=!1)}focusin(A){super.focusin(A),A.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}#l(){const A=this.editorDiv.getElementsByTagName("div");if(0===A.length)return this.editorDiv.innerText;const h=[];for(let a=0,d=A.length;a<d;a++){const p=A[a].firstChild;h.push("#text"===p?.nodeName?p.data:"")}return h.join("\n")}#c(){const[A,h]=this.parent.viewportBaseDimensions,a=this.div.getBoundingClientRect();this.width=a.width/A,this.height=a.height/h}commit(){super.commit(),this.#h||(this.#h=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#r=this.#l().trimEnd(),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(A){this.enableEditMode(),this.editorDiv.focus()}keydown(A){A.target===this.div&&"Enter"===A.key&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(A){k._keyboardManager.exec(this,A)}editorDivFocus(A){this.isEditing=!0}editorDivBlur(A){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let A,h;this.width&&(A=this.x,h=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),k._l10nPromise.get("editor_free_text_aria_label").then(d=>this.editorDiv?.setAttribute("aria-label",d)),k._l10nPromise.get("free_text_default_content").then(d=>this.editorDiv?.setAttribute("default-content",d)),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${this.#o}px * var(--scale-factor))`,a.color=this.#n,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[d,u]=this.parent.viewportBaseDimensions;this.setAt(A*d,h*u,this.width*d,this.height*u);for(const p of this.#r.split("\n")){const r=document.createElement("div");r.append(p?document.createTextNode(p):document.createElement("br")),this.editorDiv.append(r)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(A,h){const a=super.deserialize(A,h);return a.#o=A.fontSize,a.#n=n.Util.makeHexColor(...A.color),a.#r=A.value,a}serialize(){if(this.isEmpty())return null;const A=k._internalPadding*this.parent.scaleFactor,h=this.getRect(A,A),a=I.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:n.AnnotationEditorType.FREETEXT,color:a,fontSize:this.#o,value:this.#r,pageIndex:this.parent.pageIndex,rect:h,rotation:this.rotation}}}e.FreeTextEditor=k},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,Object.defineProperty(e,"fitCurve",{enumerable:!0,get:function(){return I.fitCurve}});var n=E(1),f=E(6),I=E(25),k=E(7);const w=16;e.InkEditor=(()=>{class h extends f.AnnotationEditor{#t=0;#e=0;#i=0;#n=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#h=this.canvasPointerup.bind(this);#o=this.canvasPointerdown.bind(this);#s=!1;#u=!1;#l=null;#c=null;#a=0;#m=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(d){super({...d,name:"inkEditor"}),this.color=d.color||null,this.thickness=d.thickness||null,this.opacity=d.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(d){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(u=>[u,d.get(u)]))}static updateDefaultParams(d,u){switch(d){case n.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=u;break;case n.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=u;break;case n.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=u/100}}updateParams(d,u){switch(d){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#C(u);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#T(u);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#b(u)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*h._defaultOpacity)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#C(d){const u=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=d,this.#E()},undo:()=>{this.thickness=u,this.#E()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#T(d){const u=this.color;this.parent.addCommands({cmd:()=>{this.color=d,this.#f()},undo:()=>{this.color=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#b(d){d/=100;const u=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=d,this.#f()},undo:()=>{this.opacity=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),null!==this.div&&(this.canvas||(this.#g(),this.#_()),this.isAttachedToDOM||(this.parent.add(this),this.#S()),this.#E())}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}enableEditMode(){this.#s||null===this.canvas||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#o),this.canvas.addEventListener("pointerup",this.#h))}disableEditMode(){!this.isInEditMode()||null===this.canvas||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#o),this.canvas.removeEventListener("pointerup",this.#h))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#x(){const{width:d,height:u,rotation:p}=this.parent.viewport;switch(p){case 90:return[0,d,d,u];case 180:return[d,u,d,u];case 270:return[u,0,d,u];default:return[0,0,d,u]}}#y(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,k.opacityToHex)(this.opacity)}`}#d(d,u){this.isEditing=!0,this.#u||(this.#u=!0,this.#S(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||f.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([d,u]),this.#l=null,this.#y(),this.ctx.beginPath(),this.ctx.moveTo(d,u),this.#p=()=>{this.#p&&(this.#l&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#f(),this.ctx.lineTo(...this.#l),this.#l=null,this.ctx.stroke()),window.requestAnimationFrame(this.#p))},window.requestAnimationFrame(this.#p)}#A(d,u){const[p,r]=this.currentPath.at(-1);d===p&&u===r||(this.currentPath.push([d,u]),this.#l=[d,u])}#P(d,u){this.ctx.closePath(),this.#p=null,d=Math.min(Math.max(d,0),this.canvas.width),u=Math.min(Math.max(u,0),this.canvas.height);const[p,r]=this.currentPath.at(-1);let g;if((d!==p||u!==r)&&this.currentPath.push([d,u]),1!==this.currentPath.length)g=(0,I.fitCurve)(this.currentPath,30,null);else{const D=[d,u];g=[[D,D.slice(),D.slice(),D]]}const b=h.#R(g);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(g),this.bezierPath2D.push(b),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#g(),this.#_()),this.#E())},mustExec:!0})}#f(){if(this.isEmpty())return void this.#w();this.#y();const{canvas:d,ctx:u}=this;u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,d.width,d.height),this.#w();for(const p of this.bezierPath2D)u.stroke(p)}commit(){this.#s||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#s=!0,this.div.classList.add("disabled"),this.#E(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(d){super.focusin(d),this.enableEditMode()}canvasPointerdown(d){0!==d.button||!this.isInEditMode()||this.#s||(this.setInForeground(),"mouse"!==d.type&&this.div.focus(),d.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#n),this.#d(d.offsetX,d.offsetY))}canvasPointermove(d){d.stopPropagation(),this.#A(d.offsetX,d.offsetY)}canvasPointerup(d){0===d.button&&this.isInEditMode()&&0!==this.currentPath.length&&(d.stopPropagation(),this.#v(d),this.setInBackground())}canvasPointerleave(d){this.#v(d),this.setInBackground()}#v(d){this.#P(d.offsetX,d.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#n),this.parent.addToAnnotationStorage(this)}#g(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",h._l10nPromise.get("editor_ink_canvas_aria_label").then(d=>this.canvas?.setAttribute("aria-label",d)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#_(){this.#c=new ResizeObserver(d=>{const u=d[0].contentRect;u.width&&u.height&&this.setDimensions(u.width,u.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let d,u;this.width&&(d=this.x,u=this.y),super.render(),h._l10nPromise.get("editor_ink_aria_label").then(M=>this.div?.setAttribute("aria-label",M));const[p,r,g,b]=this.#x();if(this.setAt(p,r,0,0),this.setDims(g,b),this.#g(),this.width){const[M,T]=this.parent.viewportBaseDimensions;this.setAt(d*M,u*T,this.width*M,this.height*T),this.#u=!0,this.#S(),this.setDims(this.width*M,this.height*T),this.#f(),this.#O(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#_(),this.div}#S(){if(!this.#u)return;const[d,u]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*d),this.canvas.height=Math.ceil(this.height*u),this.#w()}setDimensions(d,u){const p=Math.round(d),r=Math.round(u);if(this.#a===p&&this.#m===r)return;this.#a=p,this.#m=r,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-d/u)>.01&&(u=Math.ceil(d/this.#t),this.setDims(d,u));const[g,b]=this.parent.viewportBaseDimensions;this.width=d/g,this.height=u/b,this.#s&&this.#F(d,u),this.#S(),this.#f(),this.canvas.style.visibility="visible"}#F(d,u){const p=this.#k(),r=(d-p)/this.#i,g=(u-p)/this.#e;this.scaleFactor=Math.min(r,g)}#w(){const d=this.#k()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+d,this.translationY*this.scaleFactor+d)}static#R(d){const u=new Path2D;for(let p=0,r=d.length;p<r;p++){const[g,b,M,T]=d[p];0===p&&u.moveTo(...g),u.bezierCurveTo(b[0],b[1],M[0],M[1],T[0],T[1])}return u}#D(d,u,p,r){const b=[],M=this.thickness/2;let T,D;for(const _ of this.paths){T=[],D=[];for(let s=0,l=_.length;s<l;s++){const[y,F,R,j]=_[s],N=d*(y[0]+u)+M,tt=r-d*(y[1]+p)-M,Z=d*(F[0]+u)+M,Y=r-d*(F[1]+p)-M,V=d*(R[0]+u)+M,U=r-d*(R[1]+p)-M,B=d*(j[0]+u)+M,X=r-d*(j[1]+p)-M;0===s&&(T.push(N,tt),D.push(N,tt)),T.push(Z,Y,V,U,B,X),this.#I(N,tt,Z,Y,V,U,B,X,4,D)}b.push({bezier:T,points:D})}return b}#I(d,u,p,r,g,b,M,T,D,_){if(this.#L(d,u,p,r,g,b,M,T))_.push(M,T);else{for(let s=1;s<D-1;s++){const l=s/D,y=1-l;let F=l*d+y*p,R=l*u+y*r,j=l*p+y*g,N=l*r+y*b;F=l*F+y*j,R=l*R+y*N,j=l*j+y*(l*g+y*M),N=l*N+y*(l*b+y*T),F=l*F+y*j,R=l*R+y*N,_.push(F,R)}_.push(M,T)}}#L(d,u,p,r,g,b,M,T){const s=(3*r-2*u-T)**2,y=(3*b-u-2*T)**2;return Math.max((3*p-2*d-M)**2,(3*g-d-2*M)**2)+Math.max(s,y)<=10}#M(){let d=1/0,u=-1/0,p=1/0,r=-1/0;for(const g of this.paths)for(const[b,M,T,D]of g){const _=n.Util.bezierBoundingBox(...b,...M,...T,...D);d=Math.min(d,_[0]),p=Math.min(p,_[1]),u=Math.max(u,_[2]),r=Math.max(r,_[3])}return[d,p,u,r]}#k(){return this.#s?Math.ceil(this.thickness*this.parent.scaleFactor):0}#E(d=!1){if(this.isEmpty())return;if(!this.#s)return void this.#f();const u=this.#M(),p=this.#k();this.#i=Math.max(w,u[2]-u[0]),this.#e=Math.max(w,u[3]-u[1]);const r=Math.ceil(p+this.#i*this.scaleFactor),g=Math.ceil(p+this.#e*this.scaleFactor),[b,M]=this.parent.viewportBaseDimensions;this.width=r/b,this.height=g/M,this.#t=r/g,this.#O();const T=this.translationX,D=this.translationY;this.translationX=-u[0],this.translationY=-u[1],this.#S(),this.#f(),this.#a=r,this.#m=g,this.setDims(r,g);const _=d?p/this.scaleFactor/2:0;this.translate(T-this.translationX-_,D-this.translationY-_)}#O(){const{style:d}=this.div;this.#t>=1?(d.minHeight="16px",d.minWidth=`${Math.round(this.#t*w)}px`):(d.minWidth="16px",d.minHeight=`${Math.round(w/this.#t)}px`)}static deserialize(d,u){const p=super.deserialize(d,u);p.thickness=d.thickness,p.color=n.Util.makeHexColor(...d.color),p.opacity=d.opacity;const[r,g]=u.pageDimensions,b=p.width*r,M=p.height*g,T=u.scaleFactor,D=d.thickness/2;p.#t=b/M,p.#s=!0,p.#a=Math.round(b),p.#m=Math.round(M);for(const{bezier:s}of d.paths){const l=[];p.paths.push(l);let y=T*(s[0]-D),F=T*(M-s[1]-D);for(let j=2,N=s.length;j<N;j+=6){const U=T*(s[j+4]-D),B=T*(M-s[j+5]-D);l.push([[y,F],[T*(s[j]-D),T*(M-s[j+1]-D)],[T*(s[j+2]-D),T*(M-s[j+3]-D)],[U,B]]),y=U,F=B}const R=this.#R(l);p.bezierPath2D.push(R)}const _=p.#M();return p.#i=Math.max(w,_[2]-_[0]),p.#e=Math.max(w,_[3]-_[1]),p.#F(b,M),p}serialize(){if(this.isEmpty())return null;const d=this.getRect(0,0),u=this.rotation%180==0?d[3]-d[1]:d[2]-d[0],p=f.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:p,thickness:this.thickness,opacity:this.opacity,paths:this.#D(this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,u),pageIndex:this.parent.pageIndex,rect:d,rotation:this.rotation}}}return h})()},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fitCurve=void 0;const n=E(26);e.fitCurve=n},$=>{function E(r,g,b,M,T){var _,s,l,y,F,R,j,N,tt,Z,Y,V,U;if(2===r.length)return V=u.vectorLen(u.subtract(r[0],r[1]))/3,[_=[r[0],u.addArrays(r[0],u.mulItems(g,V)),u.addArrays(r[1],u.mulItems(b,V)),r[1]]];if(s=function w(r){var b,M,T,g=[];return r.forEach((D,_)=>{b=_?M+u.vectorLen(u.subtract(D,T)):0,g.push(b),M=b,T=D}),g=g.map(D=>D/M)}(r),[_,y,R]=n(r,s,s,g,b,T),0===y||y<M)return[_];if(y<M*M)for(l=s,F=y,j=R,U=0;U<20;U++){if(l=I(_,r,l),[_,y,R]=n(r,s,l,g,b,T),y<M)return[_];if(R===j){let B=y/F;if(B>.9999&&B<1.0001)break}F=y,j=R}return Y=[],(N=u.subtract(r[R-1],r[R+1])).every(B=>0===B)&&(N=u.subtract(r[R-1],r[R]),[N[0],N[1]]=[-N[1],N[0]]),tt=u.normalize(N),Z=u.mulItems(tt,-1),(Y=Y.concat(E(r.slice(0,R+1),g,tt,M,T))).concat(E(r.slice(R),Z,b,M,T))}function n(r,g,b,M,T,D){var _,s,l;return _=function f(r,g,b,M){var T,D,_,s,l,y,j,N,tt,Z,Y,V,U,B,X,C=r[0],o=r[r.length-1];for(T=[C,null,null,o],D=u.zeros_Xx2x2(g.length),Y=0,V=g.length;Y<V;Y++)(_=D[Y])[0]=u.mulItems(b,3*(B=g[Y])*((X=1-B)*X)),_[1]=u.mulItems(M,3*X*(B*B));for(s=[[0,0],[0,0]],l=[0,0],Y=0,V=r.length;Y<V;Y++)B=g[Y],s[0][0]+=u.dot((_=D[Y])[0],_[0]),s[0][1]+=u.dot(_[0],_[1]),s[1][0]+=u.dot(_[0],_[1]),s[1][1]+=u.dot(_[1],_[1]),U=u.subtract(r[Y],p.q([C,C,o,o],B)),l[0]+=u.dot(_[0],U),l[1]+=u.dot(_[1],U);return j=0==(y=s[0][0]*s[1][1]-s[1][0]*s[0][1])?0:(l[0]*s[1][1]-l[1]*s[0][1])/y,N=0===y?0:(s[0][0]*l[1]-s[1][0]*l[0])/y,j<(tt=1e-6*(Z=u.vectorLen(u.subtract(C,o))))||N<tt?(T[1]=u.addArrays(C,u.mulItems(b,Z/3)),T[2]=u.addArrays(o,u.mulItems(M,Z/3))):(T[1]=u.addArrays(C,u.mulItems(b,j)),T[2]=u.addArrays(o,u.mulItems(M,N))),T}(r,b,M,T),[s,l]=function A(r,g,b){var M,T,D,_,s,l,y,F;T=0,D=Math.floor(r.length/2);const R=h(g,10);for(s=0,l=r.length;s<l;s++)y=r[s],F=a(0,b[s],R,10),(M=(_=u.subtract(p.q(g,F),y))[0]*_[0]+_[1]*_[1])>T&&(T=M,D=s);return[T,D]}(r,_,g),D&&D({bez:_,points:r,params:g,maxErr:s,maxPoint:l}),[_,s,l]}function I(r,g,b){return b.map((M,T)=>function k(r,g,b){var M=u.subtract(p.q(r,b),g),T=p.qprime(r,b),D=u.mulMatrix(M,T),_=u.sum(u.squareItems(T))+2*u.mulMatrix(M,p.qprimeprime(r,b));return 0===_?b:b-D/_}(r,g[T],M))}var h=function(r,g){for(var b,M=[0],T=r[0],D=0,_=1;_<=g;_++)b=p.q(r,_/g),D+=u.vectorLen(u.subtract(b,T)),M.push(D),T=b;return M.map(s=>s/D)};function a(r,g,b,M){if(g<0)return 0;if(g>1)return 1;for(var D,s,l,y=1;y<=M;y++)if(g<=b[y]){l=(g-(D=b[y-1]))/(b[y]-D)*(y/M-(s=(y-1)/M))+s;break}return l}function d(r,g){return u.normalize(u.subtract(r,g))}class u{static zeros_Xx2x2(g){for(var b=[];g--;)b.push([0,0]);return b}static mulItems(g,b){return g.map(M=>M*b)}static mulMatrix(g,b){return g.reduce((M,T,D)=>M+T*b[D],0)}static subtract(g,b){return g.map((M,T)=>M-b[T])}static addArrays(g,b){return g.map((M,T)=>M+b[T])}static addItems(g,b){return g.map(M=>M+b)}static sum(g){return g.reduce((b,M)=>b+M)}static dot(g,b){return u.mulMatrix(g,b)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,b){return g.map(M=>M/b)}static squareItems(g){return g.map(b=>b*b)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class p{static q(g,b){var M=1-b,T=u.mulItems(g[0],M*M*M),D=u.mulItems(g[1],3*M*M*b),_=u.mulItems(g[2],3*M*b*b),s=u.mulItems(g[3],b*b*b);return u.addArrays(u.addArrays(T,D),u.addArrays(_,s))}static qprime(g,b){var M=1-b,T=u.mulItems(u.subtract(g[1],g[0]),3*M*M),D=u.mulItems(u.subtract(g[2],g[1]),6*M*b),_=u.mulItems(u.subtract(g[3],g[2]),3*b*b);return u.addArrays(u.addArrays(T,D),_)}static qprimeprime(g,b){return u.addArrays(u.mulItems(u.addArrays(u.subtract(g[2],u.mulItems(g[1],2)),g[0]),6*(1-b)),u.mulItems(u.addArrays(u.subtract(g[3],u.mulItems(g[2],2)),g[1]),6*b))}}$.exports=function e(r,g,b){if(!Array.isArray(r))throw new TypeError("First argument should be an array");if(r.forEach(_=>{if(!Array.isArray(_)||_.some(s=>"number"!=typeof s)||_.length!==r[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(r=r.filter((_,s)=>0===s||!_.every((l,y)=>l===r[s-1][y]))).length<2)return[];const M=r.length,T=d(r[1],r[0]),D=d(r[M-2],r[M-1]);return E(r,T,D,g,b)},$.exports.fitCubic=E,$.exports.createTangent=d},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var n=E(1),f=E(8),I=E(5),k=E(28),w=E(29);const A=1e3,a=new WeakSet;function d(P){return{width:P[2]-P[0],height:P[3]-P[1]}}class u{static create(t){switch(t.data.annotationType){case n.AnnotationType.LINK:return new r(t);case n.AnnotationType.TEXT:return new g(t);case n.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new M(t);case"Btn":return t.data.radioButton?new D(t):t.data.checkBox?new T(t):new _(t);case"Ch":return new s(t)}return new b(t);case n.AnnotationType.POPUP:return new l(t);case n.AnnotationType.FREETEXT:return new F(t);case n.AnnotationType.LINE:return new R(t);case n.AnnotationType.SQUARE:return new j(t);case n.AnnotationType.CIRCLE:return new N(t);case n.AnnotationType.POLYLINE:return new tt(t);case n.AnnotationType.CARET:return new Y(t);case n.AnnotationType.INK:return new V(t);case n.AnnotationType.POLYGON:return new Z(t);case n.AnnotationType.HIGHLIGHT:return new U(t);case n.AnnotationType.UNDERLINE:return new B(t);case n.AnnotationType.SQUIGGLY:return new X(t);case n.AnnotationType.STRIKEOUT:return new C(t);case n.AnnotationType.STAMP:return new o(t);case n.AnnotationType.FILEATTACHMENT:return new c(t);default:return new p(t)}}}class p{constructor(t,{isRenderable:i=!1,ignoreBorder:m=!1,createQuadrilaterals:v=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,i&&(this.container=this._createContainer(m)),v&&(this.quadrilaterals=this._createQuadrilaterals(m))}_createContainer(t=!1){const i=this.data,m=this.page,v=this.viewport,x=document.createElement("section"),{width:O,height:L}=d(i.rect),[W,z,q,K]=v.viewBox,et=q-W,J=K-z;x.setAttribute("data-annotation-id",i.id);const st=n.Util.normalizeRect([i.rect[0],m.view[3]-i.rect[1]+m.view[1],i.rect[2],m.view[3]-i.rect[3]+m.view[1]]);if(!t&&i.borderStyle.width>0){x.style.borderWidth=`${i.borderStyle.width}px`;const at=i.borderStyle.horizontalCornerRadius,ot=i.borderStyle.verticalCornerRadius;switch(at>0||ot>0?x.style.borderRadius=`calc(${at}px * var(--scale-factor)) / calc(${ot}px * var(--scale-factor))`:this instanceof D&&(x.style.borderRadius=`calc(${O}px * var(--scale-factor)) / calc(${L}px * var(--scale-factor))`),i.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:x.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:x.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:x.style.borderBottomStyle="solid"}const nt=i.borderColor||null;nt?x.style.borderColor=n.Util.makeHexColor(0|nt[0],0|nt[1],0|nt[2]):x.style.borderWidth=0}x.style.left=100*(st[0]-W)/et+"%",x.style.top=100*(st[1]-z)/J+"%";const{rotation:it}=i;return i.hasOwnCanvas||0===it?(x.style.width=100*O/et+"%",x.style.height=100*L/J+"%"):this.setRotation(it,x),x}setRotation(t,i=this.container){const[m,v,x,O]=this.viewport.viewBox,L=x-m,W=O-v,{width:z,height:q}=d(this.data.rect);let K,et;t%180==0?(K=100*z/L,et=100*q/W):(K=100*q/L,et=100*z/W),i.style.width=`${K}%`,i.style.height=`${et}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,m,v)=>{const x=v.detail[i];v.target.style[m]=k.ColorConverters[`${x[0]}_HTML`](x.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:i=>{const m=i.detail.display%2==1;this.container.style.visibility=m?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:m,print:0===i.detail.display||3===i.detail.display})},print:i=>{this.annotationStorage.setValue(this.data.id,{print:i.detail.print})},hidden:i=>{this.container.style.visibility=i.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i.detail.hidden})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.detail.readonly?i.target.setAttribute("readonly",""):i.target.removeAttribute("readonly")},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const m=i.detail.rotation;this.setRotation(m),this.annotationStorage.setValue(this.data.id,{rotation:m})}})}_dispatchEventFromSandbox(t,i){const m=this._commonActions;for(const v of Object.keys(i.detail)){const x=t[v]||m[v];x&&x(i)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const m=this._commonActions;for(const[v,x]of Object.entries(i)){const O=m[v];O&&(O({detail:{[v]:x},target:t}),delete i[v])}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const i=[],m=this.data.rect;for(const v of this.data.quadPoints)this.data.rect=[v[2].x,v[2].y,v[1].x,v[1].y],i.push(this._createContainer(t));return this.data.rect=m,i}_createPopup(t,i){let m=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,m=this.quadrilaterals[0]),t||((t=document.createElement("div")).className="popupTriggerArea",m.append(t));const x=new y({container:m,trigger:t,color:i.color,titleObj:i.titleObj,modificationDate:i.modificationDate,contentsObj:i.contentsObj,richText:i.richText,hideWrapper:!0}).render();x.style.left="100%",m.append(x)}_renderQuadrilaterals(t){for(const i of this.quadrilaterals)i.className=t;return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const m=[];if(this._fieldObjects){const v=this._fieldObjects[t];if(v)for(const{page:x,id:O,exportValues:L}of v){if(-1===x||O===i)continue;const W="string"==typeof L?L:null,z=document.querySelector(`[data-element-id="${O}"]`);!z||a.has(z)?m.push({id:O,exportValue:W,domElement:z}):(0,n.warn)(`_getElementsByName - element not allowed: ${O}`)}return m}for(const v of document.getElementsByName(t)){const{id:x,exportValue:O}=v;x!==i&&a.has(v)&&m.push({id:x,exportValue:O,domElement:v})}return m}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class r extends p{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,m=document.createElement("a");m.setAttribute("data-element-id",t.id);let v=!1;return t.url?(i.addLinkAttributes(m,t.url,t.newWindow),v=!0):t.action?(this._bindNamedAction(m,t.action),v=!0):t.dest?(this._bindLink(m,t.dest),v=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(m,t),v=!0),t.resetForm?(this._bindResetFormAction(m,t.resetForm),v=!0):this.isTooltipOnly&&!v&&(this._bindLink(m,""),v=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((x,O)=>{const L=0===O?m:m.cloneNode();return x.append(L),x}):(this.container.className="linkAnnotation",v&&this.container.append(m),this.container)}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||""===i)&&(t.className="internalLink")}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),t.className="internalLink"}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const m=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const v of Object.keys(i.actions)){const x=m.get(v);x&&(t[x]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:v}}),!1))}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,i){const m=t.onclick;if(m||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects)return(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(m||(t.onclick=()=>!1));t.onclick=()=>{m&&m();const{fields:v,refs:x,include:O}=i,L=[];if(0!==v.length||0!==x.length){const q=new Set(x);for(const K of v){const et=this._fieldObjects[K]||[];for(const{id:J}of et)q.add(J)}for(const K of Object.values(this._fieldObjects))for(const et of K)q.has(et.id)===O&&L.push(et)}else for(const q of Object.values(this._fieldObjects))L.push(...q);const W=this.annotationStorage,z=[];for(const q of L){const{id:K}=q;switch(z.push(K),q.type){case"text":case"combobox":case"listbox":W.setValue(K,{value:q.defaultValue||""});break;case"checkbox":case"radiobutton":W.setValue(K,{value:q.defaultValue===q.exportValues});break;default:continue}const et=document.querySelector(`[data-element-id="${K}"]`);et&&(a.has(et)?et.dispatchEvent(new Event("resetform")):(0,n.warn)(`_bindResetFormAction - element not allowed: ${K}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:z,name:"ResetForm"}}),!1}}}class g extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class b extends p{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:i,isMac:m}=p.platform;return i&&t.ctrlKey||m&&t.metaKey}_setEventListener(t,i,m,v){i.includes("mouse")?t.addEventListener(i,x=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:m,value:v(x),shift:x.shiftKey,modifier:this._getKeyModifier(x)}})}):t.addEventListener(i,x=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:m,value:v(x)}})})}_setEventListeners(t,i,m){for(const[v,x]of i)("Action"===x||this.data.actions?.[x])&&this._setEventListener(t,v,x,m)}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=null===i?"transparent":n.Util.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const{fontColor:m}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||9,x=t.style;let O;if(this.data.multiLine){const L=Math.abs(this.data.rect[3]-this.data.rect[1]),W=Math.round(L/(n.LINE_FACTOR*v))||1;O=Math.min(v,Math.round(L/W/n.LINE_FACTOR))}else{const L=Math.abs(this.data.rect[3]-this.data.rect[1]);O=Math.min(v,Math.round(L/n.LINE_FACTOR))}x.fontSize=`calc(${O}px * var(--scale-factor))`,x.color=n.Util.makeHexColor(m[0],m[1],m[2]),null!==this.data.textAlignment&&(x.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class M extends b{constructor(t){super(t,{isRenderable:t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,i,m,v){const x=this.annotationStorage;for(const O of this._getElementsByName(t.name,t.id))O.domElement&&(O.domElement[i]=m),x.setValue(O.id,{[v]:m})}render(){const t=this.annotationStorage,i=this.data.id;this.container.className="textWidgetAnnotation";let m=null;if(this.renderForms){const v=t.getValue(i,{value:this.data.fieldValue});let x=v.formattedValue||v.value||"";const O=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;O&&x.length>O&&(x=x.slice(0,O));const L={userValue:x,formattedValue:null,valueOnFocus:""};this.data.multiLine?(m=document.createElement("textarea"),m.textContent=x,this.data.doNotScroll&&(m.style.overflowY="hidden")):(m=document.createElement("input"),m.type="text",m.setAttribute("value",x),this.data.doNotScroll&&(m.style.overflowX="hidden")),a.add(m),m.setAttribute("data-element-id",i),m.disabled=this.data.readOnly,m.name=this.data.fieldName,m.tabIndex=A,this._setRequired(m,this.data.required),O&&(m.maxLength=O),m.addEventListener("input",z=>{t.setValue(i,{value:z.target.value}),this.setPropertyOnSiblings(m,"value",z.target.value,"value")}),m.addEventListener("resetform",z=>{m.value=L.userValue=this.data.defaultFieldValue??"",L.formattedValue=null});let W=z=>{const{formattedValue:q}=L;null!=q&&(z.target.value=q),z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){m.addEventListener("focus",q=>{L.userValue&&(q.target.value=L.userValue),L.valueOnFocus=q.target.value}),m.addEventListener("updatefromsandbox",q=>{this._dispatchEventFromSandbox({value(et){L.userValue=et.detail.value??"",t.setValue(i,{value:L.userValue.toString()}),et.target.value=L.userValue},formattedValue(et){const{formattedValue:J}=et.detail;L.formattedValue=J,null!=J&&et.target!==document.activeElement&&(et.target.value=J),t.setValue(i,{formattedValue:J})},selRange(et){et.target.setSelectionRange(...et.detail.selRange)},charLimit:et=>{const{charLimit:J}=et.detail,{target:st}=et;if(0===J)return void st.removeAttribute("maxLength");st.setAttribute("maxLength",J);let it=L.userValue;!it||it.length<=J||(it=it.slice(0,J),st.value=L.userValue=it,t.setValue(i,{value:it}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:it,willCommit:!0,commitKey:1,selStart:st.selectionStart,selEnd:st.selectionEnd}}))}},q)}),m.addEventListener("keydown",q=>{let K=-1;if("Escape"===q.key?K=0:"Enter"===q.key?K=2:"Tab"===q.key&&(K=3),-1===K)return;const{value:et}=q.target;L.valueOnFocus!==et&&(L.userValue=et,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:et,willCommit:!0,commitKey:K,selStart:q.target.selectionStart,selEnd:q.target.selectionEnd}}))});const z=W;W=null,m.addEventListener("blur",q=>{const{value:K}=q.target;L.userValue=K,this._mouseState.isDown&&L.valueOnFocus!==K&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:K,willCommit:!0,commitKey:1,selStart:q.target.selectionStart,selEnd:q.target.selectionEnd}}),z(q)}),this.data.actions?.Keystroke&&m.addEventListener("beforeinput",q=>{const{data:K,target:et}=q,{value:J,selectionStart:st,selectionEnd:it}=et;let at=st,ot=it;switch(q.inputType){case"deleteWordBackward":{const nt=J.substring(0,st).match(/\w*[^\w]*$/);nt&&(at-=nt[0].length);break}case"deleteWordForward":{const nt=J.substring(st).match(/^[^\w]*\w*/);nt&&(ot+=nt[0].length);break}case"deleteContentBackward":st===it&&(at-=1);break;case"deleteContentForward":st===it&&(ot+=1)}q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:J,change:K||"",willCommit:!1,selStart:at,selEnd:ot}})}),this._setEventListeners(m,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],q=>q.target.value)}if(W&&m.addEventListener("blur",W),this.data.comb){const q=(this.data.rect[2]-this.data.rect[0])/O;m.classList.add("comb"),m.style.letterSpacing=`calc(${q}px * var(--scale-factor) - 1ch)`}}else m=document.createElement("div"),m.textContent=this.data.fieldValue,m.style.verticalAlign="middle",m.style.display="table-cell";return this._setTextStyle(m),this._setBackgroundColor(m),this._setDefaultPropertiesFromJS(m),this.container.append(m),this.container}}class T extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,m=i.id;let v=t.getValue(m,{value:i.exportValue===i.fieldValue}).value;"string"==typeof v&&(v="Off"!==v,t.setValue(m,{value:v})),this.container.className="buttonWidgetAnnotation checkBox";const x=document.createElement("input");return a.add(x),x.setAttribute("data-element-id",m),x.disabled=i.readOnly,this._setRequired(x,this.data.required),x.type="checkbox",x.name=i.fieldName,v&&x.setAttribute("checked",!0),x.setAttribute("exportValue",i.exportValue),x.tabIndex=A,x.addEventListener("change",O=>{const{name:L,checked:W}=O.target;for(const z of this._getElementsByName(L,m)){const q=W&&z.exportValue===i.exportValue;z.domElement&&(z.domElement.checked=q),t.setValue(z.id,{value:q})}t.setValue(m,{value:W})}),x.addEventListener("resetform",O=>{O.target.checked=(i.defaultFieldValue||"Off")===i.exportValue}),this.enableScripting&&this.hasJSActions&&(x.addEventListener("updatefromsandbox",O=>{this._dispatchEventFromSandbox({value(W){W.target.checked="Off"!==W.detail.value,t.setValue(m,{value:W.target.checked})}},O)}),this._setEventListeners(x,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],O=>O.target.checked)),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class D extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,i=this.data,m=i.id;let v=t.getValue(m,{value:i.fieldValue===i.buttonValue}).value;"string"==typeof v&&(v=v!==i.buttonValue,t.setValue(m,{value:v}));const x=document.createElement("input");if(a.add(x),x.setAttribute("data-element-id",m),x.disabled=i.readOnly,this._setRequired(x,this.data.required),x.type="radio",x.name=i.fieldName,v&&x.setAttribute("checked",!0),x.tabIndex=A,x.addEventListener("change",O=>{const{name:L,checked:W}=O.target;for(const z of this._getElementsByName(L,m))t.setValue(z.id,{value:!1});t.setValue(m,{value:W})}),x.addEventListener("resetform",O=>{const L=i.defaultFieldValue;O.target.checked=null!=L&&L===i.buttonValue}),this.enableScripting&&this.hasJSActions){const O=i.buttonValue;x.addEventListener("updatefromsandbox",L=>{this._dispatchEventFromSandbox({value:z=>{const q=O===z.detail.value;for(const K of this._getElementsByName(z.target.name)){const et=q&&K.id===m;K.domElement&&(K.domElement.checked=et),t.setValue(K.id,{value:et})}}},L)}),this._setEventListeners(x,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],L=>L.target.checked)}return this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class _ extends r{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText);const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",m=>{this._dispatchEventFromSandbox({},m)})),t}}class s extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,i=this.data.id,m=t.getValue(i,{value:this.data.fieldValue}),v=document.createElement("select");a.add(v),v.setAttribute("data-element-id",i),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=A;let x=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",z=>{const q=this.data.defaultFieldValue;for(const K of v.options)K.selected=K.value===q});for(const z of this.data.options){const q=document.createElement("option");q.textContent=z.displayValue,q.value=z.exportValue,m.value.includes(z.exportValue)&&(q.setAttribute("selected",!0),x=!1),v.append(q)}let O=null;if(x){const z=document.createElement("option");z.value=" ",z.setAttribute("hidden",!0),z.setAttribute("selected",!0),v.prepend(z),O=()=>{z.remove(),v.removeEventListener("input",O),O=null},v.addEventListener("input",O)}const L=(z,q)=>{const K=q?"value":"textContent",et=z.target.options;return z.target.multiple?Array.prototype.filter.call(et,J=>J.selected).map(J=>J[K]):-1===et.selectedIndex?null:et[et.selectedIndex][K]},W=z=>Array.prototype.map.call(z.target.options,K=>({displayValue:K.textContent,exportValue:K.value}));return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({value(K){O?.();const et=K.detail.value,J=new Set(Array.isArray(et)?et:[et]);for(const st of v.options)st.selected=J.has(st.value);t.setValue(i,{value:L(K,!0)})},multipleSelection(K){v.multiple=!0},remove(K){const et=v.options,J=K.detail.remove;et[J].selected=!1,v.remove(J),et.length>0&&-1===Array.prototype.findIndex.call(et,it=>it.selected)&&(et[0].selected=!0),t.setValue(i,{value:L(K,!0),items:W(K)})},clear(K){for(;0!==v.length;)v.remove(0);t.setValue(i,{value:null,items:[]})},insert(K){const{index:et,displayValue:J,exportValue:st}=K.detail.insert,it=v.children[et],at=document.createElement("option");at.textContent=J,at.value=st,it?it.before(at):v.append(at),t.setValue(i,{value:L(K,!0),items:W(K)})},items(K){const{items:et}=K.detail;for(;0!==v.length;)v.remove(0);for(const J of et){const{displayValue:st,exportValue:it}=J,at=document.createElement("option");at.textContent=st,at.value=it,v.append(at)}v.options.length>0&&(v.options[0].selected=!0),t.setValue(i,{value:L(K,!0),items:W(K)})},indices(K){const et=new Set(K.detail.indices);for(const J of K.target.options)J.selected=et.has(J.index);t.setValue(i,{value:L(K,!0)})},editable(K){K.target.disabled=!K.detail.editable}},z)}),v.addEventListener("input",z=>{const q=L(z,!0),K=L(z,!1);t.setValue(i,{value:q}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:K,changeEx:q,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],z=>z.target.checked)):v.addEventListener("input",function(z){t.setValue(i,{value:L(z,!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class l extends p{constructor(t){super(t,{isRenderable:!!(t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const m=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(0===m.length)return this.container;const v=new y({container:this.container,trigger:Array.from(m),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),x=this.page,O=n.Util.normalizeRect([this.data.parentRect[0],x.view[3]-this.data.parentRect[1]+x.view[1],this.data.parentRect[2],x.view[3]-this.data.parentRect[3]+x.view[1]]),L=O[0]+this.data.parentRect[2]-this.data.parentRect[0],W=O[1],[z,q,K,et]=this.viewport.viewBox,st=et-q;return this.container.style.left=100*(L-z)/(K-z)+"%",this.container.style.top=100*(W-q)/st+"%",this.container.append(v.render()),this.container}}class y{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const i=document.createElement("div");i.className="popupWrapper",this.hideElement=this.hideWrapper?i:this.container,this.hideElement.hidden=!0;const m=document.createElement("div");m.className="popup";const v=this.color;v&&(m.style.backgroundColor=n.Util.makeHexColor(0|.7*(255-v[0])+v[0],0|.7*(255-v[1])+v[1],0|.7*(255-v[2])+v[2]));const x=document.createElement("h1");x.dir=this.titleObj.dir,x.textContent=this.titleObj.str,m.append(x);const O=f.PDFDateString.toDateObject(this.modificationDate);if(O){const L=document.createElement("span");L.className="popupDate",L.textContent="{{date}}, {{time}}",L.dataset.l10nId="annotation_date_string",L.dataset.l10nArgs=JSON.stringify({date:O.toLocaleDateString(),time:O.toLocaleTimeString()}),m.append(L)}if(!this.richText?.str||this.contentsObj?.str&&this.contentsObj.str!==this.richText.str){const L=this._formatContents(this.contentsObj);m.append(L)}else w.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:m}),m.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const L of this.trigger)L.addEventListener("click",this._toggle.bind(this)),L.addEventListener("mouseover",this._show.bind(this,!1)),L.addEventListener("mouseout",this._hide.bind(this,!1));return m.addEventListener("click",this._hide.bind(this,!0)),i.append(m),i}_formatContents({str:t,dir:i}){const m=document.createElement("p");m.className="popupContent",m.dir=i;const v=t.split(/(?:\r\n?|\n)/);for(let x=0,O=v.length;x<O;++x)m.append(document.createTextNode(v[x])),x<O-1&&m.append(document.createElement("br"));return m}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class F extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const t=document.createElement("div");t.className="annotationTextContent",t.setAttribute("role","comment");for(const i of this.textContent){const m=document.createElement("span");m.textContent=i,t.append(m)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class R extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:i,height:m}=d(t.rect),v=this.svgFactory.create(i,m,!0),x=this.svgFactory.createElement("svg:line");return x.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),x.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),x.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),x.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),x.setAttribute("stroke-width",t.borderStyle.width||1),x.setAttribute("stroke","transparent"),x.setAttribute("fill","transparent"),v.append(x),this.container.append(v),this._createPopup(x,t),this.container}}class j extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:i,height:m}=d(t.rect),v=this.svgFactory.create(i,m,!0),x=t.borderStyle.width,O=this.svgFactory.createElement("svg:rect");return O.setAttribute("x",x/2),O.setAttribute("y",x/2),O.setAttribute("width",i-x),O.setAttribute("height",m-x),O.setAttribute("stroke-width",x||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),v.append(O),this.container.append(v),this._createPopup(O,t),this.container}}class N extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:i,height:m}=d(t.rect),v=this.svgFactory.create(i,m,!0),x=t.borderStyle.width,O=this.svgFactory.createElement("svg:ellipse");return O.setAttribute("cx",i/2),O.setAttribute("cy",m/2),O.setAttribute("rx",i/2-x/2),O.setAttribute("ry",m/2-x/2),O.setAttribute("stroke-width",x||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),v.append(O),this.container.append(v),this._createPopup(O,t),this.container}}class tt extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:i,height:m}=d(t.rect),v=this.svgFactory.create(i,m,!0);let x=[];for(const L of t.vertices)x.push(L.x-t.rect[0]+","+(t.rect[3]-L.y));x=x.join(" ");const O=this.svgFactory.createElement(this.svgElementName);return O.setAttribute("points",x),O.setAttribute("stroke-width",t.borderStyle.width||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),v.append(O),this.container.append(v),this._createPopup(O,t),this.container}}class Z extends tt{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:i,height:m}=d(t.rect),v=this.svgFactory.create(i,m,!0);for(const x of t.inkLists){let O=[];for(const W of x)O.push(`${W.x-t.rect[0]},${t.rect[3]-W.y}`);O=O.join(" ");const L=this.svgFactory.createElement(this.svgElementName);L.setAttribute("points",O),L.setAttribute("stroke-width",t.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),this._createPopup(L,t),v.append(L)}return this.container.append(v),this.container}}class U extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class B extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class X extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class C extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class o extends p{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class c extends p{constructor(t){super(t,{isRenderable:!0});const{filename:i,content:m}=this.data.file;this.filename=(0,f.getFilenameFromUrl)(i),this.content=m,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:i,content:m})}render(){this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.className="popupTriggerArea",t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class S{static#t(t,i,m,v){const x=t.firstChild||t;x.id=`${f.AnnotationPrefix}${i}`,m.append(t),v?.moveElementInDOM(m,t,x,!1)}static render(t){const{annotations:i,div:m,viewport:v,accessibilityManager:x}=t;this.#e(m,v);let O=0;for(const L of i){if(L.annotationType!==n.AnnotationType.POPUP){const{width:z,height:q}=d(L.rect);if(z<=0||q<=0)continue}const W=u.create({data:L,layer:m,page:t.page,viewport:v,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new f.DOMSVGFactory,annotationStorage:t.annotationStorage||new I.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(W.isRenderable){const z=W.render();if(L.hidden&&(z.style.visibility="hidden"),Array.isArray(z))for(const q of z)q.style.zIndex=O++,S.#t(q,L.id,m,x);else z.style.zIndex=O++,W instanceof l?m.prepend(z):S.#t(z,L.id,m,x)}}this.#i(m,t.annotationCanvasMap)}static update(t){const{annotationCanvasMap:i,div:m,viewport:v}=t;this.#e(m,v),this.#i(m,i),m.hidden=!1}static#e(t,{width:i,height:m,rotation:v}){const{style:x}=t,O=v%180!=0,L=Math.floor(i)+"px",W=Math.floor(m)+"px";x.width=O?W:L,x.height=O?L:W,t.setAttribute("data-main-rotation",v)}static#i(t,i){if(i){for(const[m,v]of i){const x=t.querySelector(`[data-annotation-id="${m}"]`);if(!x)continue;const{firstChild:O}=x;O?"CANVAS"===O.nodeName?O.replaceWith(v):O.before(v):x.append(v)}i.clear()}}}e.AnnotationLayer=S},($,e)=>{function E(f){return Math.floor(255*Math.max(0,Math.min(1,f))).toString(16).padStart(2,"0")}Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0,e.ColorConverters=class n{static CMYK_G([I,k,w,A]){return["G",1-Math.min(1,.3*I+.59*w+.11*k+A)]}static G_CMYK([I]){return["CMYK",0,0,0,1-I]}static G_RGB([I]){return["RGB",I,I,I]}static G_HTML([I]){const k=E(I);return`#${k}${k}${k}`}static RGB_G([I,k,w]){return["G",.3*I+.59*k+.11*w]}static RGB_HTML([I,k,w]){return`#${E(I)}${E(k)}${E(w)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([I,k,w,A]){return["RGB",1-Math.min(1,I+A),1-Math.min(1,w+A),1-Math.min(1,k+A)]}static CMYK_HTML(I){const k=this.CMYK_RGB(I).slice(1);return this.RGB_HTML(k)}static RGB_CMYK([I,k,w]){const A=1-I,h=1-k,a=1-w;return["CMYK",A,h,a,Math.min(A,h,a)]}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=E(20);e.XfaLayer=class f{static setupStorage(k,w,A,h,a){const d=h.getValue(w,{value:null});switch(A.name){case"textarea":if(null!==d.value&&(k.textContent=d.value),"print"===a)break;k.addEventListener("input",u=>{h.setValue(w,{value:u.target.value})});break;case"input":if("radio"===A.attributes.type||"checkbox"===A.attributes.type){if(d.value===A.attributes.xfaOn?k.setAttribute("checked",!0):d.value===A.attributes.xfaOff&&k.removeAttribute("checked"),"print"===a)break;k.addEventListener("change",u=>{h.setValue(w,{value:u.target.getAttribute(u.target.checked?"xfaOn":"xfaOff")})})}else{if(null!==d.value&&k.setAttribute("value",d.value),"print"===a)break;k.addEventListener("input",u=>{h.setValue(w,{value:u.target.value})})}break;case"select":if(null!==d.value)for(const u of A.children)u.attributes.value===d.value&&(u.attributes.selected=!0);k.addEventListener("input",u=>{const p=u.target.options;h.setValue(w,{value:-1===p.selectedIndex?"":p[p.selectedIndex].value})})}}static setAttributes({html:k,element:w,storage:A=null,intent:h,linkService:a}){const{attributes:d}=w,u=k instanceof HTMLAnchorElement;"radio"===d.type&&(d.name=`${d.name}-${h}`);for(const[p,r]of Object.entries(d))if(null!=r)switch(p){case"class":r.length&&k.setAttribute(p,r.join(" "));break;case"dataId":break;case"id":k.setAttribute("data-element-id",r);break;case"style":Object.assign(k.style,r);break;case"textContent":k.textContent=r;break;default:(!u||"href"!==p&&"newWindow"!==p)&&k.setAttribute(p,r)}u&&a.addLinkAttributes(k,d.href,d.newWindow),A&&d.dataId&&this.setupStorage(k,d.dataId,w,A)}static render(k){const w=k.annotationStorage,A=k.linkService,h=k.xfaHtml,a=k.intent||"display",d=document.createElement(h.name);h.attributes&&this.setAttributes({html:d,element:h,intent:a,linkService:A});const u=[[h,-1,d]],p=k.div;if(p.append(d),k.viewport){const g=`matrix(${k.viewport.transform.join(",")})`;p.style.transform=g}"richText"!==a&&p.setAttribute("class","xfaLayer xfaFont");const r=[];for(;u.length>0;){const[g,b,M]=u.at(-1);if(b+1===g.children.length){u.pop();continue}const T=g.children[++u.at(-1)[1]];if(null===T)continue;const{name:D}=T;if("#text"===D){const s=document.createTextNode(T.value);r.push(s),M.append(s);continue}let _;if(_=T?.attributes?.xmlns?document.createElementNS(T.attributes.xmlns,D):document.createElement(D),M.append(_),T.attributes&&this.setAttributes({html:_,element:T,storage:w,intent:a,linkService:A}),T.children&&T.children.length>0)u.push([T,-1,_]);else if(T.value){const s=document.createTextNode(T.value);n.XfaText.shouldBuildText(D)&&r.push(s),_.append(s)}}for(const g of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:r}}static update(k){const w=`matrix(${k.viewport.transform.join(",")})`;k.div.style.transform=w,k.div.hidden=!1}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=function T(D){const _=new M({textContent:D.textContent,textContentStream:D.textContentStream,container:D.container,viewport:D.viewport,textDivs:D.textDivs,textContentItemsStr:D.textContentItemsStr,enhanceTextSelection:D.enhanceTextSelection});return _._render(D.timeout),_};var n=E(1),f=E(8);const k=30,A=new Map,h=/^\s+$/g;function d(D,_,s,l){const y=document.createElement("span"),F=D._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==_.str,hasEOL:_.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==_.str,hasEOL:_.hasEOL,fontSize:0};D._textDivs.push(y);const R=n.Util.transform(D._viewport.transform,_.transform);let j=Math.atan2(R[1],R[0]);const N=s[_.fontName];N.vertical&&(j+=Math.PI/2);const tt=Math.hypot(R[2],R[3]),Z=tt*function a(D,_){const s=A.get(D);if(s)return s;_.save(),_.font=`30px ${D}`;const l=_.measureText("");let y=l.fontBoundingBoxAscent,F=Math.abs(l.fontBoundingBoxDescent);if(y){_.restore();const j=y/(y+F);return A.set(D,j),j}_.strokeStyle="red",_.clearRect(0,0,k,k),_.strokeText("g",0,0);let R=_.getImageData(0,0,k,k).data;F=0;for(let j=R.length-1-3;j>=0;j-=4)if(R[j]>0){F=Math.ceil(j/4/k);break}_.clearRect(0,0,k,k),_.strokeText("A",0,k),R=_.getImageData(0,0,k,k).data,y=0;for(let j=0,N=R.length;j<N;j+=4)if(R[j]>0){y=k-Math.floor(j/4/k);break}if(_.restore(),y){const j=y/(y+F);return A.set(D,j),j}return A.set(D,.8),.8}(N.fontFamily,l);let Y,V;0===j?(Y=R[4],V=R[5]-Z):(Y=R[4]+Z*Math.sin(j),V=R[5]-Z*Math.cos(j)),y.style.left=`${Y}px`,y.style.top=`${V}px`,y.style.fontSize=`${tt}px`,y.style.fontFamily=N.fontFamily,F.fontSize=tt,y.setAttribute("role","presentation"),y.textContent=_.str,y.dir=_.dir,D._fontInspectorEnabled&&(y.dataset.fontName=_.fontName),0!==j&&(F.angle=j*(180/Math.PI));let U=!1;if(_.str.length>1||D._enhanceTextSelection&&h.test(_.str))U=!0;else if(" "!==_.str&&_.transform[0]!==_.transform[3]){const B=Math.abs(_.transform[0]),X=Math.abs(_.transform[3]);B!==X&&Math.max(B,X)/Math.min(B,X)>1.5&&(U=!0)}if(U&&(F.canvasWidth=N.vertical?_.height*D._viewport.scale:_.width*D._viewport.scale),D._textDivProperties.set(y,F),D._textContentStream&&D._layoutText(y),D._enhanceTextSelection&&F.hasText){let B=1,X=0;0!==j&&(B=Math.cos(j),X=Math.sin(j));const C=(N.vertical?_.height:_.width)*D._viewport.scale,o=tt;let c,S;0!==j?(c=[B,X,-X,B,Y,V],S=n.Util.getAxialAlignedBoundingBox([0,0,C,o],c)):S=[Y,V,Y+C,V+o],D._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:y,size:[C,o],m:c})}}function u(D){if(D._canceled)return;const _=D._textDivs,s=D._capability,l=_.length;if(l>1e5)return D._renderingDone=!0,void s.resolve();if(!D._textContentStream)for(let y=0;y<l;y++)D._layoutText(_[y]);D._renderingDone=!0,s.resolve()}function p(D,_,s){let l=0;for(let y=0;y<s;y++){const F=D[_++];F>0&&(l=l?Math.min(F,l):F)}return l}function b(D,_){_.sort(function(y,F){return y.x1-F.x1||y.index-F.index});const l=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const y of _){let F=0;for(;F<l.length&&l[F].end<=y.y1;)F++;let R=l.length-1;for(;R>=0&&l[R].start>=y.y2;)R--;let j,N,tt,Z,Y=-1/0;for(tt=F;tt<=R;tt++){let B;j=l[tt],N=j.boundary,B=N.x2>y.x1?N.index>y.index?N.x1New:y.x1:void 0===N.x2New?(N.x2+y.x1)/2:N.x2New,B>Y&&(Y=B)}for(y.x1New=Y,tt=F;tt<=R;tt++)j=l[tt],N=j.boundary,void 0===N.x2New?N.x2>y.x1?N.index>y.index&&(N.x2New=N.x2):N.x2New=Y:N.x2New>Y&&(N.x2New=Math.max(Y,N.x2));const V=[];let U=null;for(tt=F;tt<=R;tt++){j=l[tt],N=j.boundary;const B=N.x2>y.x2?N:y;U===B?V.at(-1).end=j.end:(V.push({start:j.start,end:j.end,boundary:B}),U=B)}for(l[F].start<y.y1&&(V[0].start=y.y1,V.unshift({start:l[F].start,end:y.y1,boundary:l[F].boundary})),y.y2<l[R].end&&(V.at(-1).end=y.y2,V.push({start:y.y2,end:l[R].end,boundary:l[R].boundary})),tt=F;tt<=R;tt++){if(j=l[tt],N=j.boundary,void 0!==N.x2New)continue;let B=!1;for(Z=F-1;!B&&Z>=0&&l[Z].start>=N.y1;Z--)B=l[Z].boundary===N;for(Z=R+1;!B&&Z<l.length&&l[Z].end<=N.y2;Z++)B=l[Z].boundary===N;for(Z=0;!B&&Z<V.length;Z++)B=V[Z].boundary===N;B||(N.x2New=Y)}Array.prototype.splice.apply(l,[F,R-F+1,...V])}for(const y of l){const F=y.boundary;void 0===F.x2New&&(F.x2New=Math.max(D,F.x2))}}class M{constructor({textContent:_,textContentStream:s,container:l,viewport:y,textDivs:F,textContentItemsStr:R,enhanceTextSelection:j}){j&&(0,f.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=_,this._textContentStream=s,this._container=l,this._document=l.ownerDocument,this._viewport=y,this._textDivs=F||[],this._textContentItemsStr=R||[],this._enhanceTextSelection=!!j,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(_,s){for(let l=0,y=_.length;l<y;l++)if(void 0!==_[l].str)this._textContentItemsStr.push(_[l].str),d(this,_[l],s,this._layoutTextCtx);else if("beginMarkedContentProps"===_[l].type||"beginMarkedContent"===_[l].type){const F=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==_[l].id&&this._container.setAttribute("id",`${_[l].id}`),F.append(this._container)}else"endMarkedContent"===_[l].type&&(this._container=this._container.parentNode)}_layoutText(_){const s=this._textDivProperties.get(_);let l="";if(0!==s.canvasWidth&&s.hasText){const{fontFamily:y}=_.style,{fontSize:F}=s;(F!==this._layoutTextLastFontSize||y!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${F*this._devicePixelRatio}px ${y}`,this._layoutTextLastFontSize=F,this._layoutTextLastFontFamily=y);const{width:R}=this._layoutTextCtx.measureText(_.textContent);if(R>0){const j=this._devicePixelRatio*s.canvasWidth/R;this._enhanceTextSelection&&(s.scale=j),l=`scaleX(${j})`}}if(0!==s.angle&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(this._enhanceTextSelection&&(s.originalTransform=l),_.style.transform=l),s.hasText&&this._container.append(_),s.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(_=0){const s=(0,n.createPromiseCapability)();let l=Object.create(null);const y=this._document.createElement("canvas");if(y.height=y.width=k,this._layoutTextCtx=y.getContext("2d",{alpha:!1}),this._textContent)this._processItems(this._textContent.items,this._textContent.styles),s.resolve();else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const F=()=>{this._reader.read().then(({value:R,done:j})=>{j?s.resolve():(Object.assign(l,R.styles),this._processItems(R.items,l),F())},s.reject)};this._reader=this._textContentStream.getReader(),F()}}s.promise.then(()=>{l=null,_?this._renderTimer=setTimeout(()=>{u(this),this._renderTimer=null},_):u(this)},this._capability.reject)}expandTextDivs(_=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(function r(D){const _=D._bounds,s=D._viewport,l=function g(D,_,s){const l=s.map(function(F,R){return{x1:F.left,y1:F.top,x2:F.right,y2:F.bottom,index:R,x1New:void 0,x2New:void 0}});b(D,l);const y=new Array(s.length);for(const F of l)y[F.index]={left:F.x1New,top:0,right:F.x2New,bottom:0};s.map(function(F,R){const j=y[R],N=l[R];N.x1=F.top,N.y1=D-j.right,N.x2=F.bottom,N.y2=D-j.left,N.index=R,N.x1New=void 0,N.x2New=void 0}),b(_,l);for(const F of l){const R=F.index;y[R].top=F.x1New,y[R].bottom=F.x2New}return y}(s.width,s.height,_);for(let y=0;y<l.length;y++){const F=_[y].div,R=D._textDivProperties.get(F);if(0===R.angle){R.paddingLeft=_[y].left-l[y].left,R.paddingTop=_[y].top-l[y].top,R.paddingRight=l[y].right-_[y].right,R.paddingBottom=l[y].bottom-_[y].bottom,D._textDivProperties.set(F,R);continue}const j=l[y],N=_[y],tt=N.m,Z=tt[0],Y=tt[1],V=[[0,0],[0,N.size[1]],[N.size[0],0],N.size],U=new Float64Array(64);for(let X=0,C=V.length;X<C;X++){const o=n.Util.applyTransform(V[X],tt);U[X+0]=Z&&(j.left-o[0])/Z,U[X+4]=Y&&(j.top-o[1])/Y,U[X+8]=Z&&(j.right-o[0])/Z,U[X+12]=Y&&(j.bottom-o[1])/Y,U[X+16]=Y&&(j.left-o[0])/-Y,U[X+20]=Z&&(j.top-o[1])/Z,U[X+24]=Y&&(j.right-o[0])/-Y,U[X+28]=Z&&(j.bottom-o[1])/Z,U[X+32]=Z&&(j.left-o[0])/-Z,U[X+36]=Y&&(j.top-o[1])/-Y,U[X+40]=Z&&(j.right-o[0])/-Z,U[X+44]=Y&&(j.bottom-o[1])/-Y,U[X+48]=Y&&(j.left-o[0])/Y,U[X+52]=Z&&(j.top-o[1])/-Z,U[X+56]=Y&&(j.right-o[0])/Y,U[X+60]=Z&&(j.bottom-o[1])/-Z}const B=1+Math.min(Math.abs(Z),Math.abs(Y));R.paddingLeft=p(U,32,16)/B,R.paddingTop=p(U,48,16)/B,R.paddingRight=p(U,0,16)/B,R.paddingBottom=p(U,16,16)/B,D._textDivProperties.set(F,R)}}(this),this._bounds=null);const s=[],l=[];for(let y=0,F=this._textDivs.length;y<F;y++){const R=this._textDivs[y],j=this._textDivProperties.get(R);j.hasText&&(_?(s.length=0,l.length=0,j.originalTransform&&s.push(j.originalTransform),j.paddingTop>0?(l.push(`${j.paddingTop}px`),s.push(`translateY(${-j.paddingTop}px)`)):l.push(0),l.push(j.paddingRight>0?j.paddingRight/j.scale+"px":0),l.push(j.paddingBottom>0?`${j.paddingBottom}px`:0),j.paddingLeft>0?(l.push(j.paddingLeft/j.scale+"px"),s.push(`translateX(${-j.paddingLeft/j.scale}px)`)):l.push(0),R.style.padding=l.join(" "),s.length&&(R.style.transform=s.join(" "))):(R.style.padding=null,R.style.transform=j.originalTransform))}}}e.TextLayerRenderTask=M},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=E(8),f=E(1),I=E(3);let k=class{constructor(){(0,f.unreachable)("Not implemented: SVGGraphics")}};e.SVGGraphics=k;{let g=function(s){let l=[];const y=[];for(const F of s)"save"!==F.fn?"restore"===F.fn?l=y.pop():l.push(F):(l.push({fnId:92,fn:"group",items:[]}),y.push(l),l=l.at(-1).items);return l},b=function(s){if(Number.isInteger(s))return s.toString();const l=s.toFixed(10);let y=l.length-1;if("0"!==l[y])return l;do{y--}while("0"===l[y]);return l.substring(0,"."===l[y]?y:y+1)},M=function(s){if(0===s[4]&&0===s[5]){if(0===s[1]&&0===s[2])return 1===s[0]&&1===s[3]?"":`scale(${b(s[0])} ${b(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2]){const l=180*Math.acos(s[0])/Math.PI;return`rotate(${b(l)})`}}else if(1===s[0]&&0===s[1]&&0===s[2]&&1===s[3])return`translate(${b(s[4])} ${b(s[5])})`;return`matrix(${b(s[0])} ${b(s[1])} ${b(s[2])} ${b(s[3])} ${b(s[4])} ${b(s[5])})`};const w={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},A="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",a=["butt","round","square"],d=["miter","round","bevel"],u=function(s,l="",y=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!y)return URL.createObjectURL(new Blob([s],{type:l}));const F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let R=`data:${l};base64,`;for(let j=0,N=s.length;j<N;j+=3){const tt=255&s[j],Z=255&s[j+1],Y=255&s[j+2];R+=F[tt>>2]+F[(3&tt)<<4|Z>>4]+F[j+1<N?(15&Z)<<2|Y>>6:64]+F[j+2<N?63&Y:64]}return R},p=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),y=new Int32Array(256);for(let Y=0;Y<256;Y++){let V=Y;for(let U=0;U<8;U++)V=1&V?3988292384^V>>1&2147483647:V>>1&2147483647;y[Y]=V}function R(Y,V,U,B){let X=B;const C=V.length;U[X]=C>>24&255,U[X+1]=C>>16&255,U[X+2]=C>>8&255,U[X+3]=255&C,X+=4,U[X]=255&Y.charCodeAt(0),U[X+1]=255&Y.charCodeAt(1),U[X+2]=255&Y.charCodeAt(2),U[X+3]=255&Y.charCodeAt(3),X+=4,U.set(V,X),X+=V.length;const o=function F(Y,V,U){let B=-1;for(let X=V;X<U;X++)B=B>>>8^y[255&(B^Y[X])];return~B}(U,B+4,X);U[X]=o>>24&255,U[X+1]=o>>16&255,U[X+2]=o>>8&255,U[X+3]=255&o}function tt(Y){let V=Y.length;const U=65535,B=Math.ceil(V/U),X=new Uint8Array(2+V+5*B+4);let C=0;X[C++]=120,X[C++]=156;let o=0;for(;V>U;)X[C++]=0,X[C++]=255,X[C++]=255,X[C++]=0,X[C++]=0,X.set(Y.subarray(o,o+U),C),C+=U,o+=U,V-=U;X[C++]=1,X[C++]=255&V,X[C++]=V>>8&255,X[C++]=255&~V,X[C++]=(65535&~V)>>8&255,X.set(Y.subarray(o),C),C+=Y.length-o;const c=function j(Y,V,U){let B=1,X=0;for(let C=V;C<U;++C)B=(B+(255&Y[C]))%65521,X=(X+B)%65521;return X<<16|B}(Y,0,Y.length);return X[C++]=c>>24&255,X[C++]=c>>16&255,X[C++]=c>>8&255,X[C++]=255&c,X}return function(V,U,B){return function Z(Y,V,U,B){const X=Y.width,C=Y.height;let o,c,S;const P=Y.data;switch(V){case f.ImageKind.GRAYSCALE_1BPP:c=0,o=1,S=X+7>>3;break;case f.ImageKind.RGB_24BPP:c=2,o=8,S=3*X;break;case f.ImageKind.RGBA_32BPP:c=6,o=8,S=4*X;break;default:throw new Error("invalid format")}const t=new Uint8Array((1+S)*C);let i=0,m=0;for(let z=0;z<C;++z)t[i++]=0,t.set(P.subarray(m,m+S),i),m+=S,i+=S;if(V===f.ImageKind.GRAYSCALE_1BPP&&B){i=0;for(let z=0;z<C;z++){i++;for(let q=0;q<S;q++)t[i++]^=255}}const v=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,255&X,C>>24&255,C>>16&255,C>>8&255,255&C,o,c,0,0,0]),x=function N(Y){if(!I.isNodeJS)return tt(Y);try{let V;V=parseInt(process.versions.node)>=8?Y:Buffer.from(Y);const U=__webpack_require__(82787).deflateSync(V,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(V){(0,f.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+V)}return tt(Y)}(t),L=new Uint8Array(s.length+36+v.length+x.length);let W=0;return L.set(s,W),W+=s.length,R("IHDR",v,L,W),W+=12+v.length,R("IDATA",x,L,W),W+=12+x.length,R("IEND",new Uint8Array(0),L,W),u(L,"image/png",U)}(V,void 0===V.kind?f.ImageKind.GRAYSCALE_1BPP:V.kind,U,B)}}();class r{constructor(){this.fontSizeScale=1,this.fontWeight=w.fontWeight,this.fontSize=0,this.textMatrix=f.IDENTITY_MATRIX,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=f.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=w.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,y){this.x=l,this.y=y}}let T=0,D=0,_=0;e.SVGGraphics=k=class{constructor(s,l,y=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new r,this.transformMatrix=f.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!y,this._operatorIdMapping=[];for(const F in f.OPS)this._operatorIdMapping[f.OPS[F]]=F}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const l=s.fnArray,y=s.argsArray;for(let F=0,R=l.length;F<R;F++)if(l[F]===f.OPS.dependency)for(const j of y[F]){const N=j.startsWith("g_")?this.commonObjs:this.objs,tt=new Promise(Z=>{N.get(j,Z)});this.current.dependencies.push(tt)}return Promise.all(this.current.dependencies)}transform(s,l,y,F,R,j){this.transformMatrix=f.Util.transform(this.transformMatrix,[s,l,y,F,R,j]),this.tgrp=null}getSVG(s,l){this.viewport=l;const y=this._initialize(l);return this.loadDependencies(s).then(()=>(this.transformMatrix=f.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),y))}convertOpList(s){const l=this._operatorIdMapping,y=s.argsArray,F=s.fnArray,R=[];for(let j=0,N=F.length;j<N;j++){const tt=F[j];R.push({fnId:tt,fn:l[tt],args:y[j]})}return g(R)}executeOpTree(s){for(const l of s){const y=l.fn,R=l.args;switch(0|l.fnId){case f.OPS.beginText:this.beginText();break;case f.OPS.dependency:break;case f.OPS.setLeading:this.setLeading(R);break;case f.OPS.setLeadingMoveText:this.setLeadingMoveText(R[0],R[1]);break;case f.OPS.setFont:this.setFont(R);break;case f.OPS.showText:case f.OPS.showSpacedText:this.showText(R[0]);break;case f.OPS.endText:this.endText();break;case f.OPS.moveText:this.moveText(R[0],R[1]);break;case f.OPS.setCharSpacing:this.setCharSpacing(R[0]);break;case f.OPS.setWordSpacing:this.setWordSpacing(R[0]);break;case f.OPS.setHScale:this.setHScale(R[0]);break;case f.OPS.setTextMatrix:this.setTextMatrix(R[0],R[1],R[2],R[3],R[4],R[5]);break;case f.OPS.setTextRise:this.setTextRise(R[0]);break;case f.OPS.setTextRenderingMode:this.setTextRenderingMode(R[0]);break;case f.OPS.setLineWidth:this.setLineWidth(R[0]);break;case f.OPS.setLineJoin:this.setLineJoin(R[0]);break;case f.OPS.setLineCap:this.setLineCap(R[0]);break;case f.OPS.setMiterLimit:this.setMiterLimit(R[0]);break;case f.OPS.setFillRGBColor:this.setFillRGBColor(R[0],R[1],R[2]);break;case f.OPS.setStrokeRGBColor:this.setStrokeRGBColor(R[0],R[1],R[2]);break;case f.OPS.setStrokeColorN:this.setStrokeColorN(R);break;case f.OPS.setFillColorN:this.setFillColorN(R);break;case f.OPS.shadingFill:this.shadingFill(R[0]);break;case f.OPS.setDash:this.setDash(R[0],R[1]);break;case f.OPS.setRenderingIntent:this.setRenderingIntent(R[0]);break;case f.OPS.setFlatness:this.setFlatness(R[0]);break;case f.OPS.setGState:this.setGState(R[0]);break;case f.OPS.fill:this.fill();break;case f.OPS.eoFill:this.eoFill();break;case f.OPS.stroke:this.stroke();break;case f.OPS.fillStroke:this.fillStroke();break;case f.OPS.eoFillStroke:this.eoFillStroke();break;case f.OPS.clip:this.clip("nonzero");break;case f.OPS.eoClip:this.clip("evenodd");break;case f.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case f.OPS.paintImageXObject:this.paintImageXObject(R[0]);break;case f.OPS.paintInlineImageXObject:this.paintInlineImageXObject(R[0]);break;case f.OPS.paintImageMaskXObject:this.paintImageMaskXObject(R[0]);break;case f.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(R[0],R[1]);break;case f.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case f.OPS.closePath:this.closePath();break;case f.OPS.closeStroke:this.closeStroke();break;case f.OPS.closeFillStroke:this.closeFillStroke();break;case f.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case f.OPS.nextLine:this.nextLine();break;case f.OPS.transform:this.transform(R[0],R[1],R[2],R[3],R[4],R[5]);break;case f.OPS.constructPath:this.constructPath(R[0],R[1]);break;case f.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,f.warn)(`Unimplemented operator ${y}`)}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,l,y,F,R,j){const N=this.current;N.textMatrix=N.lineMatrix=[s,l,y,F,R,j],N.textMatrixScale=Math.hypot(s,l),N.x=N.lineX=0,N.y=N.lineY=0,N.xcoords=[],N.ycoords=[],N.tspan=this.svgFactory.createElement("svg:tspan"),N.tspan.setAttributeNS(null,"font-family",N.fontFamily),N.tspan.setAttributeNS(null,"font-size",`${b(N.fontSize)}px`),N.tspan.setAttributeNS(null,"y",b(-N.y)),N.txtElement=this.svgFactory.createElement("svg:text"),N.txtElement.append(N.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=f.IDENTITY_MATRIX,s.lineMatrix=f.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,l){const y=this.current;y.x=y.lineX+=s,y.y=y.lineY+=l,y.xcoords=[],y.ycoords=[],y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${b(y.fontSize)}px`),y.tspan.setAttributeNS(null,"y",b(-y.y))}showText(s){const l=this.current,y=l.font,F=l.fontSize;if(0===F)return;const R=l.fontSizeScale,j=l.charSpacing,N=l.wordSpacing,tt=l.fontDirection,Z=l.textHScale*tt,Y=y.vertical,V=Y?1:-1,U=y.defaultVMetrics,B=F*l.fontMatrix[0];let X=0;for(const c of s){if(null===c){X+=tt*N;continue}if("number"==typeof c){X+=V*c*F/1e3;continue}const S=(c.isSpace?N:0)+j,P=c.fontChar;let t,i,v,m=c.width;if(Y){let x;const O=c.vmetric||U;x=c.vmetric?O[1]:.5*m,x=-x*B,m=O?-O[0]:m,t=x/R,i=(X+O[2]*B)/R}else t=X/R,i=0;(c.isInFont||y.missingFile)&&(l.xcoords.push(l.x+t),Y&&l.ycoords.push(-l.y+i),l.tspan.textContent+=P),v=Y?m*B-S*tt:m*B+S*tt,X+=v}l.tspan.setAttributeNS(null,"x",l.xcoords.map(b).join(" ")),l.tspan.setAttributeNS(null,"y",Y?l.ycoords.map(b).join(" "):b(-l.y)),Y?l.y-=X:l.x+=X*Z,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${b(l.fontSize)}px`),l.fontStyle!==w.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==w.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const C=l.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;C===f.TextRenderingMode.FILL||C===f.TextRenderingMode.FILL_STROKE?(l.fillColor!==w.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.tspan.setAttributeNS(null,"fill",l.textRenderingMode===f.TextRenderingMode.ADD_TO_PATH?"transparent":"none"),(C===f.TextRenderingMode.STROKE||C===f.TextRenderingMode.FILL_STROKE)&&this._setStrokeAttributes(l.tspan,1/(l.textMatrixScale||1));let o=l.textMatrix;0!==l.textRise&&(o=o.slice(),o[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${M(o)} scale(${b(Z)}, -1)`),l.txtElement.setAttributeNS(A,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(s,l){this.setLeading(-l),this.moveText(s,l)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=u(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${l}); }\n`}setFont(s){const l=this.current,y=this.commonObjs.get(s[0]);let F=s[1];l.font=y,this.embedFonts&&!y.missingFile&&!this.embeddedFonts[y.loadedName]&&(this.addFontStyle(y),this.embeddedFonts[y.loadedName]=y),l.fontMatrix=y.fontMatrix||f.FONT_IDENTITY_MATRIX;let R="normal";y.black?R="900":y.bold&&(R="bold");const j=y.italic?"italic":"normal";F<0?(F=-F,l.fontDirection=-1):l.fontDirection=1,l.fontSize=F,l.fontFamily=y.loadedName,l.fontWeight=R,l.fontStyle=j,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",b(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){const s=this.current;s.textRenderingMode&f.TextRenderingMode.ADD_TO_PATH_FLAG&&s.txtElement?.hasChildNodes()&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=a[s]}setLineJoin(s){this.current.lineJoin=d[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,l,y){this.current.strokeColor=f.Util.makeHexColor(s,l,y)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,l,y){this.current.fillColor=f.Util.makeHexColor(s,l,y),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const l=this.viewport.width,y=this.viewport.height,F=f.Util.inverseTransform(this.transformMatrix),R=f.Util.applyTransform([0,0],F),j=f.Util.applyTransform([0,y],F),N=f.Util.applyTransform([l,0],F),tt=f.Util.applyTransform([l,y],F),Z=Math.min(R[0],j[0],N[0],tt[0]),Y=Math.min(R[1],j[1],N[1],tt[1]),V=Math.max(R[0],j[0],N[0],tt[0]),U=Math.max(R[1],j[1],N[1],tt[1]),B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x",Z),B.setAttributeNS(null,"y",Y),B.setAttributeNS(null,"width",V-Z),B.setAttributeNS(null,"height",U-Y),B.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&B.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(B)}_makeColorN_Pattern(s){return"TilingPattern"===s[0]?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const l=s[1],y=s[2],F=s[3]||f.IDENTITY_MATRIX,[R,j,N,tt]=s[4],Z=s[5],Y=s[6],V=s[7],U="shading"+_++,[B,X,C,o]=f.Util.normalizeRect([...f.Util.applyTransform([R,j],F),...f.Util.applyTransform([N,tt],F)]),[c,S]=f.Util.singularValueDecompose2dScale(F),P=Z*c,t=Y*S,i=this.svgFactory.createElement("svg:pattern");i.setAttributeNS(null,"id",U),i.setAttributeNS(null,"patternUnits","userSpaceOnUse"),i.setAttributeNS(null,"width",P),i.setAttributeNS(null,"height",t),i.setAttributeNS(null,"x",`${B}`),i.setAttributeNS(null,"y",`${X}`);const m=this.svg,v=this.transformMatrix,x=this.current.fillColor,O=this.current.strokeColor,L=this.svgFactory.create(C-B,o-X);if(this.svg=L,this.transformMatrix=F,2===V){const W=f.Util.makeHexColor(...l);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(y)),this.svg=m,this.transformMatrix=v,this.current.fillColor=x,this.current.strokeColor=O,i.append(L.childNodes[0]),this.defs.append(i),`url(#${U})`}_makeShadingPattern(s){switch("string"==typeof s&&(s=this.objs.get(s)),s[0]){case"RadialAxial":const l="shading"+_++,y=s[3];let F;switch(s[1]){case"axial":const R=s[4],j=s[5];F=this.svgFactory.createElement("svg:linearGradient"),F.setAttributeNS(null,"id",l),F.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),F.setAttributeNS(null,"x1",R[0]),F.setAttributeNS(null,"y1",R[1]),F.setAttributeNS(null,"x2",j[0]),F.setAttributeNS(null,"y2",j[1]);break;case"radial":const N=s[4],tt=s[5],Z=s[6],Y=s[7];F=this.svgFactory.createElement("svg:radialGradient"),F.setAttributeNS(null,"id",l),F.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),F.setAttributeNS(null,"cx",tt[0]),F.setAttributeNS(null,"cy",tt[1]),F.setAttributeNS(null,"r",Y),F.setAttributeNS(null,"fx",N[0]),F.setAttributeNS(null,"fy",N[1]),F.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const R of y){const j=this.svgFactory.createElement("svg:stop");j.setAttributeNS(null,"offset",R[0]),j.setAttributeNS(null,"stop-color",R[1]),F.append(j)}return this.defs.append(F),`url(#${l})`;case"Mesh":return(0,f.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,l){this.current.dashArray=s,this.current.dashPhase=l}constructPath(s,l){const y=this.current;let F=y.x,R=y.y,j=[],N=0;for(const tt of s)switch(0|tt){case f.OPS.rectangle:F=l[N++],R=l[N++];const V=F+l[N++],U=R+l[N++];j.push("M",b(F),b(R),"L",b(V),b(R),"L",b(V),b(U),"L",b(F),b(U),"Z");break;case f.OPS.moveTo:F=l[N++],R=l[N++],j.push("M",b(F),b(R));break;case f.OPS.lineTo:F=l[N++],R=l[N++],j.push("L",b(F),b(R));break;case f.OPS.curveTo:F=l[N+4],R=l[N+5],j.push("C",b(l[N]),b(l[N+1]),b(l[N+2]),b(l[N+3]),b(F),b(R)),N+=6;break;case f.OPS.curveTo2:j.push("C",b(F),b(R),b(l[N]),b(l[N+1]),b(l[N+2]),b(l[N+3])),F=l[N+2],R=l[N+3],N+=4;break;case f.OPS.curveTo3:F=l[N+2],R=l[N+3],j.push("C",b(l[N]),b(l[N+1]),b(F),b(R),b(F),b(R)),N+=4;break;case f.OPS.closePath:j.push("Z")}j=j.join(" "),y.path&&s.length>0&&s[0]!==f.OPS.rectangle&&s[0]!==f.OPS.moveTo?j=y.path.getAttributeNS(null,"d")+j:(y.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(y.path)),y.path.setAttributeNS(null,"d",j),y.path.setAttributeNS(null,"fill","none"),y.element=y.path,y.setCurrentPoint(F,R)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element)return void(this.pendingClip=null);const l="clippath"+T++,y=this.svgFactory.createElement("svg:clipPath");y.setAttributeNS(null,"id",l),y.setAttributeNS(null,"transform",M(this.transformMatrix));const F=s.element.cloneNode(!0);if(F.setAttributeNS(null,"clip-rule","evenodd"===this.pendingClip?"evenodd":"nonzero"),this.pendingClip=null,y.append(F),this.defs.append(y),s.activeClipUrl){s.clipGroup=null;for(const R of this.extraStack)R.clipGroup=null;y.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const l=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",l)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[l,y]of s)switch(l){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y);break;case"CA":this.setStrokeAlpha(y);break;case"ca":this.setFillAlpha(y);break;default:(0,f.warn)(`Unimplemented graphic state operator ${l}`)}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,l=1){const y=this.current;let F=y.dashArray;1!==l&&F.length>0&&(F=F.map(function(R){return l*R})),s.setAttributeNS(null,"stroke",y.strokeColor),s.setAttributeNS(null,"stroke-opacity",y.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",b(y.miterLimit)),s.setAttributeNS(null,"stroke-linecap",y.lineCap),s.setAttributeNS(null,"stroke-linejoin",y.lineJoin),s.setAttributeNS(null,"stroke-width",b(l*y.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",F.map(b).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",b(l*y.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(s)}paintImageXObject(s){const l=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);l?this.paintInlineImageXObject(l):(0,f.warn)(`Dependent image with object ID ${s} is not ready yet`)}paintInlineImageXObject(s,l){const y=s.width,F=s.height,R=p(s,this.forceDataSchema,!!l),j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x","0"),j.setAttributeNS(null,"y","0"),j.setAttributeNS(null,"width",b(y)),j.setAttributeNS(null,"height",b(F)),this.current.element=j,this.clip("nonzero");const N=this.svgFactory.createElement("svg:image");N.setAttributeNS(h,"xlink:href",R),N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y",b(-F)),N.setAttributeNS(null,"width",b(y)+"px"),N.setAttributeNS(null,"height",b(F)+"px"),N.setAttributeNS(null,"transform",`scale(${b(1/y)} ${b(-1/F)})`),l?l.append(N):this._ensureTransformGroup().append(N)}paintImageMaskXObject(s){const l=this.current,y=s.width,F=s.height,R=l.fillColor;l.maskId="mask"+D++;const j=this.svgFactory.createElement("svg:mask");j.setAttributeNS(null,"id",l.maskId);const N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",b(y)),N.setAttributeNS(null,"height",b(F)),N.setAttributeNS(null,"fill",R),N.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(j),this._ensureTransformGroup().append(N),this.paintInlineImageXObject(s,j)}paintFormXObjectBegin(s,l){if(Array.isArray(s)&&6===s.length&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),l){const y=l[2]-l[0],F=l[3]-l[1],R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x",l[0]),R.setAttributeNS(null,"y",l[1]),R.setAttributeNS(null,"width",b(y)),R.setAttributeNS(null,"height",b(F)),this.current.element=R,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const l=this.svgFactory.create(s.width,s.height),y=this.svgFactory.createElement("svg:defs");l.append(y),this.defs=y;const F=this.svgFactory.createElement("svg:g");return F.setAttributeNS(null,"transform",M(s.transform)),l.append(F),this.svg=F,l}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",M(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=E(1),f=E(33);const I=__webpack_require__(23237),k=__webpack_require__(97492),w=__webpack_require__(31815),A=__webpack_require__(66671),h=/^file:\/\/\/[a-zA-Z]:\//;e.PDFNodeStream=class d{constructor(_){this.source=_,this.url=function a(D){const _=A.parse(D);return"file:"===_.protocol||_.host?_:/^[a-z]:[/\\]/i.test(D)?A.parse(`file:///${D}`):(_.host||(_.protocol="file:"),_)}(_.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new M(this):new g(this),this._fullRequestReader}getRangeReader(_,s){if(s<=this._progressiveDataLength)return null;const l=this.isFsUrl?new T(this,_,s):new b(this,_,s);return this._rangeRequestReaders.push(l),l}cancelAllRequests(_){this._fullRequestReader&&this._fullRequestReader.cancel(_);for(const s of this._rangeRequestReaders.slice(0))s.cancel(_)}};class u{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null;const s=_.source;this._contentLength=s.length,this._loaded=0,this._filename=null,this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var _=this;return _asyncToGenerator(function*(){if(yield _._readCapability.promise,_._done)return{value:void 0,done:!0};if(_._storedError)throw _._storedError;const s=_._readableStream.read();return null===s?(_._readCapability=(0,n.createPromiseCapability)(),_.read()):(_._loaded+=s.length,_.onProgress&&_.onProgress({loaded:_._loaded,total:_._contentLength}),{value:new Uint8Array(s).buffer,done:!1})})()}cancel(_){this._readableStream?this._readableStream.destroy(_):this._error(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",s=>{this._error(s)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!_.source.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){var _=this;return _asyncToGenerator(function*(){if(yield _._readCapability.promise,_._done)return{value:void 0,done:!0};if(_._storedError)throw _._storedError;const s=_._readableStream.read();return null===s?(_._readCapability=(0,n.createPromiseCapability)(),_.read()):(_._loaded+=s.length,_.onProgress&&_.onProgress({loaded:_._loaded}),{value:new Uint8Array(s).buffer,done:!1})})()}cancel(_){this._readableStream?this._readableStream.destroy(_):this._error(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",s=>{this._error(s)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function r(D,_){return{protocol:D.protocol,auth:D.auth,host:D.hostname,port:D.port,path:D.path,method:"GET",headers:_}}class g extends u{constructor(_){super(_);const s=l=>{if(404===l.statusCode){const j=new n.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=j,void this._headersCapability.reject(j)}this._headersCapability.resolve(),this._setReadableStream(l);const y=j=>this._readableStream.headers[j.toLowerCase()],{allowRangeRequests:F,suggestedLength:R}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:_.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=F,this._contentLength=R||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(y)};this._request=null,this._request="http:"===this._url.protocol?k.request(r(this._url,_.httpHeaders),s):w.request(r(this._url,_.httpHeaders),s),this._request.on("error",l=>{this._storedError=l,this._headersCapability.reject(l)}),this._request.end()}}class b extends p{constructor(_,s,l){super(_),this._httpHeaders={};for(const F in _.httpHeaders){const R=_.httpHeaders[F];typeof R>"u"||(this._httpHeaders[F]=R)}this._httpHeaders.Range=`bytes=${s}-${l-1}`;const y=F=>{if(404!==F.statusCode)this._setReadableStream(F);else{const R=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R}};this._request=null,this._request="http:"===this._url.protocol?k.request(r(this._url,this._httpHeaders),y):w.request(r(this._url,this._httpHeaders),y),this._request.on("error",F=>{this._storedError=F}),this._request.end()}}class M extends u{constructor(_){super(_);let s=decodeURIComponent(this._url.path);h.test(this._url.href)&&(s=s.replace(/^\//,"")),I.lstat(s,(l,y)=>{if(l)return"ENOENT"===l.code&&(l=new n.MissingPDFException(`Missing PDF "${s}".`)),this._storedError=l,void this._headersCapability.reject(l);this._contentLength=y.size,this._setReadableStream(I.createReadStream(s)),this._headersCapability.resolve()})}}class T extends p{constructor(_,s,l){super(_);let y=decodeURIComponent(this._url.path);h.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(I.createReadStream(y,{start:s,end:l-1}))}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=function A(a,d){return 404===a||0===a&&d.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+d+'".'):new n.UnexpectedResponseException(`Unexpected server response (${a}) while retrieving PDF "${d}".`,a)},e.extractFilenameFromHeader=function w(a){const d=a("Content-Disposition");if(d){let u=(0,f.getFilenameFromContentDispositionHeader)(d);if(u.includes("%"))try{u=decodeURIComponent(u)}catch{}if((0,I.isPdfFile)(u))return u}return null},e.validateRangeRequestCapabilities=function k({getResponseHeader:a,isHttp:d,rangeChunkSize:u,disableRange:p}){const r={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(a("Content-Length"),10);return!Number.isInteger(g)||(r.suggestedLength=g,g<=2*u)||p||!d||"bytes"!==a("Accept-Ranges")||"identity"!==(a("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r},e.validateResponseStatus=function h(a){return 200===a||206===a};var n=E(1),f=E(34),I=E(8)},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=function f(I){let k=!0,w=A("filename\\*","i").exec(I);if(w){w=w[1];let g=u(w);return g=unescape(g),g=p(g),g=r(g),a(g)}if(w=function d(g){const b=[];let M;const T=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(M=T.exec(g));){let[,_,s,l]=M;if(_=parseInt(_,10),_ in b){if(0===_)break}else b[_]=[s,l]}const D=[];for(let _=0;_<b.length&&_ in b;++_){let[s,l]=b[_];l=u(l),s&&(l=unescape(l),0===_&&(l=p(l))),D.push(l)}return D.join("")}(I),w)return a(r(w));if(w=A("filename","i").exec(I),w){w=w[1];let g=u(w);return g=r(g),a(g)}function A(g,b){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function h(g,b){if(g){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const M=new TextDecoder(g,{fatal:!0}),T=(0,n.stringToBytes)(b);b=M.decode(T),k=!1}catch{}}return b}function a(g){return k&&/[\x80-\xff]/.test(g)&&(g=h("utf-8",g),k&&(g=h("iso-8859-1",g))),g}function u(g){if(g.startsWith('"')){const b=g.slice(1).split('\\"');for(let M=0;M<b.length;++M){const T=b[M].indexOf('"');-1!==T&&(b[M]=b[M].slice(0,T),b.length=M+1),b[M]=b[M].replace(/\\(.)/g,"$1")}g=b.join('"')}return g}function p(g){const b=g.indexOf("'");return-1===b?g:h(g.slice(0,b),g.slice(b+1).replace(/^[^']*'/,""))}function r(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,M,T,D){if("q"===T||"Q"===T)return h(M,D=(D=D.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(_,s){return String.fromCharCode(parseInt(s,16))}));try{D=atob(D)}catch{}return h(M,D)})}return""};var n=E(1)},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=E(1),f=E(33);class A{constructor(p,r={}){this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&r.httpHeaders||Object.create(null),this.withCredentials=r.withCredentials||!1,this.getXhr=r.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,r,g){const b={begin:p,end:r};for(const M in g)b[M]=g[M];return this.request(b)}requestFull(p){return this.request(p)}request(p){const r=this.getXhr(),g=this.currXhrId++,b=this.pendingRequests[g]={xhr:r};r.open("GET",this.url),r.withCredentials=this.withCredentials;for(const M in this.httpHeaders){const T=this.httpHeaders[M];typeof T>"u"||r.setRequestHeader(M,T)}return this.isHttp&&"begin"in p&&"end"in p?(r.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),b.expectedStatus=206):b.expectedStatus=200,r.responseType="arraybuffer",p.onError&&(r.onerror=function(M){p.onError(r.status)}),r.onreadystatechange=this.onStateChange.bind(this,g),r.onprogress=this.onProgress.bind(this,g),b.onHeadersReceived=p.onHeadersReceived,b.onDone=p.onDone,b.onError=p.onError,b.onProgress=p.onProgress,r.send(null),g}onProgress(p,r){const g=this.pendingRequests[p];g&&g.onProgress?.(r)}onStateChange(p,r){const g=this.pendingRequests[p];if(!g)return;const b=g.xhr;if(b.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),4!==b.readyState||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],0===b.status&&this.isHttp)return void g.onError?.(b.status);const M=b.status||200;if((200!==M||206!==g.expectedStatus)&&M!==g.expectedStatus)return void g.onError?.(b.status);const D=function w(u){const p=u.response;return"string"!=typeof p?p:(0,n.stringToBytes)(p).buffer}(b);if(206===M){const _=b.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(_);g.onDone({begin:parseInt(s[1],10),chunk:D})}else D?g.onDone({begin:0,chunk:D}):g.onError?.(b.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const r=this.pendingRequests[p].xhr;delete this.pendingRequests[p],r.abort()}}e.PDFNetworkStream=class h{constructor(p){this._source=p,this._manager=new A(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const r=this._rangeRequestReaders.indexOf(p);r>=0&&this._rangeRequestReaders.splice(r,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new a(this._manager,this._source),this._fullRequestReader}getRangeReader(p,r){const g=new d(this._manager,p,r);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(const r of this._rangeRequestReaders.slice(0))r.cancel(p)}};class a{constructor(p,r){this._manager=p;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=r.url,this._fullRequestId=p.requestFull(g),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._contentLength=r.length,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,r=this._manager.getRequestXhr(p),g=T=>r.getResponseHeader(T),{allowRangeRequests:b,suggestedLength:M}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=M||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,f.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){this.onProgress?.({loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){var p=this;return _asyncToGenerator(function*(){if(p._storedError)throw p._storedError;if(p._cachedChunks.length>0)return{value:p._cachedChunks.shift(),done:!1};if(p._done)return{value:void 0,done:!0};const r=(0,n.createPromiseCapability)();return p._requests.push(r),r.promise})()}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(p,r,g){this._manager=p;const b={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(r,g,b),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(p){const r=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunk=r,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,f.createResponseStatusError)(p,this._url);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){this.isStreamingSupported||this.onProgress?.({loaded:p.loaded})}get isStreamingSupported(){return!1}read(){var p=this;return _asyncToGenerator(function*(){if(p._storedError)throw p._storedError;if(null!==p._queuedChunk){const g=p._queuedChunk;return p._queuedChunk=null,{value:g,done:!1}}if(p._done)return{value:void 0,done:!0};const r=(0,n.createPromiseCapability)();return p._requests.push(r),r.promise})()}cancel(p){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=E(1),f=E(33);function I(a,d,u){return{method:"GET",headers:a,signal:u.signal,mode:"cors",credentials:d?"include":"same-origin",redirect:"follow"}}function k(a){const d=new Headers;for(const u in a){const p=a[u];typeof p>"u"||d.append(u,p)}return d}e.PDFFetchStream=class w{constructor(d){this.source=d,this.isHttp=/^https?:/i.test(d.url),this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new A(this),this._fullRequestReader}getRangeReader(d,u){if(u<=this._progressiveDataLength)return null;const p=new h(this,d,u);return this._rangeRequestReaders.push(p),p}cancelAllRequests(d){this._fullRequestReader&&this._fullRequestReader.cancel(d);for(const u of this._rangeRequestReaders.slice(0))u.cancel(d)}};class A{constructor(d){this._stream=d,this._reader=null,this._loaded=0,this._filename=null;const u=d.source;this._withCredentials=u.withCredentials||!1,this._contentLength=u.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._headers=k(this._stream.httpHeaders);const p=u.url;fetch(p,I(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!(0,f.validateResponseStatus)(r.status))throw(0,f.createResponseStatusError)(r.status,p);this._reader=r.body.getReader(),this._headersCapability.resolve();const g=T=>r.headers.get(T),{allowRangeRequests:b,suggestedLength:M}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=M||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var d=this;return _asyncToGenerator(function*(){yield d._headersCapability.promise;const{value:u,done:p}=yield d._reader.read();return p?{value:u,done:p}:(d._loaded+=u.byteLength,d.onProgress&&d.onProgress({loaded:d._loaded,total:d._contentLength}),{value:new Uint8Array(u).buffer,done:!1})})()}cancel(d){this._reader&&this._reader.cancel(d),this._abortController.abort()}}class h{constructor(d,u,p){this._stream=d,this._reader=null,this._loaded=0;const r=d.source;this._withCredentials=r.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController,this._headers=k(this._stream.httpHeaders),this._headers.append("Range",`bytes=${u}-${p-1}`);const g=r.url;fetch(g,I(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,f.validateResponseStatus)(b.status))throw(0,f.createResponseStatusError)(b.status,g);this._readCapability.resolve(),this._reader=b.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){var d=this;return _asyncToGenerator(function*(){yield d._readCapability.promise;const{value:u,done:p}=yield d._reader.read();return p?{value:u,done:p}:(d._loaded+=u.byteLength,d.onProgress&&d.onProgress({loaded:d._loaded}),{value:new Uint8Array(u).buffer,done:!1})})()}cancel(d){this._reader&&this._reader.cancel(d),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__($){var e=__webpack_module_cache__[$];if(void 0!==e)return e.exports;var E=__webpack_module_cache__[$]={exports:{}};return __webpack_modules__[$](E,E.exports,__w_pdfjs_require__),E.exports}var __nested_webpack_exports__={};return(()=>{var $=__nested_webpack_exports__;Object.defineProperty($,"__esModule",{value:!0}),Object.defineProperty($,"AnnotationEditorLayer",{enumerable:!0,get:function(){return f.AnnotationEditorLayer}}),Object.defineProperty($,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty($,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty($,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return I.AnnotationEditorUIManager}}),Object.defineProperty($,"AnnotationLayer",{enumerable:!0,get:function(){return k.AnnotationLayer}}),Object.defineProperty($,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty($,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty($,"GlobalWorkerOptions",{enumerable:!0,get:function(){return w.GlobalWorkerOptions}}),Object.defineProperty($,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty($,"LoopbackPort",{enumerable:!0,get:function(){return E.LoopbackPort}}),Object.defineProperty($,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty($,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty($,"PDFDataRangeTransport",{enumerable:!0,get:function(){return E.PDFDataRangeTransport}}),Object.defineProperty($,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty($,"PDFWorker",{enumerable:!0,get:function(){return E.PDFWorker}}),Object.defineProperty($,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty($,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty($,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty($,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty($,"SVGGraphics",{enumerable:!0,get:function(){return a.SVGGraphics}}),Object.defineProperty($,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return e.UNSUPPORTED_FEATURES}}),Object.defineProperty($,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty($,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty($,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty($,"XfaLayer",{enumerable:!0,get:function(){return d.XfaLayer}}),Object.defineProperty($,"build",{enumerable:!0,get:function(){return E.build}}),Object.defineProperty($,"createPromiseCapability",{enumerable:!0,get:function(){return e.createPromiseCapability}}),Object.defineProperty($,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty($,"getDocument",{enumerable:!0,get:function(){return E.getDocument}}),Object.defineProperty($,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty($,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty($,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty($,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty($,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty($,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty($,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty($,"version",{enumerable:!0,get:function(){return E.version}});var e=__w_pdfjs_require__(1),E=__w_pdfjs_require__(4),n=__w_pdfjs_require__(8),f=__w_pdfjs_require__(22),I=__w_pdfjs_require__(7),k=__w_pdfjs_require__(27),w=__w_pdfjs_require__(15),A=__w_pdfjs_require__(3),h=__w_pdfjs_require__(30),a=__w_pdfjs_require__(31),d=__w_pdfjs_require__(29);if(A.isNodeJS){const{PDFNodeStream:r}=__w_pdfjs_require__(32);(0,E.setPDFNetworkStreamFactory)(g=>new r(g))}else{const{PDFNetworkStream:r}=__w_pdfjs_require__(35),{PDFFetchStream:g}=__w_pdfjs_require__(36);(0,E.setPDFNetworkStreamFactory)(b=>(0,n.isValidFetchUrl)(b.url)?new g(b):new r(b))}})(),__nested_webpack_exports__})(),module.exports=E()},17640:()=>{},23237:()=>{},97492:()=>{},31815:()=>{},66671:()=>{},82787:()=>{},29293:$=>{function e(n,f,I,k,w,A,h){try{var a=n[A](h),d=a.value}catch(u){return void I(u)}a.done?f(d):Promise.resolve(d).then(k,w)}$.exports=function E(n){return function(){var f=this,I=arguments;return new Promise(function(k,w){var A=n.apply(f,I);function h(d){e(A,k,w,h,a,"next",d)}function a(d){e(A,k,w,h,a,"throw",d)}h(void 0)})}},$.exports.__esModule=!0,$.exports.default=$.exports}}]);