(self.webpackChunktool_box=self.webpackChunktool_box||[]).push([[555],{34555:($,e,E)=>{"use strict";E.r(e),E.d(e,{PdfToImgComponent:()=>g});var n=E(10467),f=E(73301),O=E(20717),L=E(60177),y=E(71893),h=E(29021),i=E(54438);function d(a,m){if(1&a){const A=i.RV6();i.j41(0,"div",9)(1,"img",10),i.bIt("click",function(){const T=i.eBV(A).$implicit;i.XpG(2);const F=i.sdS(5);return i.Njj(F.show(T))}),i.k0s()()}if(2&a){const A=m.$implicit;i.R7$(),i.Y8G("src",A,i.B4B)}}function u(a,m){if(1&a&&(i.j41(0,"div",5)(1,"h3",6),i.EFF(2,"Converted Images:"),i.k0s(),i.j41(3,"div",7),i.DNE(4,d,2,1,"div",8),i.k0s()()),2&a){const A=i.XpG();i.R7$(4),i.Y8G("ngForOf",A.images)}}let g=(()=>{class a{constructor(){this.images=[]}onFileSelected(A){var M=this;return(0,n.A)(function*(){const T=A.target.files[0];if(T){const F=new FileReader;F.readAsArrayBuffer(T),F.onload=(0,n.A)(function*(){F.result&&(yield M.convertPdfToImages(F.result))})}})()}convertPdfToImages(A){var M=this;return(0,n.A)(function*(){O.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";const T=yield O.getDocument({data:A}).promise;M.images=[];for(let F=1;F<=T.numPages;F++){const _=yield T.getPage(F),s=document.createElement("canvas"),l=s.getContext("2d"),b=_.getViewport({scale:2});s.width=b.width,s.height=b.height,l&&(yield _.render({canvasContext:l,viewport:b}).promise,M.images.push(s.toDataURL("image/png")))}})()}static{this.\u0275fac=function(M){return new(M||a)}}static{this.\u0275cmp=i.VBU({type:a,selectors:[["app-pdf-to-img"]],standalone:!0,features:[i.aNF],decls:6,vars:1,consts:[["docPreview",""],["header","PDF to Images","description","PDF to Images"],[1,"container","mt-4"],[3,"onFileUploaded"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"m-0"],[1,"row"],["class","col-2 mt-2 image-container",4,"ngFor","ngForOf"],[1,"col-2","mt-2","image-container"],["alt","PDF Page",1,"pdf-image",3,"click","src"]],template:function(M,T){if(1&M){const F=i.RV6();i.nrm(0,"app-page-header",1),i.j41(1,"div",2)(2,"app-file-uploader",3),i.bIt("onFileUploaded",function(s){return i.eBV(F),i.Njj(T.onFileSelected(s))}),i.k0s(),i.DNE(3,u,5,1,"div",4),i.k0s(),i.nrm(4,"app-doc-preview",null,0)}2&M&&(i.R7$(3),i.Y8G("ngIf",T.images.length))},dependencies:[f.y,L.bT,L.Sq,y.A,h.G],styles:[".image-container[_ngcontent-%COMP%]{width:200px}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;cursor:pointer}"]})}}return a})()},20717:(module,__unused_webpack_exports,__webpack_require__)=>{var _asyncToGenerator=__webpack_require__(29293).default,E;globalThis,E=()=>(()=>{"use strict";var __webpack_modules__=[,($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.UNSUPPORTED_FEATURES=e.TextRenderingMode=e.StreamType=e.RenderingIntentFlag=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FontType=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.AnnotationType=e.AnnotationStateModelType=e.AnnotationReviewState=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationMarkedState=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.arrayByteLength=st,e.arraysToBytes=function it(Q){const G=Q.length;if(1===G&&Q[0]instanceof Uint8Array)return Q[0];let H=0;for(let dt=0;dt<G;dt++)H+=st(Q[dt]);let rt=0;const ct=new Uint8Array(H);for(let dt=0;dt<G;dt++){let ht=Q[dt];ht instanceof Uint8Array||(ht="string"==typeof ht?J(ht):new Uint8Array(ht));const Et=ht.byteLength;ct.set(ht,rt),rt+=Et}return ct},e.assert=function P(Q,G){Q||S(G)},e.bytesToString=function et(Q){("object"!=typeof Q||null===Q||void 0===Q.length)&&S("Invalid argument for bytesToString");const G=Q.length,H=8192;if(G<H)return String.fromCharCode.apply(null,Q);const rt=[];for(let ct=0;ct<G;ct+=H){const dt=Math.min(ct+H,G),ht=Q.subarray(ct,dt);rt.push(String.fromCharCode.apply(null,ht))}return rt.join("")},e.createPromiseCapability=function qt(){const Q=Object.create(null);let G=!1;return Object.defineProperty(Q,"settled",{get:()=>G}),Q.promise=new Promise(function(H,rt){Q.resolve=function(ct){G=!0,H(ct)},Q.reject=function(ct){G=!0,rt(ct)}}),Q},e.createValidAbsoluteUrl=function r(Q,G=null,H=null){if(!Q)return null;try{if(H&&"string"==typeof Q){if(H.addDefaultProtocol&&Q.startsWith("www.")){const ct=Q.match(/\./g);ct&&ct.length>=2&&(Q=`http://${Q}`)}if(H.tryConvertEncoding)try{Q=Ft(Q)}catch{}}const rt=G?new URL(Q,G):new URL(Q);if(function t(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(rt))return rt}catch{}return null},e.escapeString=function Tt(Q){return Q.replace(/([()\\\n\r])/g,G=>"\n"===G?"\\n":"\r"===G?"\\r":`\\${G}`)},e.getModificationDate=function Wt(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")},e.getVerbosityLevel=function C(){return B},e.info=function o(Q){B>=tt.INFOS&&console.log(`Info: ${Q}`)},e.isArrayBuffer=function Ut(Q){return"object"==typeof Q&&null!==Q&&void 0!==Q.byteLength},e.isArrayEqual=function Bt(Q,G){if(Q.length!==G.length)return!1;for(let H=0,rt=Q.length;H<rt;H++)if(Q[H]!==G[H])return!1;return!0},e.isAscii=function _t(Q){return/^[\x00-\x7F]*$/.test(Q)},e.objectFromMap=function nt(Q){const G=Object.create(null);for(const[H,rt]of Q)G[H]=rt;return G},e.objectSize=function ot(Q){return Object.keys(Q).length},e.setVerbosityLevel=function X(Q){Number.isInteger(Q)&&(B=Q)},e.shadow=p,e.string32=function at(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,255&Q)},e.stringToBytes=J,e.stringToPDFString=function At(Q){if(Q[0]>="\xef"){let H;if("\xfe"===Q[0]&&"\xff"===Q[1]?H="utf-16be":"\xff"===Q[0]&&"\xfe"===Q[1]?H="utf-16le":"\xef"===Q[0]&&"\xbb"===Q[1]&&"\xbf"===Q[2]&&(H="utf-8"),H)try{const rt=new TextDecoder(H,{fatal:!0}),ct=J(Q);return rt.decode(ct)}catch(rt){c(`stringToPDFString: "${rt}".`)}}const G=[];for(let H=0,rt=Q.length;H<rt;H++){const ct=St[Q.charCodeAt(H)];G.push(ct?String.fromCharCode(ct):Q.charAt(H))}return G.join("")},e.stringToUTF16BEString=function pt(Q){const G=["\xfe\xff"];for(let H=0,rt=Q.length;H<rt;H++){const ct=Q.charCodeAt(H);G.push(String.fromCharCode(ct>>8&255),String.fromCharCode(255&ct))}return G.join("")},e.stringToUTF8String=Ft,e.unreachable=S,e.utf8StringToString=function jt(Q){return unescape(encodeURIComponent(Q))},e.warn=c,E(2),e.IDENTITY_MATRIX=[1,0,0,1,0,0],e.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],e.LINE_FACTOR=1.35,e.LINE_DESCENT_FACTOR=.35,e.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},e.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},e.AnnotationEditorPrefix="pdfjs_internal_editor_",e.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},e.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},e.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},e.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},e.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},e.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},e.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},e.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},e.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},e.AnnotationReplyType={GROUP:"Group",REPLY:"R"},e.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},e.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},e.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},e.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},e.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},e.PageActionEventType={O:"PageOpen",C:"PageClose"},e.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},e.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const tt={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=tt,e.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},e.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},e.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},e.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let B=tt.WARNINGS;function c(Q){B>=tt.WARNINGS&&console.log(`Warning: ${Q}`)}function S(Q){throw new Error(Q)}function p(Q,G,H){return Object.defineProperty(Q,G,{value:H,enumerable:!0,configurable:!0,writable:!1}),H}const v=function(){function G(H,rt){this.constructor===G&&S("Cannot initialize BaseException."),this.message=H,this.name=rt}return G.prototype=new Error,G.constructor=G,G}();function J(Q){"string"!=typeof Q&&S("Invalid argument for stringToBytes");const G=Q.length,H=new Uint8Array(G);for(let rt=0;rt<G;++rt)H[rt]=255&Q.charCodeAt(rt);return H}function st(Q){return void 0!==Q.length?Q.length:void 0!==Q.byteLength?Q.byteLength:void S("Invalid argument for arrayByteLength")}e.BaseException=v,e.PasswordException=class x extends v{constructor(G,H){super(G,"PasswordException"),this.code=H}},e.UnknownErrorException=class D extends v{constructor(G,H){super(G,"UnknownErrorException"),this.details=H}},e.InvalidPDFException=class I extends v{constructor(G){super(G,"InvalidPDFException")}},e.MissingPDFException=class W extends v{constructor(G){super(G,"MissingPDFException")}},e.UnexpectedResponseException=class z extends v{constructor(G,H){super(G,"UnexpectedResponseException"),this.status=H}},e.FormatError=class q extends v{constructor(G){super(G,"FormatError")}},e.AbortException=class K extends v{constructor(G){super(G,"AbortException")}},e.FeatureTest=class lt{static get isLittleEndian(){return p(this,"isLittleEndian",function ft(){const Q=new Uint8Array(4);return Q[0]=1,1===new Uint32Array(Q.buffer,0,1)[0]}())}static get isEvalSupported(){return p(this,"isEvalSupported",function mt(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return p(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}};const ut=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class gt{static makeHexColor(G,H,rt){return`#${ut[G]}${ut[H]}${ut[rt]}`}static scaleMinMax(G,H){let rt;G[0]?(G[0]<0&&(rt=H[0],H[0]=H[1],H[1]=rt),H[0]*=G[0],H[1]*=G[0],G[3]<0&&(rt=H[2],H[2]=H[3],H[3]=rt),H[2]*=G[3],H[3]*=G[3]):(rt=H[0],H[0]=H[2],H[2]=rt,rt=H[1],H[1]=H[3],H[3]=rt,G[1]<0&&(rt=H[2],H[2]=H[3],H[3]=rt),H[2]*=G[1],H[3]*=G[1],G[2]<0&&(rt=H[0],H[0]=H[1],H[1]=rt),H[0]*=G[2],H[1]*=G[2]),H[0]+=G[4],H[1]+=G[4],H[2]+=G[5],H[3]+=G[5]}static transform(G,H){return[G[0]*H[0]+G[2]*H[1],G[1]*H[0]+G[3]*H[1],G[0]*H[2]+G[2]*H[3],G[1]*H[2]+G[3]*H[3],G[0]*H[4]+G[2]*H[5]+G[4],G[1]*H[4]+G[3]*H[5]+G[5]]}static applyTransform(G,H){return[G[0]*H[0]+G[1]*H[2]+H[4],G[0]*H[1]+G[1]*H[3]+H[5]]}static applyInverseTransform(G,H){const rt=H[0]*H[3]-H[1]*H[2];return[(G[0]*H[3]-G[1]*H[2]+H[2]*H[5]-H[4]*H[3])/rt,(-G[0]*H[1]+G[1]*H[0]+H[4]*H[1]-H[5]*H[0])/rt]}static getAxialAlignedBoundingBox(G,H){const rt=gt.applyTransform(G,H),ct=gt.applyTransform(G.slice(2,4),H),dt=gt.applyTransform([G[0],G[3]],H),ht=gt.applyTransform([G[2],G[1]],H);return[Math.min(rt[0],ct[0],dt[0],ht[0]),Math.min(rt[1],ct[1],dt[1],ht[1]),Math.max(rt[0],ct[0],dt[0],ht[0]),Math.max(rt[1],ct[1],dt[1],ht[1])]}static inverseTransform(G){const H=G[0]*G[3]-G[1]*G[2];return[G[3]/H,-G[1]/H,-G[2]/H,G[0]/H,(G[2]*G[5]-G[4]*G[3])/H,(G[4]*G[1]-G[5]*G[0])/H]}static apply3dTransform(G,H){return[G[0]*H[0]+G[1]*H[1]+G[2]*H[2],G[3]*H[0]+G[4]*H[1]+G[5]*H[2],G[6]*H[0]+G[7]*H[1]+G[8]*H[2]]}static singularValueDecompose2dScale(G){const H=[G[0],G[2],G[1],G[3]],rt=G[0]*H[0]+G[1]*H[2],ht=G[2]*H[1]+G[3]*H[3],Et=(rt+ht)/2,Pt=Math.sqrt((rt+ht)**2-4*(rt*ht-(G[2]*H[0]+G[3]*H[2])*(G[0]*H[1]+G[1]*H[3])))/2,yt=Et-Pt||1;return[Math.sqrt(Et+Pt||1),Math.sqrt(yt)]}static normalizeRect(G){const H=G.slice(0);return G[0]>G[2]&&(H[0]=G[2],H[2]=G[0]),G[1]>G[3]&&(H[1]=G[3],H[3]=G[1]),H}static intersect(G,H){const rt=Math.max(Math.min(G[0],G[2]),Math.min(H[0],H[2])),ct=Math.min(Math.max(G[0],G[2]),Math.max(H[0],H[2]));if(rt>ct)return null;const dt=Math.max(Math.min(G[1],G[3]),Math.min(H[1],H[3])),ht=Math.min(Math.max(G[1],G[3]),Math.max(H[1],H[3]));return dt>ht?null:[rt,dt,ct,ht]}static bezierBoundingBox(G,H,rt,ct,dt,ht,Et,Pt){const xt=[],yt=[[],[]];let wt,Ct,Mt,bt,Dt,Ot,It,Lt;for(let Nt=0;Nt<2;++Nt)if(0===Nt?(Ct=6*G-12*rt+6*dt,wt=-3*G+9*rt-9*dt+3*Et,Mt=3*rt-3*G):(Ct=6*H-12*ct+6*ht,wt=-3*H+9*ct-9*ht+3*Pt,Mt=3*ct-3*H),Math.abs(wt)<1e-12){if(Math.abs(Ct)<1e-12)continue;bt=-Mt/Ct,0<bt&&bt<1&&xt.push(bt)}else It=Ct*Ct-4*Mt*wt,Lt=Math.sqrt(It),!(It<0)&&(Dt=(-Ct+Lt)/(2*wt),0<Dt&&Dt<1&&xt.push(Dt),Ot=(-Ct-Lt)/(2*wt),0<Ot&&Ot<1&&xt.push(Ot));let vt,kt=xt.length;const Rt=kt;for(;kt--;)bt=xt[kt],vt=1-bt,yt[0][kt]=vt*vt*vt*G+3*vt*vt*bt*rt+3*vt*bt*bt*dt+bt*bt*bt*Et,yt[1][kt]=vt*vt*vt*H+3*vt*vt*bt*ct+3*vt*bt*bt*ht+bt*bt*bt*Pt;return yt[0][Rt]=G,yt[1][Rt]=H,yt[0][Rt+1]=Et,yt[1][Rt+1]=Pt,yt[0].length=yt[1].length=Rt+2,[Math.min(...yt[0]),Math.min(...yt[1]),Math.max(...yt[0]),Math.max(...yt[1])]}}e.Util=gt;const St=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ft(Q){return decodeURIComponent(escape(Q))}},($,e,E)=>{E(3)},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeJS=void 0;const E=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);e.isNodeJS=E},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:$,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:E}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=$,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=E}function setPDFNetworkStreamFactory($){createPDFNetworkStream=$}function getDocument($){const e=new PDFDocumentLoadingTask;let E;if("string"==typeof $||$ instanceof URL)E={url:$};else if((0,_util.isArrayBuffer)($))E={data:$};else if($ instanceof PDFDataRangeTransport)E={range:$};else{if("object"!=typeof $)throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!$.url&&!$.data&&!$.range)throw new Error("Invalid parameter object: need either .data, .range or .url");E=$}const n=Object.create(null);let f=null,O=null;for(const L in E){const y=E[L];switch(L){case"url":if(typeof window<"u")try{n[L]=new URL(y,window.location).href;continue}catch(h){(0,_util.warn)(`Cannot create valid URL: "${h}".`)}else if("string"==typeof y||y instanceof URL){n[L]=y.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":f=y;continue;case"worker":O=y;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&y instanceof Buffer)n[L]=new Uint8Array(y);else{if(y instanceof Uint8Array)break;if("string"==typeof y)n[L]=(0,_util.stringToBytes)(y);else if("object"!=typeof y||null===y||isNaN(y.length)){if(!(0,_util.isArrayBuffer)(y))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");n[L]=new Uint8Array(y)}else n[L]=new Uint8Array(y)}continue}n[L]=y}if(n.CMapReaderFactory=n.CMapReaderFactory||DefaultCMapReaderFactory,n.StandardFontDataFactory=n.StandardFontDataFactory||DefaultStandardFontDataFactory,n.ignoreErrors=!0!==n.stopAtErrors,n.fontExtraProperties=!0===n.fontExtraProperties,n.pdfBug=!0===n.pdfBug,n.enableXfa=!0===n.enableXfa,(!Number.isInteger(n.rangeChunkSize)||n.rangeChunkSize<1)&&(n.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof n.docBaseUrl||(0,_display_utils.isDataScheme)(n.docBaseUrl))&&(n.docBaseUrl=null),(!Number.isInteger(n.maxImageSize)||n.maxImageSize<-1)&&(n.maxImageSize=-1),"string"!=typeof n.cMapUrl&&(n.cMapUrl=null),"string"!=typeof n.standardFontDataUrl&&(n.standardFontDataUrl=null),"boolean"!=typeof n.useWorkerFetch&&(n.useWorkerFetch=n.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&n.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof n.isEvalSupported&&(n.isEvalSupported=!0),"boolean"!=typeof n.disableFontFace&&(n.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof n.useSystemFonts&&(n.useSystemFonts=!_is_node.isNodeJS&&!n.disableFontFace),("object"!=typeof n.ownerDocument||null===n.ownerDocument)&&(n.ownerDocument=globalThis.document),"boolean"!=typeof n.disableRange&&(n.disableRange=!1),"boolean"!=typeof n.disableStream&&(n.disableStream=!1),"boolean"!=typeof n.disableAutoFetch&&(n.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(n.verbosity),!O){const L={verbosity:n.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};O=L.port?PDFWorker.fromPort(L):new PDFWorker(L),e._worker=O}const k=e.docId;return O.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const L=_fetchDocument(O,n,f,k),y=new Promise(function(h){let i;f?i=new _transport_stream.PDFDataTransportStream({length:n.length,initialData:n.initialData,progressiveDone:n.progressiveDone,contentDispositionFilename:n.contentDispositionFilename,disableRange:n.disableRange,disableStream:n.disableStream},f):n.data||(i=createPDFNetworkStream({url:n.url,length:n.length,httpHeaders:n.httpHeaders,withCredentials:n.withCredentials,rangeChunkSize:n.rangeChunkSize,disableRange:n.disableRange,disableStream:n.disableStream})),h(i)});return Promise.all([L,y]).then(function([h,i]){if(e.destroyed)throw new Error("Loading aborted");const d=new _message_handler.MessageHandler(k,h,O.port),u=new WorkerTransport(d,e,i,n);e._transport=u,d.send("Ready",null)})}).catch(e._capability.reject),e}function _fetchDocument($,e,E,n){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(function*($,e,E,n){if($.destroyed)throw new Error("Worker was destroyed");E&&(e.length=E.length,e.initialData=E.initialData,e.progressiveDone=E.progressiveDone,e.contentDispositionFilename=E.contentDispositionFilename);const f=yield $.messageHandler.sendWithPromise("GetDocRequest",{docId:n,apiVersion:"2.16.105",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,docBaseUrl:e.docBaseUrl,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties,enableXfa:e.enableXfa,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null});if(e.data&&(e.data=null),$.destroyed)throw new Error("Worker was destroyed");return f})).apply(this,arguments)}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){var e=this;return _asyncToGenerator(function*(){e.destroyed=!0,yield e._transport?.destroy(),e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)})()}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,E,n=!1,f=null){this.length=e,this.initialData=E,this.progressiveDone=n,this.contentDispositionFilename=f,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,E){for(const n of this._rangeListeners)n(e,E)}onDataProgress(e,E){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,E)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const E of this._progressiveReadListeners)E(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,E){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,E){var f,n=this;this._pdfInfo=e,this._transport=E,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:(f=_asyncToGenerator(function*(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),n.stats||{streamTypes:{},fontTypes:{}}}),function(){return f.apply(this,arguments)})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,E,n,f,O=!1){this._pageIndex=e,this._pageInfo=E,this._ownerDocument=f,this._transport=n,this._stats=O?new _display_utils.StatTimer:null,this._pdfBug=O,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:E=this.rotate,offsetX:n=0,offsetY:f=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:E,offsetX:n,offsetY:f,dontFlip:O})}getAnnotations({intent:e="display"}={}){const E=this._transport.getRenderingIntent(e);let n=this._annotationPromises.get(E.cacheKey);return n||(n=this._transport.getAnnotations(this._pageIndex,E.renderingIntent),this._annotationPromises.set(E.cacheKey,n),n=n.then(f=>{for(const O of f)void 0!==O.titleObj&&Object.defineProperty(O,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),O.titleObj.str)}),void 0!==O.contentsObj&&Object.defineProperty(O,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),O.contentsObj.str)});return f})),n}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}getXfa(){var e=this;return _asyncToGenerator(function*(){return e._transport._htmlForXfa?.children[e._pageIndex]||null})()}render({canvasContext:e,viewport:E,intent:n="display",annotationMode:f=_util.AnnotationMode.ENABLE,transform:O=null,imageLayer:k=null,canvasFactory:L=null,background:y=null,optionalContentConfigPromise:h=null,annotationCanvasMap:i=null,pageColors:d=null,printAnnotationStorage:u=null}){void 0!==arguments[0]?.renderInteractiveForms&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_FORMS)),void 0!==arguments[0]?.includeAnnotationStorage&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const g=this._transport.getRenderingIntent(n,f,u);this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let a=this._intentStates.get(g.cacheKey);a||(a=Object.create(null),this._intentStates.set(g.cacheKey,a)),a.streamReaderCancelTimeout&&(clearTimeout(a.streamReaderCancelTimeout),a.streamReaderCancelTimeout=null);const m=L||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),A=!!(g.renderingIntent&_util.RenderingIntentFlag.PRINT);a.displayReadyCapability||(a.displayReadyCapability=(0,_util.createPromiseCapability)(),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(g));const M=_=>{a.renderTasks.delete(T),(this.cleanupAfterRender||A)&&(this.pendingCleanup=!0),this._tryCleanup(),_?(T.capability.reject(_),this._abortOperatorList({intentState:a,reason:_ instanceof Error?_:new Error(_)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},T=new InternalRenderTask({callback:M,params:{canvasContext:e,viewport:E,transform:O,imageLayer:k,background:y},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:i,operatorList:a.operatorList,pageIndex:this._pageIndex,canvasFactory:m,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:d});(a.renderTasks||=new Set).add(T);const F=T.task;return Promise.all([a.displayReadyCapability.promise,h]).then(([_,s])=>{this.pendingCleanup?M():(this._stats&&this._stats.time("Rendering"),T.initializeGraphics({transparency:_,optionalContentConfig:s}),T.operatorListChanged())}).catch(M),F}getOperatorList({intent:e="display",annotationMode:E=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){const O=this._transport.getRenderingIntent(e,E,n,!0);let L,k=this._intentStates.get(O.cacheKey);return k||(k=Object.create(null),this._intentStates.set(O.cacheKey,k)),k.opListReadCapability||(L=Object.create(null),L.operatorListChanged=function f(){k.operatorList.lastChunk&&(k.opListReadCapability.resolve(k.operatorList),k.renderTasks.delete(L))},k.opListReadCapability=(0,_util.createPromiseCapability)(),(k.renderTasks||=new Set).add(L),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(O)),k.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:E=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==e,includeMarkedContent:!0===E},{highWaterMark:100,size:f=>f.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>_xfa_text.XfaText.textContent(n));const E=this.streamTextContent(e);return new Promise(function(n,f){const k=E.getReader(),L={items:[],styles:Object.create(null)};!function O(){k.read().then(function({value:y,done:h}){h?n(L):(Object.assign(L.styles,y.styles),L.items.push(...y.items),O())},f)}()})}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const E of this._intentStates.values())if(this._abortOperatorList({intentState:E,reason:new Error("Page was destroyed."),force:!0}),!E.opListReadCapability)for(const n of E.renderTasks)e.push(n.completed),n.cancel();this.objs.clear();for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:E,operatorList:n}of this._intentStates.values())if(E.size>0||!n.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,E){const n=this._intentStates.get(E);n&&(this._stats&&this._stats.timeEnd("Page Request"),n.displayReadyCapability&&n.displayReadyCapability.resolve(e))}_renderPageChunk(e,E){for(let n=0,f=e.length;n<f;n++)E.operatorList.fnArray.push(e.fnArray[n]),E.operatorList.argsArray.push(e.argsArray[n]);E.operatorList.lastChunk=e.lastChunk,E.operatorList.separateAnnots=e.separateAnnots;for(const n of E.renderTasks)n.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:E,annotationStorageMap:n}){const O=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:E,annotationStorage:n}).getReader(),k=this._intentStates.get(E);k.streamReader=O;const L=()=>{O.read().then(({value:y,done:h})=>{h?k.streamReader=null:this._transport.destroyed||(this._renderPageChunk(y,k),L())},y=>{if(k.streamReader=null,!this._transport.destroyed){if(k.operatorList){k.operatorList.lastChunk=!0;for(const h of k.renderTasks)h.operatorListChanged();this._tryCleanup()}if(k.displayReadyCapability)k.displayReadyCapability.reject(y);else{if(!k.opListReadCapability)throw y;k.opListReadCapability.reject(y)}}})};L()}_abortOperatorList({intentState:e,reason:E,force:n=!1}){if(e.streamReader){if(!n){if(e.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException)return void(e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:E,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(e.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[f,O]of this._intentStates)if(O===e){this._intentStates.delete(f);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,E){const n={data:structuredClone(e,E)};this._deferred.then(()=>{for(const f of this._listeners)f.call(this,n)})}addEventListener(e,E){this._listeners.push(E)}removeEventListener(e,E){const n=this._listeners.indexOf(E);this._listeners.splice(n,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const $=document?.currentScript?.src;$&&(PDFWorkerUtil.fallbackWorkerSrc=$.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function($,e){let E;try{if(E=new URL($),!E.origin||"null"===E.origin)return!1}catch{return!1}const n=new URL(e,E);return E.origin===n.origin},PDFWorkerUtil.createCDNWrapper=function($){return URL.createObjectURL(new Blob([`importScripts("${$}");`]))};class PDFWorker{static#workerPorts=new WeakMap;constructor({name:$=null,port:e=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){if(e&&PDFWorker.#workerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=$,this.destroyed=!1,this.verbosity=E,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e)return PDFWorker.#workerPorts.set(e,this),void this._initializeFromPort(e);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort($){this._port=$,this._messageHandler=new _message_handler.MessageHandler("main","worker",$),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:$}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,$)||($=PDFWorkerUtil.createCDNWrapper(new URL($,window.location).href));const e=new Worker($),E=new _message_handler.MessageHandler("main","worker",e),n=()=>{e.removeEventListener("error",f),E.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},f=()=>{this._webWorker||n()};e.addEventListener("error",f),E.on("test",k=>{e.removeEventListener("error",f),this.destroyed?n():k?(this._messageHandler=E,this._port=e,this._webWorker=e,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),e.terminate())}),E.on("ready",k=>{if(e.removeEventListener("error",f),this.destroyed)n();else try{O()}catch{this._setupFakeWorker()}});const O=()=>{const k=new Uint8Array;E.send("test",k,[k.buffer])};return void O()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then($=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new LoopbackPort;this._port=e;const E="fake"+PDFWorkerUtil.fakeWorkerId++,n=new _message_handler.MessageHandler(E+"_worker",E,e);$.setup(n,e);const f=new _message_handler.MessageHandler(E,E+"_worker",e);this._messageHandler=f,this._readyCapability.resolve(),f.send("configure",{verbosity:this.verbosity})}).catch($=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${$.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort($){if(!$?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has($.port)?this.#workerPorts.get($.port):new PDFWorker($)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){var _this4=this;const loader=function(){var _ref2=_asyncToGenerator(function*(){const mainWorkerMessageHandler=_this4._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(_this4.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(_this4.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return function $(){return _ref2.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#t=null;#e=new Map;#i=new Map;#n=null;constructor(e,E,n,f){this.messageHandler=e,this.loadingTask=E,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:E.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:f.ownerDocument,styleElement:f.styleElement}),this._params=f,f.useWorkerFetch||(this.CMapReaderFactory=new f.CMapReaderFactory({baseUrl:f.cMapUrl,isCompressed:f.cMapPacked}),this.StandardFontDataFactory=new f.StandardFontDataFactory({baseUrl:f.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#t}getRenderingIntent(e,E=_util.AnnotationMode.ENABLE,n=null,f=!1){let O=_util.RenderingIntentFlag.DISPLAY,k=null;switch(e){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(E){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,k=(O&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${E}`)}return f&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${_annotation_storage.AnnotationStorage.getHash(k)}`,annotationStorageMap:k}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#e.values())e.push(n._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const E=this.messageHandler.sendWithPromise("Terminate",null);return e.push(E),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#n=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:E}=this;e.on("GetReader",(n,f)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},f.onPull=()=>{this._fullReader.read().then(function({value:O,done:k}){k?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(O),"GetReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(O),1,[O]))}).catch(O=>{f.error(O)})},f.onCancel=O=>{this._fullReader.cancel(O),f.ready.catch(k=>{if(!this.destroyed)throw k})}}),e.on("ReaderHeadersReady",n=>{const f=(0,_util.createPromiseCapability)(),O=this._fullReader;return O.headersReady.then(()=>{(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&E.onProgress?.(this._lastProgress),O.onProgress=k=>{E.onProgress?.({loaded:k.loaded,total:k.total})}),f.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},f.reject),f.promise}),e.on("GetRangeReader",(n,f)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(n.begin,n.end);O?(f.onPull=()=>{O.read().then(function({value:k,done:L}){L?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(k),"GetRangeReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(k),1,[k]))}).catch(k=>{f.error(k)})},f.onCancel=k=>{O.cancel(k),f.ready.catch(L=>{if(!this.destroyed)throw L})}):f.close()}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,E._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",function(n){let f;switch(n.name){case"PasswordException":f=new _util.PasswordException(n.message,n.code);break;case"InvalidPDFException":f=new _util.InvalidPDFException(n.message);break;case"MissingPDFException":f=new _util.MissingPDFException(n.message);break;case"UnexpectedResponseException":f=new _util.UnexpectedResponseException(n.message,n.status);break;case"UnknownErrorException":f=new _util.UnknownErrorException(n.message,n.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}E._capability.reject(f)}),e.on("PasswordRequest",n=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),E.onPassword){const f=O=>{O instanceof Error?this._passwordCapability.reject(O):this._passwordCapability.resolve({password:O})};try{E.onPassword(f,n.code)}catch(O){this._passwordCapability.reject(O)}}else this._passwordCapability.reject(new _util.PasswordException(n.message,n.code));return this._passwordCapability.promise}),e.on("DataLoaded",n=>{E.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{this.destroyed||this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,f,O])=>{if(!this.destroyed&&!this.commonObjs.has(n))switch(f){case"Font":const k=this._params;if("error"in O){const h=O.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}let L=null;k.pdfBug&&globalThis.FontInspector?.enabled&&(L={registerFont(h,i){globalThis.FontInspector.fontAdded(h,i)}});const y=new _font_loader.FontFaceObject(O,{isEvalSupported:k.isEvalSupported,disableFontFace:k.disableFontFace,ignoreErrors:k.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:L});this.fontLoader.bind(y).catch(h=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!k.fontExtraProperties&&y.data&&(y.data=null),this.commonObjs.resolve(n,y)});break;case"FontPath":case"Image":this.commonObjs.resolve(n,O);break;default:throw new Error(`Got unknown common object type ${f}`)}}),e.on("obj",([n,f,O,k])=>{if(this.destroyed)return;const L=this.#e.get(f);if(!L.objs.has(n))switch(O){case"Image":L.objs.resolve(n,k);const y=8e6;if(k){let h;if(k.bitmap){const{bitmap:i,width:d,height:u}=k;h=d*u*4,L._bitmaps.add(i)}else h=k.data?.length||0;h>y&&(L.cleanupAfterRender=!0)}break;case"Pattern":L.objs.resolve(n,k);break;default:throw new Error(`Got unknown object type ${O}`)}}),e.on("DocProgress",n=>{this.destroyed||E.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("DocStats",n=>{this.destroyed||(this.#t=Object.freeze({streamTypes:Object.freeze(n.streamTypes),fontTypes:Object.freeze(n.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const E=e-1,n=this.#i.get(E);if(n)return n;const f=this.messageHandler.sendWithPromise("GetPage",{pageIndex:E}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const k=new PDFPageProxy(E,O,this,this._params.ownerDocument,this._params.pdfBug);return this.#e.set(E,k),k});return this.#i.set(E,f),f}getPageIndex(e){return"object"!=typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,E){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:E})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#n||=this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){var E=this;return _asyncToGenerator(function*(){if(yield E.messageHandler.sendWithPromise("Cleanup",null),!E.destroyed){for(const n of E.#e.values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);E.commonObjs.clear(),e||E.fontLoader.clear(),E.#n=null,E._getFieldObjectsPromise=null,E._hasJSActionsPromise=null}})()}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}class PDFObjects{#t=Object.create(null);#e(e){return this.#t[e]||(this.#t[e]={capability:(0,_util.createPromiseCapability)(),data:null})}get(e,E=null){if(E){const f=this.#e(e);return f.capability.promise.then(()=>E(f.data)),null}const n=this.#t[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){return this.#t[e]?.capability.settled||!1}resolve(e,E=null){const n=this.#e(e);n.data=E,n.capability.resolve()}clear(){this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(e){this.#t=e,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(){this.#t.cancel()}get separateAnnots(){const{separateAnnots:e}=this.#t.operatorList;if(!e)return!1;const{annotationCanvasMap:E}=this.#t;return e.form||e.canvas&&E?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:e,params:E,objs:n,commonObjs:f,annotationCanvasMap:O,operatorList:k,pageIndex:L,canvasFactory:y,useRequestAnimationFrame:h=!1,pdfBug:i=!1,pageColors:d=null}){this.callback=e,this.params=E,this.objs=n,this.commonObjs=f,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=k,this._pageIndex=L,this.canvasFactory=y,this._pdfBug=i,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:E}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:f,transform:O,imageLayer:k,background:L}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,k,E,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:O,viewport:f,transparency:e,background:L}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){var e=this;return _asyncToGenerator(function*(){e.cancelled||(e.operatorListIdx=e.gfx.executeOperatorList(e.operatorList,e.operatorListIdx,e._continueBound,e.stepper),e.operatorListIdx===e.operatorList.argsArray.length&&(e.running=!1,e.operatorList.lastChunk&&(e.gfx.endDrawing(),e._canvas&&InternalRenderTask.#t.delete(e._canvas),e.callback())))})()}}const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=E(1),f=E(6),O=E(10);class k{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(h,i){const d=this._storage.get(h);return void 0===d?i:Object.assign(i,d)}getRawValue(h){return this._storage.get(h)}remove(h){if(this._storage.delete(h),0===this._storage.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const i of this._storage.values())if(i instanceof f.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(h,i){const d=this._storage.get(h);let u=!1;if(void 0!==d)for(const[g,a]of Object.entries(i))d[g]!==a&&(u=!0,d[g]=a);else u=!0,this._storage.set(h,i);u&&this.#t(),i instanceof f.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(i.constructor._type)}has(h){return this._storage.has(h)}getAll(){return this._storage.size>0?(0,n.objectFromMap)(this._storage):null}get size(){return this._storage.size}#t(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new L(this)}get serializable(){if(0===this._storage.size)return null;const h=new Map;for(const[i,d]of this._storage){const u=d instanceof f.AnnotationEditor?d.serialize():d;u&&h.set(i,u)}return h}static getHash(h){if(!h)return"";const i=new O.MurmurHash3_64;for(const[d,u]of h)i.update(`${d}:${JSON.stringify(u)}`);return i.hexdigest()}}e.AnnotationStorage=k;class L extends k{#t=null;constructor(h){super(),this.#t=structuredClone(h.serializable)}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}e.PrintAnnotationStorage=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=E(7),f=E(1);class O{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#i=!1;#n=!1;#r=!1;#h=O._zIndex++;static _colorManager=new n.ColorManager;static _zIndex=1;constructor(L){this.constructor===O&&(0,f.unreachable)("Cannot initialize AnnotationEditor."),this.parent=L.parent,this.id=L.id,this.width=this.height=null,this.pageIndex=L.parent.pageIndex,this.name=L.name,this.div=null;const[y,h]=this.parent.viewportBaseDimensions;this.x=L.x/y,this.y=L.y/h,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,f.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#h}focusin(L){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(L){!this.isAttachedToDOM||L.relatedTarget?.closest(`#${this.id}`)||(L.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(L){const y=this.parent.div.getBoundingClientRect();this.startX=L.clientX-y.x,this.startY=L.clientY-y.y,L.dataTransfer.setData("text/plain",this.id),L.dataTransfer.effectAllowed="move"}setAt(L,y,h,i){const[d,u]=this.parent.viewportBaseDimensions;[h,i]=this.screenToPageTranslation(h,i),this.x=(L+h)/d,this.y=(y+i)/u,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(L,y){const[h,i]=this.parent.viewportBaseDimensions;[L,y]=this.screenToPageTranslation(L,y),this.x+=L/h,this.y+=y/i,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(L,y){const{rotation:h}=this.parent.viewport;switch(h){case 90:return[y,-L];case 180:return[-L,-y];case 270:return[-y,L];default:return[L,y]}}setDims(L,y){const[h,i]=this.parent.viewportBaseDimensions;this.div.style.width=100*L/h+"%",this.div.style.height=100*y/i+"%"}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);const[L,y]=this.getInitialTranslation();return this.translate(L,y),(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(L){const y=n.KeyboardManager.platform.isMac;0!==L.button||L.ctrlKey&&y?L.preventDefault():(L.ctrlKey&&!y||L.shiftKey||L.metaKey&&y?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0)}getRect(L,y){const[h,i]=this.parent.viewportBaseDimensions,[d,u]=this.parent.pageDimensions,g=d*L/h,a=u*y/i,m=this.x*d,A=this.y*u,M=this.width*d,T=this.height*u;switch(this.rotation){case 0:return[m+g,u-A-a-T,m+g+M,u-A-a];case 90:return[m+a,u-A+g,m+a+T,u-A+g+M];case 180:return[m-g-M,u-A+a,m-g,u-A+a+T];case 270:return[m-a-T,u-A-g-M,m-a,u-A-g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(L,y){const[h,i,d,u]=L,g=d-h,a=u-i;switch(this.rotation){case 0:return[h,y-u,g,a];case 90:return[h,y-i,a,g];case 180:return[d,y-i,g,a];case 270:return[d,y-u,a,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,f.unreachable)("An editor must be serializable")}static deserialize(L,y){const h=new this.prototype.constructor({parent:y,id:y.getNextId()});h.rotation=L.rotation;const[i,d]=y.pageDimensions,[u,g,a,m]=h.getRectInCurrentCoords(L.rect,d);return h.x=u/i,h.y=g/d,h.width=a/i,h.height=m/d,h}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(L,y){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#n}set isEditing(L){this.#n=L,L?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}e.AnnotationEditor=O},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=function O(g,a,m){for(const A of m)a.addEventListener(A,g[A].bind(g))},e.opacityToHex=function k(g){return Math.round(Math.min(255,Math.max(1,255*g))).toString(16).padStart(2,"0")};var n=E(1),f=E(8);class L{#t=0;getId(){return`${n.AnnotationEditorPrefix}${this.#t++}`}}class y{#t=[];#e=!1;#i;#n=-1;constructor(a=128){this.#i=a}add({cmd:a,undo:m,mustExec:A,type:M=NaN,overwriteIfSameType:T=!1,keepUndo:F=!1}){if(A&&a(),this.#e)return;const _={cmd:a,undo:m,type:M};if(-1===this.#n)return this.#t.length>0&&(this.#t.length=0),this.#n=0,void this.#t.push(_);if(T&&this.#t[this.#n].type===M)return F&&(_.undo=this.#t[this.#n].undo),void(this.#t[this.#n]=_);const s=this.#n+1;s===this.#i?this.#t.splice(0,1):(this.#n=s,s<this.#t.length&&this.#t.splice(s)),this.#t.push(_)}undo(){-1!==this.#n&&(this.#e=!0,this.#t[this.#n].undo(),this.#e=!1,this.#n-=1)}redo(){this.#n<this.#t.length-1&&(this.#n+=1,this.#e=!0,this.#t[this.#n].cmd(),this.#e=!1)}hasSomethingToUndo(){return-1!==this.#n}hasSomethingToRedo(){return this.#n<this.#t.length-1}destroy(){this.#t=null}}e.CommandManager=y;class h{constructor(a){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const m=h.platform.isMac;for(const[A,M]of a)for(const T of A){const F=T.startsWith("mac+");m&&F?(this.callbacks.set(T.slice(4),M),this.allKeys.add(T.split("+").at(-1))):!m&&!F&&(this.callbacks.set(T,M),this.allKeys.add(T.split("+").at(-1)))}}static get platform(){const a=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:a.includes("Win"),isMac:a.includes("Mac")})}#t(a){a.altKey&&this.buffer.push("alt"),a.ctrlKey&&this.buffer.push("ctrl"),a.metaKey&&this.buffer.push("meta"),a.shiftKey&&this.buffer.push("shift"),this.buffer.push(a.key);const m=this.buffer.join("+");return this.buffer.length=0,m}exec(a,m){if(!this.allKeys.has(m.key))return;const A=this.callbacks.get(this.#t(m));A&&(A.bind(a)(),m.stopPropagation(),m.preventDefault())}}e.KeyboardManager=h;class i{#t=null;copy(a){a&&(Array.isArray(a)?this.#t=a.map(m=>m.serialize()):this.#t=[a.serialize()],this.#t=this.#t.filter(m=>!!m),0===this.#t.length&&(this.#t=null))}paste(){return this.#t}isEmpty(){return null===this.#t}destroy(){this.#t=null}}class d{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const a=new Map([["CanvasText",null],["Canvas",null]]);return(0,f.getColorValues)(a),(0,n.shadow)(this,"_colors",a)}convert(a){const m=(0,f.getRGB)(a);if(!window.matchMedia("(forced-colors: active)").matches)return m;for(const[A,M]of this._colors)if(M.every((T,F)=>T===m[F]))return d._colorsMapping.get(A);return m}getHexCode(a){const m=this._colors.get(a);return m?n.Util.makeHexColor(...m):a}}e.ColorManager=d;class u{#t=null;#e=new Map;#i=new Map;#n=new i;#r=new y;#h=0;#o=null;#s=null;#u=new L;#l=!1;#c=n.AnnotationEditorType.NONE;#a=new Set;#m=this.keydown.bind(this);#p=this.onEditingAction.bind(this);#C=this.onPageChanging.bind(this);#T={isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#b=null;static _keyboardManager=new h([[["ctrl+a","mac+meta+a"],u.prototype.selectAll],[["ctrl+c","mac+meta+c"],u.prototype.copy],[["ctrl+v","mac+meta+v"],u.prototype.paste],[["ctrl+x","mac+meta+x"],u.prototype.cut],[["ctrl+z","mac+meta+z"],u.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],u.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],u.prototype.delete],[["Escape","mac+Escape"],u.prototype.unselectAll]]);constructor(a,m){this.#b=a,this.#s=m,this.#s._on("editingaction",this.#p),this.#s._on("pagechanging",this.#C)}destroy(){this.#y(),this.#s._off("editingaction",this.#p),this.#s._off("pagechanging",this.#C);for(const a of this.#i.values())a.destroy();this.#i.clear(),this.#e.clear(),this.#t=null,this.#a.clear(),this.#n.destroy(),this.#r.destroy()}onPageChanging({pageNumber:a}){this.#h=a-1}focusMainContainer(){this.#b.focus()}#x(){this.#b.addEventListener("keydown",this.#m)}#y(){this.#b.removeEventListener("keydown",this.#m)}keydown(a){this.getActive()?.shouldGetKeyboardEvents()||u._keyboardManager.exec(this,a)}onEditingAction(a){["undo","redo","cut","copy","paste","delete","selectAll"].includes(a.name)&&this[a.name]()}#d(a){Object.entries(a).some(([A,M])=>this.#T[A]!==M)&&this.#s.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#T,a)})}#A(a){this.#s.dispatch("annotationeditorparamschanged",{source:this,details:a})}setEditingState(a){a?(this.#x(),this.#d({isEditing:this.#c!==n.AnnotationEditorType.NONE,isEmpty:this.#g(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:this.#n.isEmpty()})):(this.#y(),this.#d({isEditing:!1}))}registerEditorTypes(a){this.#o=a;for(const m of this.#o)this.#A(m.defaultPropertiesToUpdate)}getId(){return this.#u.getId()}addLayer(a){this.#i.set(a.pageIndex,a),this.#l?a.enable():a.disable()}removeLayer(a){this.#i.delete(a.pageIndex)}updateMode(a){if(this.#c=a,a===n.AnnotationEditorType.NONE)this.setEditingState(!1),this.#f();else{this.setEditingState(!0),this.#P();for(const m of this.#i.values())m.updateMode(a)}}updateToolbar(a){a!==this.#c&&this.#s.dispatch("switchannotationeditormode",{source:this,mode:a})}updateParams(a,m){for(const A of this.#a)A.updateParams(a,m);for(const A of this.#o)A.updateDefaultParams(a,m)}#P(){if(!this.#l){this.#l=!0;for(const a of this.#i.values())a.enable()}}#f(){if(this.unselectAll(),this.#l){this.#l=!1;for(const a of this.#i.values())a.disable()}}getEditors(a){const m=[];for(const A of this.#e.values())A.pageIndex===a&&m.push(A);return m}getEditor(a){return this.#e.get(a)}addEditor(a){this.#e.set(a.id,a)}removeEditor(a){this.#e.delete(a.id),this.unselect(a)}#v(a){const m=this.#i.get(a.pageIndex);m?m.addOrRebuild(a):this.addEditor(a)}setActiveEditor(a){this.#t!==a&&(this.#t=a,a&&this.#A(a.propertiesToUpdate))}toggleSelected(a){if(this.#a.has(a))return this.#a.delete(a),a.unselect(),void this.#d({hasSelectedEditor:this.hasSelection});this.#a.add(a),a.select(),this.#A(a.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}setSelected(a){for(const m of this.#a)m!==a&&m.unselect();this.#a.clear(),this.#a.add(a),a.select(),this.#A(a.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}isSelected(a){return this.#a.has(a)}unselect(a){a.unselect(),this.#a.delete(a),this.#d({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#a.size}undo(){this.#r.undo(),this.#d({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#g()})}redo(){this.#r.redo(),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#g()})}addCommands(a){this.#r.add(a),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#g()})}#g(){if(0===this.#e.size)return!0;if(1===this.#e.size)for(const a of this.#e.values())return a.isEmpty();return!1}delete(){if(this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const a=[...this.#a];this.addCommands({cmd:()=>{for(const M of a)M.remove()},undo:()=>{for(const M of a)this.#v(M)},mustExec:!0})}copy(){if(this.#t&&this.#t.commitOrRemove(),this.hasSelection){const a=[];for(const m of this.#a)m.isEmpty()||a.push(m);if(0===a.length)return;this.#n.copy(a),this.#d({hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(this.#n.isEmpty())return;this.unselectAll();const a=this.#i.get(this.#h),m=this.#n.paste().map(T=>a.deserialize(T));this.addCommands({cmd:()=>{for(const T of m)this.#v(T);this.#_(m)},undo:()=>{for(const T of m)T.remove()},mustExec:!0})}#_(a){this.#a.clear();for(const m of a)m.isEmpty()||(this.#a.add(m),m.select());this.#d({hasSelectedEditor:!0})}selectAll(){for(const a of this.#a)a.commit();this.#_(this.#e.values())}unselectAll(){if(this.#t)this.#t.commitOrRemove();else if(0!==this.#_.size){for(const a of this.#a)a.unselect();this.#a.clear(),this.#d({hasSelectedEditor:!1})}}isActive(a){return this.#t===a}getActive(){return this.#t}getMode(){return this.#c}}e.AnnotationEditorUIManager=u},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=function b(V){console.log("Deprecated API usage: "+V)},e.getColorValues=function tt(V){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const B of V.keys()){U.style.color=B;const X=window.getComputedStyle(U).color;V.set(B,N(X))}U.remove()},e.getCurrentTransform=function Z(V){const{a:U,b:B,c:X,d:C,e:o,f:c}=V.getTransform();return[U,B,X,C,o,c]},e.getCurrentTransformInverse=function Y(V){const{a:U,b:B,c:X,d:C,e:o,f:c}=V.getTransform().invertSelf();return[U,B,X,C,o,c]},e.getFilenameFromUrl=function T(V){const U=V.indexOf("#"),B=V.indexOf("?"),X=Math.min(U>0?U:V.length,B>0?B:V.length);return V.substring(V.lastIndexOf("/",X)+1,X)},e.getPdfFilenameFromUrl=function F(V,U="document.pdf"){if("string"!=typeof V)return U;if(A(V))return(0,f.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const X=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,C=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(V);let o=X.exec(C[1])||X.exec(C[2])||X.exec(C[3]);if(o&&(o=o[0],o.includes("%")))try{o=X.exec(decodeURIComponent(o))[0]}catch{}return o||U},e.getRGB=N,e.getXfaPageViewport=function j(V,{scale:U=1,rotation:B=0}){const{width:X,height:C}=V.attributes.style,o=[0,0,parseInt(X),parseInt(C)];return new a({viewBox:o,scale:U,rotation:B})},e.isDataScheme=A,e.isPdfFile=function M(V){return"string"==typeof V&&/\.pdf$/i.test(V)},e.isValidFetchUrl=s,e.loadScript=function l(V,U=!1){return new Promise((B,X)=>{const C=document.createElement("script");C.src=V,C.onload=function(o){U&&C.remove(),B(o)},C.onerror=function(){X(new Error(`Cannot load script at: ${C.src}`))},(document.head||document.documentElement).append(C)})};var n=E(9),f=E(1);function h(V){return i.apply(this,arguments)}function i(){return(i=_asyncToGenerator(function*(V,U=!1){if(s(V,document.baseURI)){const B=yield fetch(V);if(!B.ok)throw new Error(B.statusText);return U?new Uint8Array(yield B.arrayBuffer()):(0,f.stringToBytes)(yield B.text())}return new Promise((B,X)=>{const C=new XMLHttpRequest;C.open("GET",V,!0),U&&(C.responseType="arraybuffer"),C.onreadystatechange=()=>{if(C.readyState===XMLHttpRequest.DONE){if(200===C.status||0===C.status){let o;if(U&&C.response?o=new Uint8Array(C.response):!U&&C.responseText&&(o=(0,f.stringToBytes)(C.responseText)),o)return void B(o)}X(new Error(C.statusText))}},C.send(null)})})).apply(this,arguments)}e.AnnotationPrefix="pdfjs_internal_id_",e.PixelsPerInch=class L{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF},e.DOMCanvasFactory=class y extends n.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,B){const X=this._document.createElement("canvas");return X.width=U,X.height=B,X}},e.DOMCMapReaderFactory=class d extends n.BaseCMapReaderFactory{_fetchData(U,B){return h(U,this.isCompressed).then(X=>({cMapData:X,compressionType:B}))}},e.DOMStandardFontDataFactory=class u extends n.BaseStandardFontDataFactory{_fetchData(U){return h(U,!0)}},e.DOMSVGFactory=class g extends n.BaseSVGFactory{_createSVG(U){return document.createElementNS("http://www.w3.org/2000/svg",U)}};class a{constructor({viewBox:U,scale:B,rotation:X,offsetX:C=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=U,this.scale=B,this.rotation=X,this.offsetX=C,this.offsetY=o;const S=(U[2]+U[0])/2,P=(U[3]+U[1])/2;let t,r,p,v,x,D,I,W;switch((X%=360)<0&&(X+=360),X){case 180:t=-1,r=0,p=0,v=1;break;case 90:t=0,r=1,p=1,v=0;break;case 270:t=0,r=-1,p=-1,v=0;break;case 0:t=1,r=0,p=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(p=-p,v=-v),0===t?(x=Math.abs(P-U[1])*B+C,D=Math.abs(S-U[0])*B+o,I=Math.abs(U[3]-U[1])*B,W=Math.abs(U[2]-U[0])*B):(x=Math.abs(S-U[0])*B+C,D=Math.abs(P-U[1])*B+o,I=Math.abs(U[2]-U[0])*B,W=Math.abs(U[3]-U[1])*B),this.transform=[t*B,r*B,p*B,v*B,x-t*B*S-p*B*P,D-r*B*S-v*B*P],this.width=I,this.height=W}clone({scale:U=this.scale,rotation:B=this.rotation,offsetX:X=this.offsetX,offsetY:C=this.offsetY,dontFlip:o=!1}={}){return new a({viewBox:this.viewBox.slice(),scale:U,rotation:B,offsetX:X,offsetY:C,dontFlip:o})}convertToViewportPoint(U,B){return f.Util.applyTransform([U,B],this.transform)}convertToViewportRectangle(U){const B=f.Util.applyTransform([U[0],U[1]],this.transform),X=f.Util.applyTransform([U[2],U[3]],this.transform);return[B[0],B[1],X[0],X[1]]}convertToPdfPoint(U,B){return f.Util.applyInverseTransform([U,B],this.transform)}}function A(V){const U=V.length;let B=0;for(;B<U&&""===V[B].trim();)B++;return"data:"===V.substring(B,B+5).toLowerCase()}function s(V,U){try{const{protocol:B}=U?new URL(V,U):new URL(V);return"http:"===B||"https:"===B}catch{return!1}}let w;function N(V){if(V.startsWith("#")){const U=parseInt(V.slice(1),16);return[(16711680&U)>>16,(65280&U)>>8,255&U]}return V.startsWith("rgb(")?V.slice(4,-1).split(",").map(U=>parseInt(U)):V.startsWith("rgba(")?V.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,f.warn)(`Not a valid color format: "${V}"`),[0,0,0])}e.PageViewport=a,e.RenderingCancelledException=class m extends f.BaseException{constructor(U,B){super(U,"RenderingCancelledException"),this.type=B}},e.StatTimer=class _{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,f.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,f.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let B=0;for(const X of this.times){const C=X.name;C.length>B&&(B=C.length)}for(const X of this.times){const C=X.end-X.start;U.push(`${X.name.padEnd(B)} ${C}ms\n`)}return U.join("")}},e.PDFDateString=class R{static toDateObject(U){if(!U||"string"!=typeof U)return null;w||(w=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const B=w.exec(U);if(!B)return null;const X=parseInt(B[1],10);let C=parseInt(B[2],10);C=C>=1&&C<=12?C-1:0;let o=parseInt(B[3],10);o=o>=1&&o<=31?o:1;let c=parseInt(B[4],10);c=c>=0&&c<=23?c:0;let S=parseInt(B[5],10);S=S>=0&&S<=59?S:0;let P=parseInt(B[6],10);P=P>=0&&P<=59?P:0;const t=B[7]||"Z";let r=parseInt(B[8],10);r=r>=0&&r<=23?r:0;let p=parseInt(B[9],10)||0;return p=p>=0&&p<=59?p:0,"-"===t?(c+=r,S+=p):"+"===t&&(c-=r,S-=p),new Date(Date.UTC(X,C,o,c,S,P))}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=E(1);class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,i){if(h<=0||i<=0)throw new Error("Invalid canvas size");const d=this._createCanvas(h,i);return{canvas:d,context:d.getContext("2d")}}reset(h,i,d){if(!h.canvas)throw new Error("Canvas is not specified");if(i<=0||d<=0)throw new Error("Invalid canvas size");h.canvas.width=i,h.canvas.height=d}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,i){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=f;class O{constructor({baseUrl:h=null,isCompressed:i=!1}){this.constructor===O&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=i}fetch({name:h}){var i=this;return _asyncToGenerator(function*(){if(!i.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const d=i.baseUrl+h+(i.isCompressed?".bcmap":"");return i._fetchData(d,i.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE).catch(g=>{throw new Error(`Unable to load ${i.isCompressed?"binary ":""}CMap at: ${d}`)})})()}_fetchData(h,i){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=O;class k{constructor({baseUrl:h=null}){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}fetch({filename:h}){var i=this;return _asyncToGenerator(function*(){if(!i.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const d=`${i.baseUrl}${h}`;return i._fetchData(d).catch(u=>{throw new Error(`Unable to load font data at: ${d}`)})})()}_fetchData(h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=k;class L{constructor(){this.constructor===L&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,i,d=!1){if(h<=0||i<=0)throw new Error("Invalid SVG dimensions");const u=this._createSVG("svg:svg");return u.setAttribute("version","1.1"),d||(u.setAttribute("width",`${h}px`),u.setAttribute("height",`${i}px`)),u.setAttribute("preserveAspectRatio","none"),u.setAttribute("viewBox",`0 0 ${h} ${i}`),u}createElement(h){if("string"!=typeof h)throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=E(1);const f=3285377520,O=4294901760,k=65535;e.MurmurHash3_64=class L{constructor(h){this.h1=h?4294967295&h:f,this.h2=h?4294967295&h:f}update(h){let i,d;if("string"==typeof h){i=new Uint8Array(2*h.length),d=0;for(let b=0,w=h.length;b<w;b++){const R=h.charCodeAt(b);R<=255?i[d++]=R:(i[d++]=R>>>8,i[d++]=255&R)}}else{if(!(0,n.isArrayBuffer)(h))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");i=h.slice(),d=i.byteLength}const u=d>>2,g=d-4*u,a=new Uint32Array(i.buffer,0,u);let m=0,A=0,M=this.h1,T=this.h2;const F=3432918353,_=461845907,s=F&k,l=_&k;for(let b=0;b<u;b++)1&b?(m=a[b],m=m*F&O|m*s&k,m=m<<15|m>>>17,m=m*_&O|m*l&k,M^=m,M=M<<13|M>>>19,M=5*M+3864292196):(A=a[b],A=A*F&O|A*s&k,A=A<<15|A>>>17,A=A*_&O|A*l&k,T^=A,T=T<<13|T>>>19,T=5*T+3864292196);switch(m=0,g){case 3:m^=i[4*u+2]<<16;case 2:m^=i[4*u+1]<<8;case 1:m^=i[4*u],m=m*F&O|m*s&k,m=m<<15|m>>>17,m=m*_&O|m*l&k,1&u?M^=m:T^=m}this.h1=M,this.h2=T}hexdigest(){let h=this.h1,i=this.h2;h^=i>>>1,h=3981806797*h&O|36045*h&k,i=4283543511*i&O|(2950163797*(i<<16|h>>>16)&O)>>>16,h^=i>>>1,h=444984403*h&O|60499*h&k,i=3301882366*i&O|(3120437893*(i<<16|h>>>16)&O)>>>16,h^=i>>>1;const d=(h>>>0).toString(16),u=(i>>>0).toString(16);return d.padStart(8,"0")+u.padStart(8,"0")}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=E(1);class f{constructor({docId:y,onUnsupportedFeature:h,ownerDocument:i=globalThis.document,styleElement:d=null}){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=y,this._onUnsupportedFeature=h,this._document=i,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(y){this.nativeFontFaces.push(y),this._document.fonts.add(y)}insertRule(y){let h=this.styleElement;h||(h=this.styleElement=this._document.createElement("style"),h.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(h));const i=h.sheet;i.insertRule(y,i.cssRules.length)}clear(){for(const y of this.nativeFontFaces)this._document.fonts.delete(y);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}bind(y){var h=this;return _asyncToGenerator(function*(){if(y.attached||y.missingFile)return;if(y.attached=!0,h.isFontLoadingAPISupported){const d=y.createNativeFontFace();if(d){h.addNativeFontFace(d);try{yield d.loaded}catch(u){throw h._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${d.family}': '${u}'.`),y.disableFontFace=!0,u}}return}const i=y.createFontFaceRule();if(i){if(h.insertRule(i),h.isSyncFontLoadingSupported)return;yield new Promise(d=>{const u=h._queueLoadingCallback(d);h._prepareFontLoadEvent([i],[y],u)})}})()}_queueLoadingCallback(y){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){return(0,n.shadow)(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(y,h,i){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let O;e.FontLoader=O,e.FontLoader=O=class extends f{constructor(y){super(y),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let y=!1;return(typeof navigator>"u"||/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14)&&(y=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",y)}_queueLoadingCallback(y){const i=this.loadingContext,d={id:"pdfjs-font-loading-"+i.nextRequestId++,done:!1,complete:function h(){for((0,n.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;i.requests.length>0&&i.requests[0].done;){const u=i.requests.shift();setTimeout(u.callback,0)}},callback:y};return i.requests.push(d),d}get _loadTestFont(){return(0,n.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(y,h,i){function d(Z,Y){return Z.charCodeAt(Y)<<24|Z.charCodeAt(Y+1)<<16|Z.charCodeAt(Y+2)<<8|255&Z.charCodeAt(Y+3)}function u(Z,Y,V,U){return Z.substring(0,Y)+U+Z.substring(Y+V)}let g,a;const m=this._document.createElement("canvas");m.width=1,m.height=1;const A=m.getContext("2d");let M=0;const F=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=u(_,976,F.length,F);const b=1482184792;let w=d(_,16);for(g=0,a=F.length-3;g<a;g+=4)w=w-b+d(F,g)|0;g<F.length&&(w=w-b+d(F+"XXX",g)|0),_=u(_,16,4,(0,n.string32)(w));const R=`url(data:font/opentype;base64,${btoa(_)});`;this.insertRule(`@font-face {font-family:"${F}";src:${R}}`);const N=[];for(const Z of h)N.push(Z.loadedName);N.push(F);const tt=this._document.createElement("div");tt.style.visibility="hidden",tt.style.width=tt.style.height="10px",tt.style.position="absolute",tt.style.top=tt.style.left="0px";for(const Z of N){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=Z,tt.append(Y)}this._document.body.append(tt),function T(Z,Y){if(M++,M>30)return(0,n.warn)("Load test font never loaded."),void Y();A.font="30px "+Z,A.fillText(".",0,20),A.getImageData(0,0,1,1).data[3]>0?Y():setTimeout(T.bind(null,Z,Y))}(F,()=>{tt.remove(),i.complete()})}},e.FontFaceObject=class k{constructor(y,{isEvalSupported:h=!0,disableFontFace:i=!1,ignoreErrors:d=!1,onUnsupportedFeature:u,fontRegistry:g=null}){this.compiledGlyphs=Object.create(null);for(const a in y)this[a]=y[a];this.isEvalSupported=!1!==h,this.disableFontFace=!0===i,this.ignoreErrors=!0===d,this._onUnsupportedFeature=u,this.fontRegistry=g}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let y;if(this.cssFontInfo){const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),y=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}else y=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),y}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const y=(0,n.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(y)});`;let i;if(this.cssFontInfo){let d=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(d+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${d}src:${h}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${h}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,h),i}getPathGenerator(y,h){if(void 0!==this.compiledGlyphs[h])return this.compiledGlyphs[h];let i;try{i=y.get(this.loadedName+"_path_"+h)}catch(d){if(!this.ignoreErrors)throw d;return this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${d}".`),this.compiledGlyphs[h]=function(u,g){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const d=[];for(const u of i){const g=void 0!==u.args?u.args.join(","):"";d.push("c.",u.cmd,"(",g,");\n")}return this.compiledGlyphs[h]=new Function("c","size",d.join(""))}return this.compiledGlyphs[h]=function(d,u){for(const g of i)"scale"===g.cmd&&(g.args=[u,-u]),d[g.cmd].apply(d,g.args)}}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=E(8),f=E(1),O=E(13),k=E(14),L=E(3);const i=4096,g=L.isNodeJS&&typeof Path2D>"u"?-1:1e3,a=16;class A{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,c,S){let P;return void 0!==this.cache[o]?(P=this.cache[o],this.canvasFactory.reset(P,c,S)):(P=this.canvasFactory.create(c,S),this.cache[o]=P),P}delete(o){delete this.cache[o]}clear(){for(const o in this.cache)this.canvasFactory.destroy(this.cache[o]),delete this.cache[o]}}function M(C,o,c,S,P,t,r,p,v,x){const[D,I,W,z,q,K]=(0,n.getCurrentTransform)(C);if(0===I&&0===W){const it=Math.round(r*D+q),ot=Math.round(p*z+K),ft=Math.abs(Math.round((r+v)*D+q)-it)||1,lt=Math.abs(Math.round((p+x)*z+K)-ot)||1;return C.setTransform(Math.sign(D),0,0,Math.sign(z),it,ot),C.drawImage(o,c,S,P,t,0,0,ft,lt),C.setTransform(D,I,W,z,q,K),[ft,lt]}if(0===D&&0===z){const it=Math.round(p*W+q),ot=Math.round(r*I+K),ft=Math.abs(Math.round((p+x)*W+q)-it)||1,lt=Math.abs(Math.round((r+v)*I+K)-ot)||1;return C.setTransform(0,Math.sign(I),Math.sign(W),0,it,ot),C.drawImage(o,c,S,P,t,0,0,lt,ft),C.setTransform(D,I,W,z,q,K),[lt,ft]}return C.drawImage(o,c,S,P,t,r,p,v,x),[Math.hypot(D,I)*v,Math.hypot(W,z)*x]}class F{constructor(o,c){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=f.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=f.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,o,c])}clone(){const o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,c){this.x=o,this.y=c}updatePathMinMax(o,c,S){[c,S]=f.Util.applyTransform([c,S],o),this.minX=Math.min(this.minX,c),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,c),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(o,c){const S=f.Util.applyTransform(c,o),P=f.Util.applyTransform(c.slice(2),o);this.minX=Math.min(this.minX,S[0],P[0]),this.minY=Math.min(this.minY,S[1],P[1]),this.maxX=Math.max(this.maxX,S[0],P[0]),this.maxY=Math.max(this.maxY,S[1],P[1])}updateScalingPathMinMax(o,c){f.Util.scaleMinMax(o,c),this.minX=Math.min(this.minX,c[0]),this.maxX=Math.max(this.maxX,c[1]),this.minY=Math.min(this.minY,c[2]),this.maxY=Math.max(this.maxY,c[3])}updateCurvePathMinMax(o,c,S,P,t,r,p,v,x,D){const I=f.Util.bezierBoundingBox(c,S,P,t,r,p,v,x);if(D)return D[0]=Math.min(D[0],I[0],I[2]),D[1]=Math.max(D[1],I[0],I[2]),D[2]=Math.min(D[2],I[1],I[3]),void(D[3]=Math.max(D[3],I[1],I[3]));this.updateRectMinMax(o,I)}getPathBoundingBox(o=O.PathType.FILL,c=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(o===O.PathType.STROKE){c||(0,f.unreachable)("Stroke bounding box must include transform.");const P=f.Util.singularValueDecompose2dScale(c),t=P[0]*this.lineWidth/2,r=P[1]*this.lineWidth/2;S[0]-=t,S[1]-=r,S[2]+=t,S[3]+=r}return S}updateClipFromPath(){const o=f.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=O.PathType.FILL,c=null){return f.Util.intersect(this.clipBox,this.getPathBoundingBox(o,c))}}function _(C,o,c=null){if(typeof ImageData<"u"&&o instanceof ImageData)return void C.putImageData(o,0,0);const S=o.height,P=o.width,t=S%a,r=(S-t)/a,p=0===t?r:r+1,v=C.createImageData(P,a);let D,x=0;const I=o.data,W=v.data;let z,q,K,et,J,st,it,at;if(c)switch(c.length){case 1:J=c[0],st=c[0],it=c[0],at=c[0];break;case 4:J=c[0],st=c[1],it=c[2],at=c[3]}if(o.kind===f.ImageKind.GRAYSCALE_1BPP){const ot=I.byteLength,nt=new Uint32Array(W.buffer,0,W.byteLength>>2),ft=nt.length,mt=P+7>>3;let lt=4294967295,ut=f.FeatureTest.isLittleEndian?4278190080:255;for(at&&255===at[0]&&0===at[255]&&([lt,ut]=[ut,lt]),z=0;z<p;z++){for(K=z<r?a:t,D=0,q=0;q<K;q++){const gt=ot-x;let St=0;const At=gt>mt?P:8*gt-7,Tt=-8&At;let _t=0,pt=0;for(;St<Tt;St+=8)pt=I[x++],nt[D++]=128&pt?lt:ut,nt[D++]=64&pt?lt:ut,nt[D++]=32&pt?lt:ut,nt[D++]=16&pt?lt:ut,nt[D++]=8&pt?lt:ut,nt[D++]=4&pt?lt:ut,nt[D++]=2&pt?lt:ut,nt[D++]=1&pt?lt:ut;for(;St<At;St++)0===_t&&(pt=I[x++],_t=128),nt[D++]=pt&_t?lt:ut,_t>>=1}for(;D<ft;)nt[D++]=0;C.putImageData(v,0,z*a)}}else if(o.kind===f.ImageKind.RGBA_32BPP){const ot=!!(J||st||it);for(q=0,et=P*a*4,z=0;z<r;z++){if(W.set(I.subarray(x,x+et)),x+=et,ot)for(let nt=0;nt<et;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,q),q+=a}if(z<p){if(et=P*t*4,W.set(I.subarray(x,x+et)),ot)for(let nt=0;nt<et;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,q)}}else{if(o.kind!==f.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${o.kind}`);{const ot=!!(J||st||it);for(K=a,et=P*K,z=0;z<p;z++){for(z>=r&&(K=t,et=P*K),D=0,q=et;q--;)W[D++]=I[x++],W[D++]=I[x++],W[D++]=I[x++],W[D++]=255;if(ot)for(let nt=0;nt<D;nt+=4)J&&(W[nt+0]=J[W[nt+0]]),st&&(W[nt+1]=st[W[nt+1]]),it&&(W[nt+2]=it[W[nt+2]]);C.putImageData(v,0,z*a)}}}}function s(C,o){if(o.bitmap)return void C.drawImage(o.bitmap,0,0);const c=o.height,S=o.width,P=c%a,t=(c-P)/a,r=0===P?t:t+1,p=C.createImageData(S,a);let v=0;const x=o.data,D=p.data;for(let I=0;I<r;I++){const W=I<t?a:P;({srcPos:v}=(0,k.applyMaskImageData)({src:x,srcPos:v,dest:D,width:S,height:W})),C.putImageData(p,0,I*a)}}function l(C,o){const c=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let S=0,P=c.length;S<P;S++){const t=c[S];void 0!==C[t]&&(o[t]=C[t])}void 0!==C.setLineDash&&(o.setLineDash(C.getLineDash()),o.lineDashOffset=C.lineDashOffset)}function b(C,o){C.strokeStyle=C.fillStyle=o||"#000000",C.fillRule="nonzero",C.globalAlpha=1,C.lineWidth=1,C.lineCap="butt",C.lineJoin="miter",C.miterLimit=10,C.globalCompositeOperation="source-over",C.font="10px sans-serif",void 0!==C.setLineDash&&(C.setLineDash([]),C.lineDashOffset=0)}function w(C,o,c,S){const P=C.length;for(let t=3;t<P;t+=4){const r=C[t];if(0===r)C[t-3]=o,C[t-2]=c,C[t-1]=S;else if(r<255){const p=255-r;C[t-3]=C[t-3]*r+o*p>>8,C[t-2]=C[t-2]*r+c*p>>8,C[t-1]=C[t-1]*r+S*p>>8}}}function R(C,o,c){const S=C.length;for(let t=3;t<S;t+=4)o[t]=o[t]*(c?c[C[t]]:C[t])*.00392156862745098|0}function j(C,o,c){const S=C.length;for(let P=3;P<S;P+=4){const t=77*C[P-3]+152*C[P-2]+28*C[P-1];o[P]=c?o[P]*c[t>>8]>>8:o[P]*t>>16}}function Z(C,o){const c=f.Util.singularValueDecompose2dScale(C);c[0]=Math.fround(c[0]),c[1]=Math.fround(c[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*n.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==o?o:c[0]<=S||c[1]<=S}const Y=["butt","round","square"],V=["miter","round","bevel"],U={},B={};class X{constructor(o,c,S,P,t,r,p,v){this.ctx=o,this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=c,this.objs=S,this.canvasFactory=P,this.imageLayer=t,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=r,this.cachedCanvases=new A(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=p,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=v?.background||null,this.foregroundColor=v?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,c=null){return"string"==typeof o?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):c}beginDrawing({transform:o,viewport:c,transparency:S=!1,background:P=null}){const t=this.ctx.canvas.width,r=this.ctx.canvas.height,p=P||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const v=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const x=this.backgroundColor=this.ctx.fillStyle;let D=!0,I=p;if(this.ctx.fillStyle=p,I=this.ctx.fillStyle,D="string"==typeof I&&/^#[0-9A-Fa-f]{6}$/.test(I),"#000000"===v&&"#ffffff"===x||v===x||!D)this.foregroundColor=this.backgroundColor=null;else{const[W,z,q]=(0,n.getRGB)(I),K=J=>(J/=255)<=.03928?J/12.92:((J+.055)/1.055)**2.4,et=Math.round(.2126*K(W)+.7152*K(z)+.0722*K(q));this.selectColor=(J,st,it)=>{const at=.2126*K(J)+.7152*K(st)+.0722*K(it);return Math.round(at)===et?x:v}}}if(this.ctx.fillStyle=this.backgroundColor||p,this.ctx.fillRect(0,0,t,r),this.ctx.restore(),S){const v=this.cachedCanvases.getCanvas("transparent",t,r);this.compositeCtx=this.ctx,this.transparentCanvas=v.canvas,this.ctx=v.context,this.ctx.save(),this.ctx.transform(...(0,n.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),b(this.ctx,this.foregroundColor),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...c.transform),this.viewportScale=c.scale,this.baseTransform=(0,n.getCurrentTransform)(this.ctx),this.imageLayer&&((0,n.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(o,c,S,P){const t=o.argsArray,r=o.fnArray;let p=c||0;const v=t.length;if(v===p)return p;const x=v-p>10&&"function"==typeof S,D=x?Date.now()+15:0;let I=0;const W=this.commonObjs,z=this.objs;let q;for(;;){if(void 0!==P&&p===P.nextBreakPoint)return P.breakIt(p,S),p;if(q=r[p],q!==f.OPS.dependency)this[q].apply(this,t[p]);else for(const K of t[p]){const et=K.startsWith("g_")?W:z;if(!et.has(K))return et.get(K,S),p}if(p++,p===v)return p;if(x&&++I>10){if(Date.now()>D)return S(),p;I=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const o of this._cachedBitmapsMap.values()){for(const c of o.values())typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement&&(c.width=c.height=0);o.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(o,c){const S=o.width,P=o.height;let D,I,t=Math.max(Math.hypot(c[0],c[1]),1),r=Math.max(Math.hypot(c[2],c[3]),1),p=S,v=P,x="prescale1";for(;t>2&&p>1||r>2&&v>1;){let W=p,z=v;t>2&&p>1&&(W=Math.ceil(p/2),t/=p/W),r>2&&v>1&&(z=Math.ceil(v/2),r/=v/z),D=this.cachedCanvases.getCanvas(x,W,z),I=D.context,I.clearRect(0,0,W,z),I.drawImage(o,0,0,p,v,0,0,W,z),o=D.canvas,p=W,v=z,x="prescale1"===x?"prescale2":"prescale1"}return{img:o,paintWidth:p,paintHeight:v}}_createMaskCanvas(o){const c=this.ctx,{width:S,height:P}=o,t=this.current.fillColor,r=this.current.patternFill,p=(0,n.getCurrentTransform)(c);let v,x,D,I;if((o.bitmap||o.data)&&o.count>1){const ft=o.bitmap||o.data.buffer,mt=p.slice(0,4);x=JSON.stringify(r?mt:[mt,t]),v=this._cachedBitmapsMap.get(ft),v||(v=new Map,this._cachedBitmapsMap.set(ft,v));const lt=v.get(x);if(lt&&!r)return{canvas:lt,offsetX:Math.round(Math.min(p[0],p[2])+p[4]),offsetY:Math.round(Math.min(p[1],p[3])+p[5])};D=lt}D||(I=this.cachedCanvases.getCanvas("maskCanvas",S,P),s(I.context,o));let W=f.Util.transform(p,[1/S,0,0,-1/P,0,0]);W=f.Util.transform(W,[1,0,0,1,0,-P]);const z=f.Util.applyTransform([0,0],W),q=f.Util.applyTransform([S,P],W),K=f.Util.normalizeRect([z[0],z[1],q[0],q[1]]),et=Math.round(K[2]-K[0])||1,J=Math.round(K[3]-K[1])||1,st=this.cachedCanvases.getCanvas("fillCanvas",et,J),it=st.context,at=Math.min(z[0],q[0]),ot=Math.min(z[1],q[1]);it.translate(-at,-ot),it.transform(...W),D||(D=this._scaleImage(I.canvas,(0,n.getCurrentTransformInverse)(it)),D=D.img,v&&r&&v.set(x,D)),it.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(it),o.interpolate),M(it,D,0,0,D.width,D.height,0,0,S,P),it.globalCompositeOperation="source-in";const nt=f.Util.transform((0,n.getCurrentTransformInverse)(it),[1,0,0,1,-at,-ot]);return it.fillStyle=r?t.getPattern(c,this,nt,O.PathType.FILL):t,it.fillRect(0,0,S,P),v&&!r&&(this.cachedCanvases.delete("fillCanvas"),v.set(x,st.canvas)),{canvas:st.canvas,offsetX:Math.round(at),offsetY:Math.round(ot)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=Y[o]}setLineJoin(o){this.ctx.lineJoin=V[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,c){const S=this.ctx;void 0!==S.setLineDash&&(S.setLineDash(o),S.lineDashOffset=c)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let c=0,S=o.length;c<S;c++){const P=o[c],r=P[1];switch(P[0]){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=P[1];break;case"ca":this.current.fillAlpha=P[1],this.ctx.globalAlpha=P[1];break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=r}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const P=this.cachedCanvases.getCanvas("smaskGroupAt"+this.groupLevel,this.ctx.canvas.width,this.ctx.canvas.height);this.suspendedCtx=this.ctx,this.ctx=P.context;const t=this.ctx;t.setTransform(...(0,n.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,t),function m(C,o){if(C._removeMirroring)throw new Error("Context is already forwarding operations.");C.__originalSave=C.save,C.__originalRestore=C.restore,C.__originalRotate=C.rotate,C.__originalScale=C.scale,C.__originalTranslate=C.translate,C.__originalTransform=C.transform,C.__originalSetTransform=C.setTransform,C.__originalResetTransform=C.resetTransform,C.__originalClip=C.clip,C.__originalMoveTo=C.moveTo,C.__originalLineTo=C.lineTo,C.__originalBezierCurveTo=C.bezierCurveTo,C.__originalRect=C.rect,C.__originalClosePath=C.closePath,C.__originalBeginPath=C.beginPath,C._removeMirroring=()=>{C.save=C.__originalSave,C.restore=C.__originalRestore,C.rotate=C.__originalRotate,C.scale=C.__originalScale,C.translate=C.__originalTranslate,C.transform=C.__originalTransform,C.setTransform=C.__originalSetTransform,C.resetTransform=C.__originalResetTransform,C.clip=C.__originalClip,C.moveTo=C.__originalMoveTo,C.lineTo=C.__originalLineTo,C.bezierCurveTo=C.__originalBezierCurveTo,C.rect=C.__originalRect,C.closePath=C.__originalClosePath,C.beginPath=C.__originalBeginPath,delete C._removeMirroring},C.save=function(){o.save(),this.__originalSave()},C.restore=function(){o.restore(),this.__originalRestore()},C.translate=function(S,P){o.translate(S,P),this.__originalTranslate(S,P)},C.scale=function(S,P){o.scale(S,P),this.__originalScale(S,P)},C.transform=function(S,P,t,r,p,v){o.transform(S,P,t,r,p,v),this.__originalTransform(S,P,t,r,p,v)},C.setTransform=function(S,P,t,r,p,v){o.setTransform(S,P,t,r,p,v),this.__originalSetTransform(S,P,t,r,p,v)},C.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},C.rotate=function(S){o.rotate(S),this.__originalRotate(S)},C.clip=function(S){o.clip(S),this.__originalClip(S)},C.moveTo=function(c,S){o.moveTo(c,S),this.__originalMoveTo(c,S)},C.lineTo=function(c,S){o.lineTo(c,S),this.__originalLineTo(c,S)},C.bezierCurveTo=function(c,S,P,t,r,p){o.bezierCurveTo(c,S,P,t,r,p),this.__originalBezierCurveTo(c,S,P,t,r,p)},C.rect=function(c,S,P,t){o.rect(c,S,P,t),this.__originalRect(c,S,P,t)},C.closePath=function(){o.closePath(),this.__originalClosePath()},C.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}(t,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){this.current.activeSMask&&(o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height],function tt(C,o,c,S){const P=S[0],t=S[1],r=S[2]-P,p=S[3]-t;0===r||0===p||(function N(C,o,c,S,P,t,r,p,v,x,D){const I=!!t,W=I?t[0]:0,z=I?t[1]:0,q=I?t[2]:0;let K;K="Luminosity"===P?j:R;const J=Math.min(S,Math.ceil(1048576/c));for(let st=0;st<S;st+=J){const it=Math.min(J,S-st),at=C.getImageData(p-x,st+(v-D),c,it),ot=o.getImageData(p,st+v,c,it);I&&w(at.data,W,z,q),K(at.data,ot.data,r),o.putImageData(ot,p,st+v)}}(o.context,c,r,p,o.subtype,o.backdrop,o.transferMap,P,t,o.offsetX,o.offsetY),C.save(),C.globalAlpha=1,C.globalCompositeOperation="source-over",C.setTransform(1,0,0,1,0,0),C.drawImage(c.canvas,0,0),C.restore())}(this.suspendedCtx,this.current.activeSMask,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore())}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(o,c,S,P,t,r){this.ctx.transform(o,c,S,P,t,r),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(o,c,S){const P=this.ctx,t=this.current;let v,x,r=t.x,p=t.y;const D=(0,n.getCurrentTransform)(P),I=0===D[0]&&0===D[3]||0===D[1]&&0===D[2],W=I?S.slice(0):null;for(let z=0,q=0,K=o.length;z<K;z++)switch(0|o[z]){case f.OPS.rectangle:r=c[q++],p=c[q++];const et=c[q++],J=c[q++],st=r+et,it=p+J;P.moveTo(r,p),0===et||0===J?P.lineTo(st,it):(P.lineTo(st,p),P.lineTo(st,it),P.lineTo(r,it)),I||t.updateRectMinMax(D,[r,p,st,it]),P.closePath();break;case f.OPS.moveTo:r=c[q++],p=c[q++],P.moveTo(r,p),I||t.updatePathMinMax(D,r,p);break;case f.OPS.lineTo:r=c[q++],p=c[q++],P.lineTo(r,p),I||t.updatePathMinMax(D,r,p);break;case f.OPS.curveTo:v=r,x=p,r=c[q+4],p=c[q+5],P.bezierCurveTo(c[q],c[q+1],c[q+2],c[q+3],r,p),t.updateCurvePathMinMax(D,v,x,c[q],c[q+1],c[q+2],c[q+3],r,p,W),q+=6;break;case f.OPS.curveTo2:v=r,x=p,P.bezierCurveTo(r,p,c[q],c[q+1],c[q+2],c[q+3]),t.updateCurvePathMinMax(D,v,x,r,p,c[q],c[q+1],c[q+2],c[q+3],W),r=c[q+2],p=c[q+3],q+=4;break;case f.OPS.curveTo3:v=r,x=p,r=c[q+2],p=c[q+3],P.bezierCurveTo(c[q],c[q+1],r,p,r,p),t.updateCurvePathMinMax(D,v,x,c[q],c[q+1],r,p,r,p,W),q+=4;break;case f.OPS.closePath:P.closePath()}I&&t.updateScalingPathMinMax(D,W),t.setCurrentPoint(r,p)}closePath(){this.ctx.closePath()}stroke(o){o=!(typeof o<"u")||o;const c=this.ctx,S=this.current.strokeColor;c.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof S&&S?.getPattern?(c.save(),c.strokeStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.STROKE),this.rescaleAndStroke(!1),c.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),c.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o){o=!(typeof o<"u")||o;const c=this.ctx,S=this.current.fillColor;let t=!1;this.current.patternFill&&(c.save(),c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.FILL),t=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(c.fill("evenodd"),this.pendingEOFill=!1):c.fill()),t&&c.restore(),o&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=U}eoClip(){this.pendingClip=B}beginText(){this.current.textMatrix=f.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const o=this.pendingTextPaths,c=this.ctx;if(void 0!==o){c.save(),c.beginPath();for(const S of o)c.setTransform(...S.transform),c.translate(S.x,S.y),S.addToPath(c,S.fontSize);c.restore(),c.clip(),c.beginPath(),delete this.pendingTextPaths}else c.beginPath()}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,c){const S=this.commonObjs.get(o),P=this.current;if(!S)throw new Error(`Can't find font for ${o}`);if(P.fontMatrix=S.fontMatrix||f.FONT_IDENTITY_MATRIX,(0===P.fontMatrix[0]||0===P.fontMatrix[3])&&(0,f.warn)("Invalid font matrix for font "+o),c<0?(c=-c,P.fontDirection=-1):P.fontDirection=1,this.current.font=S,this.current.fontSize=c,S.isType3Font)return;let r="normal";S.black?r="900":S.bold&&(r="bold");const p=S.italic?"italic":"normal",v=`"${S.loadedName||"sans-serif"}", ${S.fallbackName}`;let x=c;c<16?x=16:c>100&&(x=100),this.current.fontSizeScale=c/x,this.ctx.font=`${p} ${r} ${x}px ${v}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,c){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=c}setLeadingMoveText(o,c){this.setLeading(-c),this.moveText(o,c)}setTextMatrix(o,c,S,P,t,r){this.current.textMatrix=[o,c,S,P,t,r],this.current.textMatrixScale=Math.hypot(o,c),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,c,S,P){const t=this.ctx,r=this.current,p=r.font,v=r.textRenderingMode,x=r.fontSize/r.fontSizeScale,D=v&f.TextRenderingMode.FILL_STROKE_MASK,I=!!(v&f.TextRenderingMode.ADD_TO_PATH_FLAG),W=r.patternFill&&!p.missingFile;let z;(p.disableFontFace||I||W)&&(z=p.getPathGenerator(this.commonObjs,o)),p.disableFontFace||W?(t.save(),t.translate(c,S),t.beginPath(),z(t,x),P&&t.setTransform(...P),(D===f.TextRenderingMode.FILL||D===f.TextRenderingMode.FILL_STROKE)&&t.fill(),(D===f.TextRenderingMode.STROKE||D===f.TextRenderingMode.FILL_STROKE)&&t.stroke(),t.restore()):((D===f.TextRenderingMode.FILL||D===f.TextRenderingMode.FILL_STROKE)&&t.fillText(o,c,S),(D===f.TextRenderingMode.STROKE||D===f.TextRenderingMode.FILL_STROKE)&&t.strokeText(o,c,S)),I&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,n.getCurrentTransform)(t),x:c,y:S,fontSize:x,addToPath:z})}get isFontSubpixelAAEnabled(){const{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);const c=o.getImageData(0,0,10,10).data;let S=!1;for(let P=3;P<c.length;P+=4)if(c[P]>0&&c[P]<255){S=!0;break}return(0,f.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(o){const c=this.current,S=c.font;if(S.isType3Font)return this.showType3Text(o);const P=c.fontSize;if(0===P)return;const t=this.ctx,r=c.fontSizeScale,p=c.charSpacing,v=c.wordSpacing,x=c.fontDirection,D=c.textHScale*x,I=o.length,W=S.vertical,z=W?1:-1,q=S.defaultVMetrics,K=P*c.fontMatrix[0],et=c.textRenderingMode===f.TextRenderingMode.FILL&&!S.disableFontFace&&!c.patternFill;let J;if(t.save(),t.transform(...c.textMatrix),t.translate(c.x,c.y+c.textRise),t.scale(D,x>0?-1:1),c.patternFill){t.save();const nt=c.fillColor.getPattern(t,this,(0,n.getCurrentTransformInverse)(t),O.PathType.FILL);J=(0,n.getCurrentTransform)(t),t.restore(),t.fillStyle=nt}let st=c.lineWidth;const it=c.textMatrixScale;if(0===it||0===st){const nt=c.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;(nt===f.TextRenderingMode.STROKE||nt===f.TextRenderingMode.FILL_STROKE)&&(st=this.getSinglePixelWidth())}else st/=it;1!==r&&(t.scale(r,r),st/=r),t.lineWidth=st;let ot,at=0;for(ot=0;ot<I;++ot){const nt=o[ot];if("number"==typeof nt){at+=z*nt*P/1e3;continue}let ft=!1;const mt=(nt.isSpace?v:0)+p,lt=nt.fontChar,ut=nt.accent;let gt,St,Tt,At=nt.width;if(W){const _t=nt.vmetric||q,pt=-(nt.vmetric?_t[1]:.5*At)*K;At=_t?-_t[0]:At,gt=pt/r,St=(at+_t[2]*K)/r}else gt=at/r,St=0;if(S.remeasure&&At>0){const _t=1e3*t.measureText(lt).width/P*r;if(At<_t&&this.isFontSubpixelAAEnabled){const pt=At/_t;ft=!0,t.save(),t.scale(pt,1),gt/=pt}else At!==_t&&(gt+=(At-_t)/2e3*P/r)}this.contentVisible&&(nt.isInFont||S.missingFile)&&(et&&!ut?t.fillText(lt,gt,St):(this.paintChar(lt,gt,St,J),ut&&this.paintChar(ut.fontChar,gt+P*ut.offset.x/r,St-P*ut.offset.y/r,J))),Tt=W?At*K-mt*x:At*K+mt*x,at+=Tt,ft&&t.restore()}W?c.y-=at:c.x+=at*D,t.restore(),this.compose()}showType3Text(o){const c=this.ctx,S=this.current,P=S.font,t=S.fontSize,r=S.fontDirection,p=P.vertical?1:-1,v=S.charSpacing,x=S.wordSpacing,D=S.textHScale*r,I=S.fontMatrix||f.FONT_IDENTITY_MATRIX,W=o.length;let q,K,et,J;if(S.textRenderingMode!==f.TextRenderingMode.INVISIBLE&&0!==t){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,c.save(),c.transform(...S.textMatrix),c.translate(S.x,S.y),c.scale(D,r),q=0;q<W;++q){if(K=o[q],"number"==typeof K){J=p*K*t/1e3,this.ctx.translate(J,0),S.x+=J*D;continue}const st=(K.isSpace?x:0)+v,it=P.charProcOperatorList[K.operatorListId];it?(this.contentVisible&&(this.processingType3=K,this.save(),c.scale(t,t),c.transform(...I),this.executeOperatorList(it),this.restore()),et=f.Util.applyTransform([K.width,0],I)[0]*t+st,c.translate(et,0),S.x+=et*D):(0,f.warn)(`Type3 character "${K.operatorListId}" is not available.`)}c.restore(),this.processingType3=null}}setCharWidth(o,c){}setCharWidthAndBounds(o,c,S,P,t,r){this.ctx.rect(S,P,t-S,r-P),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let c;if("TilingPattern"===o[0]){const S=o[1],P=this.baseTransform||(0,n.getCurrentTransform)(this.ctx);c=new O.TilingPattern(o,S,this.ctx,{createCanvasGraphics:r=>new X(r,this.commonObjs,this.objs,this.canvasFactory)},P)}else c=this._getPattern(o[1],o[2]);return c}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,c,S){const P=this.selectColor?.(o,c,S)||f.Util.makeHexColor(o,c,S);this.ctx.strokeStyle=P,this.current.strokeColor=P}setFillRGBColor(o,c,S){const P=this.selectColor?.(o,c,S)||f.Util.makeHexColor(o,c,S);this.ctx.fillStyle=P,this.current.fillColor=P,this.current.patternFill=!1}_getPattern(o,c=null){let S;return this.cachedPatterns.has(o)?S=this.cachedPatterns.get(o):(S=(0,O.getShadingPattern)(this.objs.get(o)),this.cachedPatterns.set(o,S)),c&&(S.matrix=c),S}shadingFill(o){if(!this.contentVisible)return;const c=this.ctx;this.save();const S=this._getPattern(o);c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.SHADING);const P=(0,n.getCurrentTransformInverse)(c);if(P){const t=c.canvas,r=t.width,p=t.height,v=f.Util.applyTransform([0,0],P),x=f.Util.applyTransform([0,p],P),D=f.Util.applyTransform([r,0],P),I=f.Util.applyTransform([r,p],P),W=Math.min(v[0],x[0],D[0],I[0]),z=Math.min(v[1],x[1],D[1],I[1]),q=Math.max(v[0],x[0],D[0],I[0]),K=Math.max(v[1],x[1],D[1],I[1]);this.ctx.fillRect(W,z,q-W,K-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,f.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,f.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,c){this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&6===o.length&&this.transform(...o),this.baseTransform=(0,n.getCurrentTransform)(this.ctx),c)&&(this.ctx.rect(c[0],c[1],c[2]-c[0],c[3]-c[1]),this.current.updateRectMinMax((0,n.getCurrentTransform)(this.ctx),c),this.clip(),this.endPath())}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const c=this.ctx;o.isolated||(0,f.info)("TODO: Support non-isolated groups."),o.knockout&&(0,f.warn)("Knockout groups not supported.");const S=(0,n.getCurrentTransform)(c);if(o.matrix&&c.transform(...o.matrix),!o.bbox)throw new Error("Bounding box is required.");let P=f.Util.getAxialAlignedBoundingBox(o.bbox,(0,n.getCurrentTransform)(c));P=f.Util.intersect(P,[0,0,c.canvas.width,c.canvas.height])||[0,0,0,0];const r=Math.floor(P[0]),p=Math.floor(P[1]);let v=Math.max(Math.ceil(P[2])-r,1),x=Math.max(Math.ceil(P[3])-p,1),D=1,I=1;v>i&&(D=v/i,v=i),x>i&&(I=x/i,x=i),this.current.startNewPathAndClipBox([0,0,v,x]);let W="groupAt"+this.groupLevel;o.smask&&(W+="_smask_"+this.smaskCounter++%2);const z=this.cachedCanvases.getCanvas(W,v,x),q=z.context;q.scale(1/D,1/I),q.translate(-r,-p),q.transform(...S),o.smask?this.smaskStack.push({canvas:z.canvas,context:q,offsetX:r,offsetY:p,scaleX:D,scaleY:I,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(c.setTransform(1,0,0,1,0,0),c.translate(r,p),c.scale(D,I),c.save()),l(c,q),this.ctx=q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;const c=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const P=(0,n.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...P);const t=f.Util.getAxialAlignedBoundingBox([0,0,c.canvas.width,c.canvas.height],P);this.ctx.drawImage(c.canvas,0,0),this.ctx.restore(),this.compose(t)}}beginAnnotation(o,c,S,P,t){if(this.#t(),b(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(c)&&4===c.length){const r=c[2]-c[0],p=c[3]-c[1];if(t&&this.annotationCanvasMap){(S=S.slice())[4]-=c[0],S[5]-=c[1],(c=c.slice())[0]=c[1]=0,c[2]=r,c[3]=p;const[v,x]=f.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(this.ctx)),{viewportScale:D}=this,I=Math.ceil(r*this.outputScaleX*D),W=Math.ceil(p*this.outputScaleY*D);this.annotationCanvas=this.canvasFactory.create(I,W);const{canvas:z,context:q}=this.annotationCanvas;this.annotationCanvasMap.set(o,z),this.annotationCanvas.savedCtx=this.ctx,this.ctx=q,this.ctx.setTransform(v,0,0,-x,0,p*x),b(this.ctx,this.foregroundColor)}else b(this.ctx,this.foregroundColor),this.ctx.rect(c[0],c[1],r,p),this.ctx.clip(),this.endPath()}this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;const c=o.count;(o=this.getObject(o.data,o)).count=c;const S=this.ctx,P=this.processingType3;if(P&&(void 0===P.compiled&&(P.compiled=function T(C){const{width:o,height:c}=C;if(o>g||c>g)return null;const P=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),t=o+1;let p,v,x,r=new Uint8Array(t*(c+1));const D=o+7&-8;let I=new Uint8Array(D*c),W=0;for(const J of C.data){let st=128;for(;st>0;)I[W++]=J&st?0:255,st>>=1}let z=0;for(W=0,0!==I[W]&&(r[0]=1,++z),v=1;v<o;v++)I[W]!==I[W+1]&&(r[v]=I[W]?2:1,++z),W++;for(0!==I[W]&&(r[v]=2,++z),p=1;p<c;p++){W=p*D,x=p*t,I[W-D]!==I[W]&&(r[x]=I[W]?1:8,++z);let J=(I[W]?4:0)+(I[W-D]?8:0);for(v=1;v<o;v++)J=(J>>2)+(I[W+1]?4:0)+(I[W-D+1]?8:0),P[J]&&(r[x+v]=P[J],++z),W++;if(I[W-D]!==I[W]&&(r[x+v]=I[W]?2:4,++z),z>1e3)return null}for(W=D*(c-1),x=p*t,0!==I[W]&&(r[x]=8,++z),v=1;v<o;v++)I[W]!==I[W+1]&&(r[x+v]=I[W]?4:8,++z),W++;if(0!==I[W]&&(r[x+v]=4,++z),z>1e3)return null;const q=new Int32Array([0,t,-1,0,-t,0,0,0,1]),K=new Path2D;for(p=0;z&&p<=c;p++){let J=p*t;const st=J+o;for(;J<st&&!r[J];)J++;if(J===st)continue;K.moveTo(J%t,p);const it=J;let at=r[J];do{const ot=q[at];do{J+=ot}while(!r[J]);const nt=r[J];5!==nt&&10!==nt?(at=nt,r[J]=0):(at=nt&51*at>>4,r[J]&=at>>2|at<<2),K.lineTo(J%t,J/t|0),r[J]||--z}while(it!==J);--p}return I=null,r=null,function(J){J.save(),J.scale(1/o,-1/c),J.translate(0,-c),J.fill(K),J.beginPath(),J.restore()}}(o)),P.compiled))return void P.compiled(S);const t=this._createMaskCanvas(o),r=t.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(r,t.offsetX,t.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(o,c,S=0,P=0,t,r){if(!this.contentVisible)return;o=this.getObject(o.data,o);const p=this.ctx;p.save();const v=(0,n.getCurrentTransform)(p);p.transform(c,S,P,t,0,0);const x=this._createMaskCanvas(o);p.setTransform(1,0,0,1,0,0);for(let D=0,I=r.length;D<I;D+=2){const W=f.Util.transform(v,[c,S,P,t,r[D],r[D+1]]),[z,q]=f.Util.applyTransform([0,0],W);p.drawImage(x.canvas,z,q)}p.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;const c=this.ctx,S=this.current.fillColor,P=this.current.patternFill;for(const t of o){const{data:r,width:p,height:v,transform:x}=t,D=this.cachedCanvases.getCanvas("maskCanvas",p,v),I=D.context;I.save(),s(I,this.getObject(r,t)),I.globalCompositeOperation="source-in",I.fillStyle=P?S.getPattern(I,this,(0,n.getCurrentTransformInverse)(c),O.PathType.FILL):S,I.fillRect(0,0,p,v),I.restore(),c.save(),c.transform(...x),c.scale(1,-1),M(c,D.canvas,0,0,p,v,0,-1,1,1),c.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;const c=this.getObject(o);c?this.paintInlineImageXObject(c):(0,f.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(o,c,S,P){if(!this.contentVisible)return;const t=this.getObject(o);if(!t)return void(0,f.warn)("Dependent image isn't ready yet");const r=t.width,p=t.height,v=[];for(let x=0,D=P.length;x<D;x+=2)v.push({transform:[c,0,0,S,P[x],P[x+1]],x:0,y:0,w:r,h:p});this.paintInlineImageXObjectGroup(t,v)}paintInlineImageXObject(o){if(!this.contentVisible)return;const c=o.width,S=o.height,P=this.ctx;let t;if(this.save(),P.scale(1/c,-1/S),"function"==typeof HTMLElement&&o instanceof HTMLElement||!o.data)t=o;else{const x=this.cachedCanvases.getCanvas("inlineImage",c,S);_(x.context,o,this.current.transferMaps),t=x.canvas}const r=this._scaleImage(t,(0,n.getCurrentTransformInverse)(P));P.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(P),o.interpolate);const[p,v]=M(P,r.img,0,0,r.paintWidth,r.paintHeight,0,-S,c,S);if(this.imageLayer){const[x,D]=f.Util.applyTransform([0,-S],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:o,left:x,top:D,width:p,height:v})}this.compose(),this.restore()}paintInlineImageXObjectGroup(o,c){if(!this.contentVisible)return;const S=this.ctx,P=o.width,t=o.height,r=this.cachedCanvases.getCanvas("inlineImage",P,t);_(r.context,o,this.current.transferMaps);for(const v of c){if(S.save(),S.transform(...v.transform),S.scale(1,-1),M(S,r.canvas,v.x,v.y,v.w,v.h,0,-1,1,1),this.imageLayer){const[x,D]=f.Util.applyTransform([v.x,v.y],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:o,left:x,top:D,width:P,height:t})}S.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,c){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,c){this.markedContentStack.push("OC"===o?{visible:this.optionalContentConfig.isVisible(c)}:{visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){const c=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);const S=this.ctx;this.pendingClip&&(c||(this.pendingClip===B?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const o=(0,n.getCurrentTransform)(this.ctx);if(0===o[1]&&0===o[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{const c=Math.abs(o[0]*o[3]-o[2]*o[1]),S=Math.hypot(o[0],o[2]),P=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(S,P)/c}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:o}=this.current,c=(0,n.getCurrentTransform)(this.ctx);let S,P;if(0===c[1]&&0===c[2]){const t=Math.abs(c[0]),r=Math.abs(c[3]);if(0===o)S=1/t,P=1/r;else{const p=t*o,v=r*o;S=p<1?1/p:1,P=v<1?1/v:1}}else{const t=Math.abs(c[0]*c[3]-c[2]*c[1]),r=Math.hypot(c[0],c[1]),p=Math.hypot(c[2],c[3]);if(0===o)S=p/t,P=r/t;else{const v=o*t;S=p>v?p/v:1,P=r>v?r/v:1}}this._cachedScaleForStroking=[S,P]}return this._cachedScaleForStroking}rescaleAndStroke(o){const{ctx:c}=this,{lineWidth:S}=this.current,[P,t]=this.getScaleForStroking();if(c.lineWidth=S||1,1===P&&1===t)return void c.stroke();let r,p,v;o&&(r=(0,n.getCurrentTransform)(c),p=c.getLineDash().slice(),v=c.lineDashOffset),c.scale(P,t);const x=Math.max(P,t);c.setLineDash(c.getLineDash().map(D=>D/x)),c.lineDashOffset/=x,c.stroke(),o&&(c.setTransform(...r),c.setLineDash(p),c.lineDashOffset=v)}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}}e.CanvasGraphics=X;for(const C in f.OPS)void 0!==X.prototype[C]&&(X.prototype[f.OPS[C]]=X.prototype[C])},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=function a(M){switch(M[0]){case"RadialAxial":return new h(M);case"Mesh":return new u(M);case"Dummy":return new g}throw new Error(`Unknown IR type: ${M[0]}`)};var n=E(1),f=E(8),O=E(3);const k={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function L(M,T){if(!T||O.isNodeJS)return;const F=T[2]-T[0],_=T[3]-T[1],s=new Path2D;s.rect(T[0],T[1],F,_),M.clip(s)}e.PathType=k;class y{constructor(){this.constructor===y&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends y{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let F;"axial"===this._type?F=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(F=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const _ of this._colorStops)F.addColorStop(_[0],_[1]);return F}getPattern(T,F,_,s){let l;if(s===k.STROKE||s===k.FILL){const b=F.current.getClippedPathBoundingBox(s,(0,f.getCurrentTransform)(T))||[0,0,0,0],w=Math.ceil(b[2]-b[0])||1,R=Math.ceil(b[3]-b[1])||1,j=F.cachedCanvases.getCanvas("pattern",w,R,!0),N=j.context;N.clearRect(0,0,N.canvas.width,N.canvas.height),N.beginPath(),N.rect(0,0,N.canvas.width,N.canvas.height),N.translate(-b[0],-b[1]),_=n.Util.transform(_,[1,0,0,1,b[0],b[1]]),N.transform(...F.baseTransform),this.matrix&&N.transform(...this.matrix),L(N,this._bbox),N.fillStyle=this._createGradient(N),N.fill(),l=T.createPattern(j.canvas,"no-repeat");const tt=new DOMMatrix(_);try{l.setTransform(tt)}catch(Z){(0,n.warn)(`RadialAxialShadingPattern.getPattern: "${Z?.message}".`)}}else L(T,this._bbox),l=this._createGradient(T);return l}}function i(M,T,F,_,s,l,b,w){const R=T.coords,j=T.colors,N=M.data,tt=4*M.width;let Z;R[F+1]>R[_+1]&&(Z=F,F=_,_=Z,Z=l,l=b,b=Z),R[_+1]>R[s+1]&&(Z=_,_=s,s=Z,Z=b,b=w,w=Z),R[F+1]>R[_+1]&&(Z=F,F=_,_=Z,Z=l,l=b,b=Z);const Y=(R[F]+T.offsetX)*T.scaleX,V=(R[F+1]+T.offsetY)*T.scaleY,U=(R[_]+T.offsetX)*T.scaleX,B=(R[_+1]+T.offsetY)*T.scaleY,X=(R[s]+T.offsetX)*T.scaleX,C=(R[s+1]+T.offsetY)*T.scaleY;if(V>=C)return;const o=j[l],c=j[l+1],S=j[l+2],P=j[b],t=j[b+1],r=j[b+2],p=j[w],v=j[w+1],x=j[w+2],D=Math.round(V),I=Math.round(C);let W,z,q,K,et,J,st,it;for(let at=D;at<=I;at++){if(at<B){let lt;lt=at<V?0:(V-at)/(V-B),W=Y-(Y-U)*lt,z=o-(o-P)*lt,q=c-(c-t)*lt,K=S-(S-r)*lt}else{let lt;lt=at>C?1:B===C?0:(B-at)/(B-C),W=U-(U-X)*lt,z=P-(P-p)*lt,q=t-(t-v)*lt,K=r-(r-x)*lt}let ot;ot=at<V?0:at>C?1:(V-at)/(V-C),et=Y-(Y-X)*ot,J=o-(o-p)*ot,st=c-(c-v)*ot,it=S-(S-x)*ot;const nt=Math.round(Math.min(W,et)),ft=Math.round(Math.max(W,et));let mt=tt*at+4*nt;for(let lt=nt;lt<=ft;lt++)ot=(W-lt)/(W-et),ot<0?ot=0:ot>1&&(ot=1),N[mt++]=z-(z-J)*ot|0,N[mt++]=q-(q-st)*ot|0,N[mt++]=K-(K-it)*ot|0,N[mt++]=255}}function d(M,T,F){const _=T.coords,s=T.colors;let l,b;switch(T.type){case"lattice":const w=T.verticesPerRow,R=Math.floor(_.length/w)-1,j=w-1;for(l=0;l<R;l++){let N=l*w;for(let tt=0;tt<j;tt++,N++)i(M,F,_[N],_[N+1],_[N+w],s[N],s[N+1],s[N+w]),i(M,F,_[N+w+1],_[N+1],_[N+w],s[N+w+1],s[N+1],s[N+w])}break;case"triangles":for(l=0,b=_.length;l<b;l+=3)i(M,F,_[l],_[l+1],_[l+2],s[l],s[l+1],s[l+2]);break;default:throw new Error("illegal figure")}}class u extends y{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,F,_){const w=Math.floor(this._bounds[0]),R=Math.floor(this._bounds[1]),j=Math.ceil(this._bounds[2])-w,N=Math.ceil(this._bounds[3])-R,tt=Math.min(Math.ceil(Math.abs(j*T[0]*1.1)),3e3),Z=Math.min(Math.ceil(Math.abs(N*T[1]*1.1)),3e3),Y=j/tt,V=N/Z,U={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-R,scaleX:1/Y,scaleY:1/V},C=_.getCanvas("mesh",tt+4,Z+4,!1),o=C.context,c=o.createImageData(tt,Z);if(F){const P=c.data;for(let t=0,r=P.length;t<r;t+=4)P[t]=F[0],P[t+1]=F[1],P[t+2]=F[2],P[t+3]=255}for(const P of this._figures)d(c,P,U);return o.putImageData(c,2,2),{canvas:C.canvas,offsetX:w-2*Y,offsetY:R-2*V,scaleX:Y,scaleY:V}}getPattern(T,F,_,s){let l;if(L(T,this._bbox),s===k.SHADING)l=n.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(T));else if(l=n.Util.singularValueDecompose2dScale(F.baseTransform),this.matrix){const w=n.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*w[0],l[1]*w[1]]}const b=this._createMeshCanvas(l,s===k.SHADING?null:this._background,F.cachedCanvases);return s!==k.SHADING&&(T.setTransform(...F.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(b.offsetX,b.offsetY),T.scale(b.scaleX,b.scaleY),T.createPattern(b.canvas,"no-repeat")}}class g extends y{getPattern(){return"hotpink"}}class A{static get MAX_PATTERN_SIZE(){return(0,n.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(T,F,_,s,l){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=F,this.ctx=_,this.canvasGraphicsFactory=s,this.baseTransform=l}createPatternCanvas(T){const F=this.operatorList,_=this.bbox,s=this.xstep,l=this.ystep,b=this.paintType,R=this.color,j=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+this.tilingType);const N=_[0],tt=_[1],Z=_[2],Y=_[3],V=n.Util.singularValueDecompose2dScale(this.matrix),U=n.Util.singularValueDecompose2dScale(this.baseTransform),B=[V[0]*U[0],V[1]*U[1]],X=this.getSizeAndScale(s,this.ctx.canvas.width,B[0]),C=this.getSizeAndScale(l,this.ctx.canvas.height,B[1]),o=T.cachedCanvases.getCanvas("pattern",X.size,C.size,!0),c=o.context,S=j.createCanvasGraphics(c);S.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(S,b,R);let P=N,t=tt,r=Z,p=Y;return N<0&&(P=0,r+=Math.abs(N)),tt<0&&(t=0,p+=Math.abs(tt)),c.translate(-X.scale*P,-C.scale*t),S.transform(X.scale,0,0,C.scale,0,0),c.save(),this.clipBbox(S,P,t,r,p),S.baseTransform=(0,f.getCurrentTransform)(S.ctx),S.executeOperatorList(F),S.endDrawing(),{canvas:o.canvas,scaleX:X.scale,scaleY:C.scale,offsetX:P,offsetY:t}}getSizeAndScale(T,F,_){T=Math.abs(T);const s=Math.max(A.MAX_PATTERN_SIZE,F);let l=Math.ceil(T*_);return l>=s?l=s:_=l/T,{scale:_,size:l}}clipBbox(T,F,_,s,l){T.ctx.rect(F,_,s-F,l-_),T.current.updateRectMinMax((0,f.getCurrentTransform)(T.ctx),[F,_,s,l]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,F,_){const s=T.ctx,l=T.current;switch(F){case 1:const b=this.ctx;s.fillStyle=b.fillStyle,s.strokeStyle=b.strokeStyle,l.fillColor=b.fillStyle,l.strokeColor=b.strokeStyle;break;case 2:const w=n.Util.makeHexColor(_[0],_[1],_[2]);s.fillStyle=w,s.strokeStyle=w,l.fillColor=w,l.strokeColor=w;break;default:throw new n.FormatError(`Unsupported paint type: ${F}`)}}getPattern(T,F,_,s){let l=_;s!==k.SHADING&&(l=n.Util.transform(l,F.baseTransform),this.matrix&&(l=n.Util.transform(l,this.matrix)));const b=this.createPatternCanvas(F);let w=new DOMMatrix(l);w=w.translate(b.offsetX,b.offsetY),w=w.scale(1/b.scaleX,1/b.scaleY);const R=T.createPattern(b.canvas,"repeat");try{R.setTransform(w)}catch(j){(0,n.warn)(`TilingPattern.getPattern: "${j?.message}".`)}return R}}e.TilingPattern=A},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.applyMaskImageData=function f({src:O,srcPos:k=0,dest:L,destPos:y=0,width:h,height:i,inverseDecode:d=!1}){const u=n.FeatureTest.isLittleEndian?4278190080:255,[g,a]=d?[0,u]:[u,0],m=h>>3,A=7&h,M=O.length;L=new Uint32Array(L.buffer);for(let T=0;T<i;T++){for(const _=k+m;k<_;k++){const s=k<M?O[k]:255;L[y++]=128&s?a:g,L[y++]=64&s?a:g,L[y++]=32&s?a:g,L[y++]=16&s?a:g,L[y++]=8&s?a:g,L[y++]=4&s?a:g,L[y++]=2&s?a:g,L[y++]=1&s?a:g}if(0===A)continue;const F=k<M?O[k++]:255;for(let _=0;_<A;_++)L[y++]=F&1<<7-_?a:g}return{srcPos:k,destPos:y}};var n=E(1)},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const E=Object.create(null);e.GlobalWorkerOptions=E,E.workerPort=void 0===E.workerPort?null:E.workerPort,E.workerSrc=void 0===E.workerSrc?"":E.workerSrc},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=E(1);function k(y){switch(y instanceof Error||"object"==typeof y&&null!==y||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),y.name){case"AbortException":return new n.AbortException(y.message);case"MissingPDFException":return new n.MissingPDFException(y.message);case"PasswordException":return new n.PasswordException(y.message,y.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(y.message,y.status);case"UnknownErrorException":return new n.UnknownErrorException(y.message,y.details);default:return new n.UnknownErrorException(y.message,y.toString())}}e.MessageHandler=class L{constructor(h,i,d){this.sourceName=h,this.targetName=i,this.comObj=d,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=u=>{const g=u.data;if(g.targetName!==this.sourceName)return;if(g.stream)return void this._processStreamMessage(g);if(g.callback){const m=g.callbackId,A=this.callbackCapabilities[m];if(!A)throw new Error(`Cannot resolve callback ${m}`);if(delete this.callbackCapabilities[m],1===g.callback)A.resolve(g.data);else{if(2!==g.callback)throw new Error("Unexpected callback case");A.reject(k(g.reason))}return}const a=this.actionHandler[g.action];if(!a)throw new Error(`Unknown action from worker: ${g.action}`);if(g.callbackId){const m=this.sourceName,A=g.sourceName;new Promise(function(M){M(a(g.data))}).then(function(M){d.postMessage({sourceName:m,targetName:A,callback:1,callbackId:g.callbackId,data:M})},function(M){d.postMessage({sourceName:m,targetName:A,callback:2,callbackId:g.callbackId,reason:k(M)})})}else g.streamId?this._createStreamSink(g):a(g.data)},d.addEventListener("message",this._onComObjOnMessage)}on(h,i){const d=this.actionHandler;if(d[h])throw new Error(`There is already an actionName called "${h}"`);d[h]=i}send(h,i,d){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:i},d)}sendWithPromise(h,i,d){const u=this.callbackId++,g=(0,n.createPromiseCapability)();this.callbackCapabilities[u]=g;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:u,data:i},d)}catch(a){g.reject(a)}return g.promise}sendWithStream(h,i,d,u){const g=this.streamId++,a=this.sourceName,m=this.targetName,A=this.comObj;return new ReadableStream({start:M=>{const T=(0,n.createPromiseCapability)();return this.streamControllers[g]={controller:M,startCall:T,pullCall:null,cancelCall:null,isClosed:!1},A.postMessage({sourceName:a,targetName:m,action:h,streamId:g,data:i,desiredSize:M.desiredSize},u),T.promise},pull:M=>{const T=(0,n.createPromiseCapability)();return this.streamControllers[g].pullCall=T,A.postMessage({sourceName:a,targetName:m,stream:6,streamId:g,desiredSize:M.desiredSize}),T.promise},cancel:M=>{(0,n.assert)(M instanceof Error,"cancel must have a valid reason");const T=(0,n.createPromiseCapability)();return this.streamControllers[g].cancelCall=T,this.streamControllers[g].isClosed=!0,A.postMessage({sourceName:a,targetName:m,stream:1,streamId:g,reason:k(M)}),T.promise}},d)}_createStreamSink(h){const i=h.streamId,d=this.sourceName,u=h.sourceName,g=this.comObj,a=this,m=this.actionHandler[h.action],A={enqueue(M,T=1,F){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=T,_>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),g.postMessage({sourceName:d,targetName:u,stream:4,streamId:i,chunk:M},F)},close(){this.isCancelled||(this.isCancelled=!0,g.postMessage({sourceName:d,targetName:u,stream:3,streamId:i}),delete a.streamSinks[i])},error(M){(0,n.assert)(M instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,g.postMessage({sourceName:d,targetName:u,stream:5,streamId:i,reason:k(M)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};A.sinkCapability.resolve(),A.ready=A.sinkCapability.promise,this.streamSinks[i]=A,new Promise(function(M){M(m(h.data,A))}).then(function(){g.postMessage({sourceName:d,targetName:u,stream:8,streamId:i,success:!0})},function(M){g.postMessage({sourceName:d,targetName:u,stream:8,streamId:i,reason:k(M)})})}_processStreamMessage(h){const i=h.streamId,d=this.sourceName,u=h.sourceName,g=this.comObj,a=this.streamControllers[i],m=this.streamSinks[i];switch(h.stream){case 8:h.success?a.startCall.resolve():a.startCall.reject(k(h.reason));break;case 7:h.success?a.pullCall.resolve():a.pullCall.reject(k(h.reason));break;case 6:if(!m){g.postMessage({sourceName:d,targetName:u,stream:7,streamId:i,success:!0});break}m.desiredSize<=0&&h.desiredSize>0&&m.sinkCapability.resolve(),m.desiredSize=h.desiredSize,new Promise(function(A){A(m.onPull&&m.onPull())}).then(function(){g.postMessage({sourceName:d,targetName:u,stream:7,streamId:i,success:!0})},function(A){g.postMessage({sourceName:d,targetName:u,stream:7,streamId:i,reason:k(A)})});break;case 4:if((0,n.assert)(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(h.chunk);break;case 3:if((0,n.assert)(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this._deleteStreamController(a,i);break;case 5:(0,n.assert)(a,"error should have stream controller"),a.controller.error(k(h.reason)),this._deleteStreamController(a,i);break;case 2:h.success?a.cancelCall.resolve():a.cancelCall.reject(k(h.reason)),this._deleteStreamController(a,i);break;case 1:if(!m)break;new Promise(function(A){A(m.onCancel&&m.onCancel(k(h.reason)))}).then(function(){g.postMessage({sourceName:d,targetName:u,stream:2,streamId:i,success:!0})},function(A){g.postMessage({sourceName:d,targetName:u,stream:2,streamId:i,reason:k(A)})}),m.sinkCapability.reject(k(h.reason)),m.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}_deleteStreamController(h,i){var d=this;return _asyncToGenerator(function*(){yield Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete d.streamControllers[i]})()}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=E(1);e.Metadata=class f{#t;#e;constructor({parsedData:k,rawData:L}){this.#t=k,this.#e=L}getRaw(){return this.#e}get(k){return this.#t.get(k)??null}getAll(){return(0,n.objectFromMap)(this.#t)}has(k){return this.#t.has(k)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=E(1);const f=Symbol("INTERNAL");class O{#t=!0;constructor(y,h){this.name=y,this.intent=h}get visible(){return this.#t}_setVisible(y,h){y!==f&&(0,n.unreachable)("Internal method `_setVisible` called."),this.#t=h}}e.OptionalContentConfig=class k{#t=!0;#e=new Map;#i=null;#n=null;constructor(y){if(this.name=null,this.creator=null,null!==y){this.name=y.name,this.creator=y.creator,this.#n=y.order;for(const h of y.groups)this.#e.set(h.id,new O(h.name,h.intent));if("OFF"===y.baseState)for(const h of this.#e.values())h._setVisible(f,!1);for(const h of y.on)this.#e.get(h)._setVisible(f,!0);for(const h of y.off)this.#e.get(h)._setVisible(f,!1);this.#i=new Map;for(const[h,i]of this.#e)this.#i.set(h,i.visible)}}#r(y){const h=y.length;if(h<2)return!0;const i=y[0];for(let d=1;d<h;d++){const u=y[d];let g;if(Array.isArray(u))g=this.#r(u);else{if(!this.#e.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;g=this.#e.get(u).visible}switch(i){case"And":if(!g)return!1;break;case"Or":if(g)return!0;break;case"Not":return!g;default:return!0}}return"And"===i}isVisible(y){if(0===this.#e.size)return!0;if(!y)return(0,n.warn)("Optional content group not defined."),!0;if("OCG"===y.type)return this.#e.has(y.id)?this.#e.get(y.id).visible:((0,n.warn)(`Optional content group not found: ${y.id}`),!0);if("OCMD"===y.type){if(y.expression)return this.#r(y.expression);if(!y.policy||"AnyOn"===y.policy){for(const h of y.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(this.#e.get(h).visible)return!0}return!1}if("AllOn"===y.policy){for(const h of y.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!this.#e.get(h).visible)return!1}return!0}if("AnyOff"===y.policy){for(const h of y.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!this.#e.get(h).visible)return!0}return!1}if("AllOff"===y.policy){for(const h of y.ids){if(!this.#e.has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(this.#e.get(h).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${y.policy}.`),!0}return(0,n.warn)(`Unknown group type ${y.type}.`),!0}setVisibility(y,h=!0){this.#e.has(y)?(this.#e.get(y)._setVisible(f,!!h),this.#t=null):(0,n.warn)(`Optional content group not found: ${y}`)}get hasInitialVisibility(){if(null!==this.#t)return this.#t;for(const[y,h]of this.#e){const i=this.#i.get(y);if(h.visible!==i)return this.#t=!1}return this.#t=!0}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,n.objectFromMap)(this.#e):null}getGroup(y){return this.#e.get(y)||null}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=E(1),f=E(8);e.PDFDataTransportStream=class O{constructor(h,i){(0,n.assert)(i,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h.progressiveDone||!1,this._contentDispositionFilename=h.contentDispositionFilename||null;const d=h.initialData;if(d?.length>0){const u=new Uint8Array(d).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=i,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._contentLength=h.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,g)=>{this._onReceiveData({begin:u,chunk:g})}),this._pdfDataRangeTransport.addProgressListener((u,g)=>{this._onProgress({loaded:u,total:g})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(h){const i=new Uint8Array(h.chunk).buffer;if(void 0===h.begin)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const d=this._rangeReaders.some(function(u){return u._begin===h.begin&&(u._enqueue(i),!0)});(0,n.assert)(d,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){if(void 0===h.total){const i=this._rangeReaders[0];i?.onProgress&&i.onProgress({loaded:h.loaded})}else{const i=this._fullRequestReader;i?.onProgress&&i.onProgress({loaded:h.loaded,total:h.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const i=this._rangeReaders.indexOf(h);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new k(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,i){if(i<=this._progressiveDataLength)return null;const d=new L(this,h,i);return this._pdfDataRangeTransport.requestDataRange(h,i),this._rangeReaders.push(d),d}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const i of this._rangeReaders.slice(0))i.cancel(h);this._pdfDataRangeTransport.abort()}};class k{constructor(h,i,d=!1,u=null){this._stream=h,this._done=d||!1,this._filename=(0,f.isPdfFile)(u)?u:null,this._queuedChunks=i||[],this._loaded=0;for(const g of this._queuedChunks)this._loaded+=g.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){var h=this;return _asyncToGenerator(function*(){if(h._queuedChunks.length>0)return{value:h._queuedChunks.shift(),done:!1};if(h._done)return{value:void 0,done:!0};const i=(0,n.createPromiseCapability)();return h._requests.push(i),i.promise})()}cancel(h){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class L{constructor(h,i,d){this._stream=h,this._begin=i,this._end=d,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(0===this._requests.length)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){var h=this;return _asyncToGenerator(function*(){if(h._queuedChunk){const d=h._queuedChunk;return h._queuedChunk=null,{value:d,done:!1}}if(h._done)return{value:void 0,done:!0};const i=(0,n.createPromiseCapability)();return h._requests.push(i),i.promise})()}cancel(h){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class E{static textContent(f){const O=[],k={items:O,styles:Object.create(null)};return function L(y){if(!y)return;let h=null;const i=y.name;if("#text"===i)h=y.value;else{if(!E.shouldBuildText(i))return;y?.attributes?.textContent?h=y.attributes.textContent:y.value&&(h=y.value)}if(null!==h&&O.push({str:h}),y.children)for(const d of y.children)L(d)}(f),k}static shouldBuildText(f){return!("textarea"===f||"input"===f||"option"===f||"select"===f)}}e.XfaText=E},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=E(9);const f=function(y){return new Promise((h,i)=>{__webpack_require__(23237).readFile(y,(u,g)=>{!u&&g?h(new Uint8Array(g)):i(new Error(u))})})};e.NodeCanvasFactory=class O extends n.BaseCanvasFactory{_createCanvas(h,i){return __webpack_require__(17640).createCanvas(h,i)}},e.NodeCMapReaderFactory=class k extends n.BaseCMapReaderFactory{_fetchData(h,i){return f(h).then(d=>({cMapData:d,compressionType:i}))}},e.NodeStandardFontDataFactory=class L extends n.BaseStandardFontDataFactory{_fetchData(h){return f(h)}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=E(7),f=E(1),O=E(23),k=E(24);e.AnnotationEditorLayer=(()=>{class y{#t;#e=!1;#i=this.pointerup.bind(this);#n=this.pointerdown.bind(this);#r=new Map;#h=!1;#o=!1;#s;static _initialized=!1;constructor(i){y._initialized||(y._initialized=!0,O.FreeTextEditor.initialize(i.l10n),k.InkEditor.initialize(i.l10n),i.uiManager.registerEditorTypes([O.FreeTextEditor,k.InkEditor])),this.#s=i.uiManager,this.annotationStorage=i.annotationStorage,this.pageIndex=i.pageIndex,this.div=i.div,this.#t=i.accessibilityManager,this.#s.addLayer(this)}updateToolbar(i){this.#s.updateToolbar(i)}updateMode(i=this.#s.getMode()){this.#a(),i===f.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#s.unselectAll()}addInkEditorIfNeeded(i){if(i||this.#s.getMode()===f.AnnotationEditorType.INK){if(!i)for(const u of this.#r.values())if(u.isEmpty())return void u.setInBackground();this.#c({offsetX:0,offsetY:0}).setInBackground()}}setEditingState(i){this.#s.setEditingState(i)}addCommands(i){this.#s.addCommands(i)}enable(){this.div.style.pointerEvents="auto";for(const i of this.#r.values())i.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const i of this.#r.values())i.disableEditing()}setActiveEditor(i){this.#s.getActive()!==i&&this.#s.setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",this.#n),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#n),this.div.removeEventListener("pointerup",this.#i)}attach(i){this.#r.set(i.id,i)}detach(i){this.#r.delete(i.id),this.#t?.removePointerInTextLayer(i.contentDiv)}remove(i){this.#s.removeEditor(i),this.detach(i),this.annotationStorage.remove(i.id),i.div.style.display="none",setTimeout(()=>{i.div.style.display="",i.div.remove(),i.isAttachedToDOM=!1,document.activeElement===document.body&&this.#s.focusMainContainer()},0),this.#o||this.addInkEditorIfNeeded(!1)}#u(i){i.parent!==this&&(this.attach(i),i.pageIndex=this.pageIndex,i.parent?.detach(i),i.parent=this,i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.#u(i),this.#s.addEditor(i),this.attach(i),!i.isAttachedToDOM){const d=i.render();this.div.append(d),i.isAttachedToDOM=!0}this.moveEditorInDOM(i),i.onceAdded(),this.addToAnnotationStorage(i)}moveEditorInDOM(i){this.#t?.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addToAnnotationStorage(i){!i.isEmpty()&&!this.annotationStorage.has(i.id)&&this.annotationStorage.setValue(i.id,i)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addANewEditor(i){this.addCommands({cmd:()=>{this.addOrRebuild(i)},undo:()=>{i.remove()},mustExec:!0})}addUndoableEditor(i){this.addCommands({cmd:()=>{this.addOrRebuild(i)},undo:()=>{i.remove()},mustExec:!1})}getNextId(){return this.#s.getId()}#l(i){switch(this.#s.getMode()){case f.AnnotationEditorType.FREETEXT:return new O.FreeTextEditor(i);case f.AnnotationEditorType.INK:return new k.InkEditor(i)}return null}deserialize(i){switch(i.annotationType){case f.AnnotationEditorType.FREETEXT:return O.FreeTextEditor.deserialize(i,this);case f.AnnotationEditorType.INK:return k.InkEditor.deserialize(i,this)}return null}#c(i){const d=this.getNextId(),u=this.#l({parent:this,id:d,x:i.offsetX,y:i.offsetY});return u&&this.add(u),u}setSelected(i){this.#s.setSelected(i)}toggleSelected(i){this.#s.toggleSelected(i)}isSelected(i){return this.#s.isSelected(i)}unselect(i){this.#s.unselect(i)}pointerup(i){if(!(0!==i.button||i.ctrlKey&&n.KeyboardManager.platform.isMac)&&i.target===this.div&&this.#h){if(this.#h=!1,!this.#e)return void(this.#e=!0);this.#c(i)}}pointerdown(i){if(0!==i.button||i.ctrlKey&&n.KeyboardManager.platform.isMac||i.target!==this.div)return;this.#h=!0;const u=this.#s.getActive();this.#e=!u||u.isEmpty()}drop(i){const d=i.dataTransfer.getData("text/plain"),u=this.#s.getEditor(d);if(!u)return;i.preventDefault(),i.dataTransfer.dropEffect="move",this.#u(u);const g=this.div.getBoundingClientRect();u.translate(i.clientX-g.x-u.startX,i.clientY-g.y-u.startY),this.moveEditorInDOM(u),u.div.focus()}dragover(i){i.preventDefault()}destroy(){this.#s.getActive()?.parent===this&&this.#s.setActiveEditor(null);for(const i of this.#r.values())this.#t?.removePointerInTextLayer(i.contentDiv),i.isAttachedToDOM=!1,i.div.remove(),i.parent=null;this.div=null,this.#r.clear(),this.#s.removeLayer(this)}#a(){this.#o=!0;for(const i of this.#r.values())i.isEmpty()&&i.remove();this.#o=!1}render(i){this.viewport=i.viewport,(0,n.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const d of this.#s.getEditors(this.pageIndex))this.add(d);this.updateMode()}update(i){this.viewport=i.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[i,d,u,g]=this.viewport.viewBox;return[u-i,g-d]}get viewportBaseDimensions(){const{width:i,height:d,rotation:u}=this.viewport;return u%180==0?[i,d]:[d,i]}setDimensions(){const{width:i,height:d,rotation:u}=this.viewport,g=u%180!=0,a=Math.floor(i)+"px",m=Math.floor(d)+"px";this.div.style.width=g?m:a,this.div.style.height=g?a:m,this.div.setAttribute("data-main-rotation",u)}}return y})()},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=E(1),f=E(7),O=E(6);class k extends O.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivKeydown.bind(this);#n;#r="";#h=!1;#o;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new f.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.prototype.commitOrRemove]]);static _type="freetext";constructor(y){super({...y,name:"freeTextEditor"}),this.#n=y.color||k._defaultColor||O.AnnotationEditor._defaultLineColor,this.#o=y.fontSize||k._defaultFontSize}static initialize(y){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(i=>[i,y.get(i)]));const h=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(h.getPropertyValue("--freetext-padding"))}static updateDefaultParams(y,h){switch(y){case n.AnnotationEditorParamsType.FREETEXT_SIZE:k._defaultFontSize=h;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:k._defaultColor=h}}updateParams(y,h){switch(y){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#s(h);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#u(h)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,k._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,k._defaultColor||O.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#o],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#n]]}#s(y){const h=d=>{this.editorDiv.style.fontSize=`calc(${d}px * var(--scale-factor))`,this.translate(0,-(d-this.#o)*this.parent.scaleFactor),this.#o=d,this.#c()},i=this.#o;this.parent.addCommands({cmd:()=>{h(y)},undo:()=>{h(i)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#u(y){const h=this.#n;this.parent.addCommands({cmd:()=>{this.#n=y,this.editorDiv.style.color=y},undo:()=>{this.#n=h,this.editorDiv.style.color=h},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){return[-k._internalPadding*this.parent.scaleFactor,-(k._internalPadding+this.#o)*this.parent.scaleFactor]}rebuild(){super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.div.focus(),this.isEditing=!1)}focusin(y){super.focusin(y),y.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}#l(){const y=this.editorDiv.getElementsByTagName("div");if(0===y.length)return this.editorDiv.innerText;const h=[];for(let i=0,d=y.length;i<d;i++){const g=y[i].firstChild;h.push("#text"===g?.nodeName?g.data:"")}return h.join("\n")}#c(){const[y,h]=this.parent.viewportBaseDimensions,i=this.div.getBoundingClientRect();this.width=i.width/y,this.height=i.height/h}commit(){super.commit(),this.#h||(this.#h=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#r=this.#l().trimEnd(),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(y){this.enableEditMode(),this.editorDiv.focus()}keydown(y){y.target===this.div&&"Enter"===y.key&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(y){k._keyboardManager.exec(this,y)}editorDivFocus(y){this.isEditing=!0}editorDivBlur(y){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let y,h;this.width&&(y=this.x,h=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),k._l10nPromise.get("editor_free_text_aria_label").then(d=>this.editorDiv?.setAttribute("aria-label",d)),k._l10nPromise.get("free_text_default_content").then(d=>this.editorDiv?.setAttribute("default-content",d)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#o}px * var(--scale-factor))`,i.color=this.#n,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[d,u]=this.parent.viewportBaseDimensions;this.setAt(y*d,h*u,this.width*d,this.height*u);for(const g of this.#r.split("\n")){const a=document.createElement("div");a.append(g?document.createTextNode(g):document.createElement("br")),this.editorDiv.append(a)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(y,h){const i=super.deserialize(y,h);return i.#o=y.fontSize,i.#n=n.Util.makeHexColor(...y.color),i.#r=y.value,i}serialize(){if(this.isEmpty())return null;const y=k._internalPadding*this.parent.scaleFactor,h=this.getRect(y,y),i=O.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:n.AnnotationEditorType.FREETEXT,color:i,fontSize:this.#o,value:this.#r,pageIndex:this.parent.pageIndex,rect:h,rotation:this.rotation}}}e.FreeTextEditor=k},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,Object.defineProperty(e,"fitCurve",{enumerable:!0,get:function(){return O.fitCurve}});var n=E(1),f=E(6),O=E(25),k=E(7);const L=16;e.InkEditor=(()=>{class h extends f.AnnotationEditor{#t=0;#e=0;#i=0;#n=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#h=this.canvasPointerup.bind(this);#o=this.canvasPointerdown.bind(this);#s=!1;#u=!1;#l=null;#c=null;#a=0;#m=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(d){super({...d,name:"inkEditor"}),this.color=d.color||null,this.thickness=d.thickness||null,this.opacity=d.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(d){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(u=>[u,d.get(u)]))}static updateDefaultParams(d,u){switch(d){case n.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=u;break;case n.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=u;break;case n.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=u/100}}updateParams(d,u){switch(d){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#C(u);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#T(u);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#b(u)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*h._defaultOpacity)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#C(d){const u=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=d,this.#E()},undo:()=>{this.thickness=u,this.#E()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#T(d){const u=this.color;this.parent.addCommands({cmd:()=>{this.color=d,this.#f()},undo:()=>{this.color=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#b(d){d/=100;const u=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=d,this.#f()},undo:()=>{this.opacity=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),null!==this.div&&(this.canvas||(this.#g(),this.#_()),this.isAttachedToDOM||(this.parent.add(this),this.#S()),this.#E())}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}enableEditMode(){this.#s||null===this.canvas||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#o),this.canvas.addEventListener("pointerup",this.#h))}disableEditMode(){!this.isInEditMode()||null===this.canvas||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#o),this.canvas.removeEventListener("pointerup",this.#h))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#x(){const{width:d,height:u,rotation:g}=this.parent.viewport;switch(g){case 90:return[0,d,d,u];case 180:return[d,u,d,u];case 270:return[u,0,d,u];default:return[0,0,d,u]}}#y(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,k.opacityToHex)(this.opacity)}`}#d(d,u){this.isEditing=!0,this.#u||(this.#u=!0,this.#S(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||f.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([d,u]),this.#l=null,this.#y(),this.ctx.beginPath(),this.ctx.moveTo(d,u),this.#p=()=>{this.#p&&(this.#l&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#f(),this.ctx.lineTo(...this.#l),this.#l=null,this.ctx.stroke()),window.requestAnimationFrame(this.#p))},window.requestAnimationFrame(this.#p)}#A(d,u){const[g,a]=this.currentPath.at(-1);d===g&&u===a||(this.currentPath.push([d,u]),this.#l=[d,u])}#P(d,u){this.ctx.closePath(),this.#p=null,d=Math.min(Math.max(d,0),this.canvas.width),u=Math.min(Math.max(u,0),this.canvas.height);const[g,a]=this.currentPath.at(-1);let m;if((d!==g||u!==a)&&this.currentPath.push([d,u]),1!==this.currentPath.length)m=(0,O.fitCurve)(this.currentPath,30,null);else{const F=[d,u];m=[[F,F.slice(),F.slice(),F]]}const A=h.#F(m);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(m),this.bezierPath2D.push(A),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#g(),this.#_()),this.#E())},mustExec:!0})}#f(){if(this.isEmpty())return void this.#w();this.#y();const{canvas:d,ctx:u}=this;u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,d.width,d.height),this.#w();for(const g of this.bezierPath2D)u.stroke(g)}commit(){this.#s||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#s=!0,this.div.classList.add("disabled"),this.#E(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(d){super.focusin(d),this.enableEditMode()}canvasPointerdown(d){0!==d.button||!this.isInEditMode()||this.#s||(this.setInForeground(),"mouse"!==d.type&&this.div.focus(),d.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#n),this.#d(d.offsetX,d.offsetY))}canvasPointermove(d){d.stopPropagation(),this.#A(d.offsetX,d.offsetY)}canvasPointerup(d){0===d.button&&this.isInEditMode()&&0!==this.currentPath.length&&(d.stopPropagation(),this.#v(d),this.setInBackground())}canvasPointerleave(d){this.#v(d),this.setInBackground()}#v(d){this.#P(d.offsetX,d.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#n),this.parent.addToAnnotationStorage(this)}#g(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",h._l10nPromise.get("editor_ink_canvas_aria_label").then(d=>this.canvas?.setAttribute("aria-label",d)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#_(){this.#c=new ResizeObserver(d=>{const u=d[0].contentRect;u.width&&u.height&&this.setDimensions(u.width,u.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let d,u;this.width&&(d=this.x,u=this.y),super.render(),h._l10nPromise.get("editor_ink_aria_label").then(M=>this.div?.setAttribute("aria-label",M));const[g,a,m,A]=this.#x();if(this.setAt(g,a,0,0),this.setDims(m,A),this.#g(),this.width){const[M,T]=this.parent.viewportBaseDimensions;this.setAt(d*M,u*T,this.width*M,this.height*T),this.#u=!0,this.#S(),this.setDims(this.width*M,this.height*T),this.#f(),this.#D(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#_(),this.div}#S(){if(!this.#u)return;const[d,u]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*d),this.canvas.height=Math.ceil(this.height*u),this.#w()}setDimensions(d,u){const g=Math.round(d),a=Math.round(u);if(this.#a===g&&this.#m===a)return;this.#a=g,this.#m=a,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-d/u)>.01&&(u=Math.ceil(d/this.#t),this.setDims(d,u));const[m,A]=this.parent.viewportBaseDimensions;this.width=d/m,this.height=u/A,this.#s&&this.#R(d,u),this.#S(),this.#f(),this.canvas.style.visibility="visible"}#R(d,u){const g=this.#k(),a=(d-g)/this.#i,m=(u-g)/this.#e;this.scaleFactor=Math.min(a,m)}#w(){const d=this.#k()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+d,this.translationY*this.scaleFactor+d)}static#F(d){const u=new Path2D;for(let g=0,a=d.length;g<a;g++){const[m,A,M,T]=d[g];0===g&&u.moveTo(...m),u.bezierCurveTo(A[0],A[1],M[0],M[1],T[0],T[1])}return u}#O(d,u,g,a){const A=[],M=this.thickness/2;let T,F;for(const _ of this.paths){T=[],F=[];for(let s=0,l=_.length;s<l;s++){const[b,w,R,j]=_[s],N=d*(b[0]+u)+M,tt=a-d*(b[1]+g)-M,Z=d*(w[0]+u)+M,Y=a-d*(w[1]+g)-M,V=d*(R[0]+u)+M,U=a-d*(R[1]+g)-M,B=d*(j[0]+u)+M,X=a-d*(j[1]+g)-M;0===s&&(T.push(N,tt),F.push(N,tt)),T.push(Z,Y,V,U,B,X),this.#I(N,tt,Z,Y,V,U,B,X,4,F)}A.push({bezier:T,points:F})}return A}#I(d,u,g,a,m,A,M,T,F,_){if(this.#L(d,u,g,a,m,A,M,T))_.push(M,T);else{for(let s=1;s<F-1;s++){const l=s/F,b=1-l;let w=l*d+b*g,R=l*u+b*a,j=l*g+b*m,N=l*a+b*A;w=l*w+b*j,R=l*R+b*N,j=l*j+b*(l*m+b*M),N=l*N+b*(l*A+b*T),w=l*w+b*j,R=l*R+b*N,_.push(w,R)}_.push(M,T)}}#L(d,u,g,a,m,A,M,T){const s=(3*a-2*u-T)**2,b=(3*A-u-2*T)**2;return Math.max((3*g-2*d-M)**2,(3*m-d-2*M)**2)+Math.max(s,b)<=10}#M(){let d=1/0,u=-1/0,g=1/0,a=-1/0;for(const m of this.paths)for(const[A,M,T,F]of m){const _=n.Util.bezierBoundingBox(...A,...M,...T,...F);d=Math.min(d,_[0]),g=Math.min(g,_[1]),u=Math.max(u,_[2]),a=Math.max(a,_[3])}return[d,g,u,a]}#k(){return this.#s?Math.ceil(this.thickness*this.parent.scaleFactor):0}#E(d=!1){if(this.isEmpty())return;if(!this.#s)return void this.#f();const u=this.#M(),g=this.#k();this.#i=Math.max(L,u[2]-u[0]),this.#e=Math.max(L,u[3]-u[1]);const a=Math.ceil(g+this.#i*this.scaleFactor),m=Math.ceil(g+this.#e*this.scaleFactor),[A,M]=this.parent.viewportBaseDimensions;this.width=a/A,this.height=m/M,this.#t=a/m,this.#D();const T=this.translationX,F=this.translationY;this.translationX=-u[0],this.translationY=-u[1],this.#S(),this.#f(),this.#a=a,this.#m=m,this.setDims(a,m);const _=d?g/this.scaleFactor/2:0;this.translate(T-this.translationX-_,F-this.translationY-_)}#D(){const{style:d}=this.div;this.#t>=1?(d.minHeight="16px",d.minWidth=`${Math.round(this.#t*L)}px`):(d.minWidth="16px",d.minHeight=`${Math.round(L/this.#t)}px`)}static deserialize(d,u){const g=super.deserialize(d,u);g.thickness=d.thickness,g.color=n.Util.makeHexColor(...d.color),g.opacity=d.opacity;const[a,m]=u.pageDimensions,A=g.width*a,M=g.height*m,T=u.scaleFactor,F=d.thickness/2;g.#t=A/M,g.#s=!0,g.#a=Math.round(A),g.#m=Math.round(M);for(const{bezier:s}of d.paths){const l=[];g.paths.push(l);let b=T*(s[0]-F),w=T*(M-s[1]-F);for(let j=2,N=s.length;j<N;j+=6){const U=T*(s[j+4]-F),B=T*(M-s[j+5]-F);l.push([[b,w],[T*(s[j]-F),T*(M-s[j+1]-F)],[T*(s[j+2]-F),T*(M-s[j+3]-F)],[U,B]]),b=U,w=B}const R=this.#F(l);g.bezierPath2D.push(R)}const _=g.#M();return g.#i=Math.max(L,_[2]-_[0]),g.#e=Math.max(L,_[3]-_[1]),g.#R(A,M),g}serialize(){if(this.isEmpty())return null;const d=this.getRect(0,0),u=this.rotation%180==0?d[3]-d[1]:d[2]-d[0],g=f.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:g,thickness:this.thickness,opacity:this.opacity,paths:this.#O(this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,u),pageIndex:this.parent.pageIndex,rect:d,rotation:this.rotation}}}return h})()},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fitCurve=void 0;const n=E(26);e.fitCurve=n},$=>{function E(a,m,A,M,T){var _,s,l,b,w,R,j,N,tt,Z,Y,V,U;if(2===a.length)return V=u.vectorLen(u.subtract(a[0],a[1]))/3,[_=[a[0],u.addArrays(a[0],u.mulItems(m,V)),u.addArrays(a[1],u.mulItems(A,V)),a[1]]];if(s=function L(a){var A,M,T,m=[];return a.forEach((F,_)=>{A=_?M+u.vectorLen(u.subtract(F,T)):0,m.push(A),M=A,T=F}),m=m.map(F=>F/M)}(a),[_,b,R]=n(a,s,s,m,A,T),0===b||b<M)return[_];if(b<M*M)for(l=s,w=b,j=R,U=0;U<20;U++){if(l=O(_,a,l),[_,b,R]=n(a,s,l,m,A,T),b<M)return[_];if(R===j){let B=b/w;if(B>.9999&&B<1.0001)break}w=b,j=R}return Y=[],(N=u.subtract(a[R-1],a[R+1])).every(B=>0===B)&&(N=u.subtract(a[R-1],a[R]),[N[0],N[1]]=[-N[1],N[0]]),tt=u.normalize(N),Z=u.mulItems(tt,-1),(Y=Y.concat(E(a.slice(0,R+1),m,tt,M,T))).concat(E(a.slice(R),Z,A,M,T))}function n(a,m,A,M,T,F){var _,s,l;return _=function f(a,m,A,M){var T,F,_,s,l,b,j,N,tt,Z,Y,V,U,B,X,C=a[0],o=a[a.length-1];for(T=[C,null,null,o],F=u.zeros_Xx2x2(m.length),Y=0,V=m.length;Y<V;Y++)(_=F[Y])[0]=u.mulItems(A,3*(B=m[Y])*((X=1-B)*X)),_[1]=u.mulItems(M,3*X*(B*B));for(s=[[0,0],[0,0]],l=[0,0],Y=0,V=a.length;Y<V;Y++)B=m[Y],s[0][0]+=u.dot((_=F[Y])[0],_[0]),s[0][1]+=u.dot(_[0],_[1]),s[1][0]+=u.dot(_[0],_[1]),s[1][1]+=u.dot(_[1],_[1]),U=u.subtract(a[Y],g.q([C,C,o,o],B)),l[0]+=u.dot(_[0],U),l[1]+=u.dot(_[1],U);return j=0==(b=s[0][0]*s[1][1]-s[1][0]*s[0][1])?0:(l[0]*s[1][1]-l[1]*s[0][1])/b,N=0===b?0:(s[0][0]*l[1]-s[1][0]*l[0])/b,j<(tt=1e-6*(Z=u.vectorLen(u.subtract(C,o))))||N<tt?(T[1]=u.addArrays(C,u.mulItems(A,Z/3)),T[2]=u.addArrays(o,u.mulItems(M,Z/3))):(T[1]=u.addArrays(C,u.mulItems(A,j)),T[2]=u.addArrays(o,u.mulItems(M,N))),T}(a,A,M,T),[s,l]=function y(a,m,A){var M,T,F,_,s,l,b,w;T=0,F=Math.floor(a.length/2);const R=h(m,10);for(s=0,l=a.length;s<l;s++)b=a[s],w=i(0,A[s],R,10),(M=(_=u.subtract(g.q(m,w),b))[0]*_[0]+_[1]*_[1])>T&&(T=M,F=s);return[T,F]}(a,_,m),F&&F({bez:_,points:a,params:m,maxErr:s,maxPoint:l}),[_,s,l]}function O(a,m,A){return A.map((M,T)=>function k(a,m,A){var M=u.subtract(g.q(a,A),m),T=g.qprime(a,A),F=u.mulMatrix(M,T),_=u.sum(u.squareItems(T))+2*u.mulMatrix(M,g.qprimeprime(a,A));return 0===_?A:A-F/_}(a,m[T],M))}var h=function(a,m){for(var A,M=[0],T=a[0],F=0,_=1;_<=m;_++)A=g.q(a,_/m),F+=u.vectorLen(u.subtract(A,T)),M.push(F),T=A;return M.map(s=>s/F)};function i(a,m,A,M){if(m<0)return 0;if(m>1)return 1;for(var F,s,l,b=1;b<=M;b++)if(m<=A[b]){l=(m-(F=A[b-1]))/(A[b]-F)*(b/M-(s=(b-1)/M))+s;break}return l}function d(a,m){return u.normalize(u.subtract(a,m))}class u{static zeros_Xx2x2(m){for(var A=[];m--;)A.push([0,0]);return A}static mulItems(m,A){return m.map(M=>M*A)}static mulMatrix(m,A){return m.reduce((M,T,F)=>M+T*A[F],0)}static subtract(m,A){return m.map((M,T)=>M-A[T])}static addArrays(m,A){return m.map((M,T)=>M+A[T])}static addItems(m,A){return m.map(M=>M+A)}static sum(m){return m.reduce((A,M)=>A+M)}static dot(m,A){return u.mulMatrix(m,A)}static vectorLen(m){return Math.hypot(...m)}static divItems(m,A){return m.map(M=>M/A)}static squareItems(m){return m.map(A=>A*A)}static normalize(m){return this.divItems(m,this.vectorLen(m))}}class g{static q(m,A){var M=1-A,T=u.mulItems(m[0],M*M*M),F=u.mulItems(m[1],3*M*M*A),_=u.mulItems(m[2],3*M*A*A),s=u.mulItems(m[3],A*A*A);return u.addArrays(u.addArrays(T,F),u.addArrays(_,s))}static qprime(m,A){var M=1-A,T=u.mulItems(u.subtract(m[1],m[0]),3*M*M),F=u.mulItems(u.subtract(m[2],m[1]),6*M*A),_=u.mulItems(u.subtract(m[3],m[2]),3*A*A);return u.addArrays(u.addArrays(T,F),_)}static qprimeprime(m,A){return u.addArrays(u.mulItems(u.addArrays(u.subtract(m[2],u.mulItems(m[1],2)),m[0]),6*(1-A)),u.mulItems(u.addArrays(u.subtract(m[3],u.mulItems(m[2],2)),m[1]),6*A))}}$.exports=function e(a,m,A){if(!Array.isArray(a))throw new TypeError("First argument should be an array");if(a.forEach(_=>{if(!Array.isArray(_)||_.some(s=>"number"!=typeof s)||_.length!==a[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(a=a.filter((_,s)=>0===s||!_.every((l,b)=>l===a[s-1][b]))).length<2)return[];const M=a.length,T=d(a[1],a[0]),F=d(a[M-2],a[M-1]);return E(a,T,F,m,A)},$.exports.fitCubic=E,$.exports.createTangent=d},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var n=E(1),f=E(8),O=E(5),k=E(28),L=E(29);const y=1e3,i=new WeakSet;function d(P){return{width:P[2]-P[0],height:P[3]-P[1]}}class u{static create(t){switch(t.data.annotationType){case n.AnnotationType.LINK:return new a(t);case n.AnnotationType.TEXT:return new m(t);case n.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new M(t);case"Btn":return t.data.radioButton?new F(t):t.data.checkBox?new T(t):new _(t);case"Ch":return new s(t)}return new A(t);case n.AnnotationType.POPUP:return new l(t);case n.AnnotationType.FREETEXT:return new w(t);case n.AnnotationType.LINE:return new R(t);case n.AnnotationType.SQUARE:return new j(t);case n.AnnotationType.CIRCLE:return new N(t);case n.AnnotationType.POLYLINE:return new tt(t);case n.AnnotationType.CARET:return new Y(t);case n.AnnotationType.INK:return new V(t);case n.AnnotationType.POLYGON:return new Z(t);case n.AnnotationType.HIGHLIGHT:return new U(t);case n.AnnotationType.UNDERLINE:return new B(t);case n.AnnotationType.SQUIGGLY:return new X(t);case n.AnnotationType.STRIKEOUT:return new C(t);case n.AnnotationType.STAMP:return new o(t);case n.AnnotationType.FILEATTACHMENT:return new c(t);default:return new g(t)}}}class g{constructor(t,{isRenderable:r=!1,ignoreBorder:p=!1,createQuadrilaterals:v=!1}={}){this.isRenderable=r,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,r&&(this.container=this._createContainer(p)),v&&(this.quadrilaterals=this._createQuadrilaterals(p))}_createContainer(t=!1){const r=this.data,p=this.page,v=this.viewport,x=document.createElement("section"),{width:D,height:I}=d(r.rect),[W,z,q,K]=v.viewBox,et=q-W,J=K-z;x.setAttribute("data-annotation-id",r.id);const st=n.Util.normalizeRect([r.rect[0],p.view[3]-r.rect[1]+p.view[1],r.rect[2],p.view[3]-r.rect[3]+p.view[1]]);if(!t&&r.borderStyle.width>0){x.style.borderWidth=`${r.borderStyle.width}px`;const at=r.borderStyle.horizontalCornerRadius,ot=r.borderStyle.verticalCornerRadius;switch(at>0||ot>0?x.style.borderRadius=`calc(${at}px * var(--scale-factor)) / calc(${ot}px * var(--scale-factor))`:this instanceof F&&(x.style.borderRadius=`calc(${D}px * var(--scale-factor)) / calc(${I}px * var(--scale-factor))`),r.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:x.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:x.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:x.style.borderBottomStyle="solid"}const nt=r.borderColor||null;nt?x.style.borderColor=n.Util.makeHexColor(0|nt[0],0|nt[1],0|nt[2]):x.style.borderWidth=0}x.style.left=100*(st[0]-W)/et+"%",x.style.top=100*(st[1]-z)/J+"%";const{rotation:it}=r;return r.hasOwnCanvas||0===it?(x.style.width=100*D/et+"%",x.style.height=100*I/J+"%"):this.setRotation(it,x),x}setRotation(t,r=this.container){const[p,v,x,D]=this.viewport.viewBox,I=x-p,W=D-v,{width:z,height:q}=d(this.data.rect);let K,et;t%180==0?(K=100*z/I,et=100*q/W):(K=100*q/I,et=100*z/W),r.style.width=`${K}%`,r.style.height=`${et}%`,r.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(r,p,v)=>{const x=v.detail[r];v.target.style[p]=k.ColorConverters[`${x[0]}_HTML`](x.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:r=>{const p=r.detail.display%2==1;this.container.style.visibility=p?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:p,print:0===r.detail.display||3===r.detail.display})},print:r=>{this.annotationStorage.setValue(this.data.id,{print:r.detail.print})},hidden:r=>{this.container.style.visibility=r.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r.detail.hidden})},focus:r=>{setTimeout(()=>r.target.focus({preventScroll:!1}),0)},userName:r=>{r.target.title=r.detail.userName},readonly:r=>{r.detail.readonly?r.target.setAttribute("readonly",""):r.target.removeAttribute("readonly")},required:r=>{this._setRequired(r.target,r.detail.required)},bgColor:r=>{t("bgColor","backgroundColor",r)},fillColor:r=>{t("fillColor","backgroundColor",r)},fgColor:r=>{t("fgColor","color",r)},textColor:r=>{t("textColor","color",r)},borderColor:r=>{t("borderColor","borderColor",r)},strokeColor:r=>{t("strokeColor","borderColor",r)},rotation:r=>{const p=r.detail.rotation;this.setRotation(p),this.annotationStorage.setValue(this.data.id,{rotation:p})}})}_dispatchEventFromSandbox(t,r){const p=this._commonActions;for(const v of Object.keys(r.detail)){const x=t[v]||p[v];x&&x(r)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const r=this.annotationStorage.getRawValue(this.data.id);if(!r)return;const p=this._commonActions;for(const[v,x]of Object.entries(r)){const D=p[v];D&&(D({detail:{[v]:x},target:t}),delete r[v])}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const r=[],p=this.data.rect;for(const v of this.data.quadPoints)this.data.rect=[v[2].x,v[2].y,v[1].x,v[1].y],r.push(this._createContainer(t));return this.data.rect=p,r}_createPopup(t,r){let p=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,p=this.quadrilaterals[0]),t||((t=document.createElement("div")).className="popupTriggerArea",p.append(t));const x=new b({container:p,trigger:t,color:r.color,titleObj:r.titleObj,modificationDate:r.modificationDate,contentsObj:r.contentsObj,richText:r.richText,hideWrapper:!0}).render();x.style.left="100%",p.append(x)}_renderQuadrilaterals(t){for(const r of this.quadrilaterals)r.className=t;return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,r=null){const p=[];if(this._fieldObjects){const v=this._fieldObjects[t];if(v)for(const{page:x,id:D,exportValues:I}of v){if(-1===x||D===r)continue;const W="string"==typeof I?I:null,z=document.querySelector(`[data-element-id="${D}"]`);!z||i.has(z)?p.push({id:D,exportValue:W,domElement:z}):(0,n.warn)(`_getElementsByName - element not allowed: ${D}`)}return p}for(const v of document.getElementsByName(t)){const{id:x,exportValue:D}=v;x!==r&&i.has(v)&&p.push({id:x,exportValue:D,domElement:v})}return p}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class a extends g{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!r?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,p=document.createElement("a");p.setAttribute("data-element-id",t.id);let v=!1;return t.url?(r.addLinkAttributes(p,t.url,t.newWindow),v=!0):t.action?(this._bindNamedAction(p,t.action),v=!0):t.dest?(this._bindLink(p,t.dest),v=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(p,t),v=!0),t.resetForm?(this._bindResetFormAction(p,t.resetForm),v=!0):this.isTooltipOnly&&!v&&(this._bindLink(p,""),v=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((x,D)=>{const I=0===D?p:p.cloneNode();return x.append(I),x}):(this.container.className="linkAnnotation",v&&this.container.append(p),this.container)}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||""===r)&&(t.className="internalLink")}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),t.className="internalLink"}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const p=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const v of Object.keys(r.actions)){const x=p.get(v);x&&(t[x]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:v}}),!1))}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,r){const p=t.onclick;if(p||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects)return(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(p||(t.onclick=()=>!1));t.onclick=()=>{p&&p();const{fields:v,refs:x,include:D}=r,I=[];if(0!==v.length||0!==x.length){const q=new Set(x);for(const K of v){const et=this._fieldObjects[K]||[];for(const{id:J}of et)q.add(J)}for(const K of Object.values(this._fieldObjects))for(const et of K)q.has(et.id)===D&&I.push(et)}else for(const q of Object.values(this._fieldObjects))I.push(...q);const W=this.annotationStorage,z=[];for(const q of I){const{id:K}=q;switch(z.push(K),q.type){case"text":case"combobox":case"listbox":W.setValue(K,{value:q.defaultValue||""});break;case"checkbox":case"radiobutton":W.setValue(K,{value:q.defaultValue===q.exportValues});break;default:continue}const et=document.querySelector(`[data-element-id="${K}"]`);et&&(i.has(et)?et.dispatchEvent(new Event("resetform")):(0,n.warn)(`_bindResetFormAction - element not allowed: ${K}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:z,name:"ResetForm"}}),!1}}}class m extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class A extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:r,isMac:p}=g.platform;return r&&t.ctrlKey||p&&t.metaKey}_setEventListener(t,r,p,v){r.includes("mouse")?t.addEventListener(r,x=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:v(x),shift:x.shiftKey,modifier:this._getKeyModifier(x)}})}):t.addEventListener(r,x=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:v(x)}})})}_setEventListeners(t,r,p){for(const[v,x]of r)("Action"===x||this.data.actions?.[x])&&this._setEventListener(t,v,x,p)}_setBackgroundColor(t){const r=this.data.backgroundColor||null;t.style.backgroundColor=null===r?"transparent":n.Util.makeHexColor(r[0],r[1],r[2])}_setTextStyle(t){const{fontColor:p}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||9,x=t.style;let D;if(this.data.multiLine){const I=Math.abs(this.data.rect[3]-this.data.rect[1]),W=Math.round(I/(n.LINE_FACTOR*v))||1;D=Math.min(v,Math.round(I/W/n.LINE_FACTOR))}else{const I=Math.abs(this.data.rect[3]-this.data.rect[1]);D=Math.min(v,Math.round(I/n.LINE_FACTOR))}x.fontSize=`calc(${D}px * var(--scale-factor))`,x.color=n.Util.makeHexColor(p[0],p[1],p[2]),null!==this.data.textAlignment&&(x.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,r){r?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",r)}}class M extends A{constructor(t){super(t,{isRenderable:t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,r,p,v){const x=this.annotationStorage;for(const D of this._getElementsByName(t.name,t.id))D.domElement&&(D.domElement[r]=p),x.setValue(D.id,{[v]:p})}render(){const t=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let p=null;if(this.renderForms){const v=t.getValue(r,{value:this.data.fieldValue});let x=v.formattedValue||v.value||"";const D=t.getValue(r,{charLimit:this.data.maxLen}).charLimit;D&&x.length>D&&(x=x.slice(0,D));const I={userValue:x,formattedValue:null,valueOnFocus:""};this.data.multiLine?(p=document.createElement("textarea"),p.textContent=x,this.data.doNotScroll&&(p.style.overflowY="hidden")):(p=document.createElement("input"),p.type="text",p.setAttribute("value",x),this.data.doNotScroll&&(p.style.overflowX="hidden")),i.add(p),p.setAttribute("data-element-id",r),p.disabled=this.data.readOnly,p.name=this.data.fieldName,p.tabIndex=y,this._setRequired(p,this.data.required),D&&(p.maxLength=D),p.addEventListener("input",z=>{t.setValue(r,{value:z.target.value}),this.setPropertyOnSiblings(p,"value",z.target.value,"value")}),p.addEventListener("resetform",z=>{p.value=I.userValue=this.data.defaultFieldValue??"",I.formattedValue=null});let W=z=>{const{formattedValue:q}=I;null!=q&&(z.target.value=q),z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){p.addEventListener("focus",q=>{I.userValue&&(q.target.value=I.userValue),I.valueOnFocus=q.target.value}),p.addEventListener("updatefromsandbox",q=>{this._dispatchEventFromSandbox({value(et){I.userValue=et.detail.value??"",t.setValue(r,{value:I.userValue.toString()}),et.target.value=I.userValue},formattedValue(et){const{formattedValue:J}=et.detail;I.formattedValue=J,null!=J&&et.target!==document.activeElement&&(et.target.value=J),t.setValue(r,{formattedValue:J})},selRange(et){et.target.setSelectionRange(...et.detail.selRange)},charLimit:et=>{const{charLimit:J}=et.detail,{target:st}=et;if(0===J)return void st.removeAttribute("maxLength");st.setAttribute("maxLength",J);let it=I.userValue;!it||it.length<=J||(it=it.slice(0,J),st.value=I.userValue=it,t.setValue(r,{value:it}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:it,willCommit:!0,commitKey:1,selStart:st.selectionStart,selEnd:st.selectionEnd}}))}},q)}),p.addEventListener("keydown",q=>{let K=-1;if("Escape"===q.key?K=0:"Enter"===q.key?K=2:"Tab"===q.key&&(K=3),-1===K)return;const{value:et}=q.target;I.valueOnFocus!==et&&(I.userValue=et,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:et,willCommit:!0,commitKey:K,selStart:q.target.selectionStart,selEnd:q.target.selectionEnd}}))});const z=W;W=null,p.addEventListener("blur",q=>{const{value:K}=q.target;I.userValue=K,this._mouseState.isDown&&I.valueOnFocus!==K&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:K,willCommit:!0,commitKey:1,selStart:q.target.selectionStart,selEnd:q.target.selectionEnd}}),z(q)}),this.data.actions?.Keystroke&&p.addEventListener("beforeinput",q=>{const{data:K,target:et}=q,{value:J,selectionStart:st,selectionEnd:it}=et;let at=st,ot=it;switch(q.inputType){case"deleteWordBackward":{const nt=J.substring(0,st).match(/\w*[^\w]*$/);nt&&(at-=nt[0].length);break}case"deleteWordForward":{const nt=J.substring(st).match(/^[^\w]*\w*/);nt&&(ot+=nt[0].length);break}case"deleteContentBackward":st===it&&(at-=1);break;case"deleteContentForward":st===it&&(ot+=1)}q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:J,change:K||"",willCommit:!1,selStart:at,selEnd:ot}})}),this._setEventListeners(p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],q=>q.target.value)}if(W&&p.addEventListener("blur",W),this.data.comb){const q=(this.data.rect[2]-this.data.rect[0])/D;p.classList.add("comb"),p.style.letterSpacing=`calc(${q}px * var(--scale-factor) - 1ch)`}}else p=document.createElement("div"),p.textContent=this.data.fieldValue,p.style.verticalAlign="middle",p.style.display="table-cell";return this._setTextStyle(p),this._setBackgroundColor(p),this._setDefaultPropertiesFromJS(p),this.container.append(p),this.container}}class T extends A{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,r=this.data,p=r.id;let v=t.getValue(p,{value:r.exportValue===r.fieldValue}).value;"string"==typeof v&&(v="Off"!==v,t.setValue(p,{value:v})),this.container.className="buttonWidgetAnnotation checkBox";const x=document.createElement("input");return i.add(x),x.setAttribute("data-element-id",p),x.disabled=r.readOnly,this._setRequired(x,this.data.required),x.type="checkbox",x.name=r.fieldName,v&&x.setAttribute("checked",!0),x.setAttribute("exportValue",r.exportValue),x.tabIndex=y,x.addEventListener("change",D=>{const{name:I,checked:W}=D.target;for(const z of this._getElementsByName(I,p)){const q=W&&z.exportValue===r.exportValue;z.domElement&&(z.domElement.checked=q),t.setValue(z.id,{value:q})}t.setValue(p,{value:W})}),x.addEventListener("resetform",D=>{D.target.checked=(r.defaultFieldValue||"Off")===r.exportValue}),this.enableScripting&&this.hasJSActions&&(x.addEventListener("updatefromsandbox",D=>{this._dispatchEventFromSandbox({value(W){W.target.checked="Off"!==W.detail.value,t.setValue(p,{value:W.target.checked})}},D)}),this._setEventListeners(x,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],D=>D.target.checked)),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class F extends A{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,r=this.data,p=r.id;let v=t.getValue(p,{value:r.fieldValue===r.buttonValue}).value;"string"==typeof v&&(v=v!==r.buttonValue,t.setValue(p,{value:v}));const x=document.createElement("input");if(i.add(x),x.setAttribute("data-element-id",p),x.disabled=r.readOnly,this._setRequired(x,this.data.required),x.type="radio",x.name=r.fieldName,v&&x.setAttribute("checked",!0),x.tabIndex=y,x.addEventListener("change",D=>{const{name:I,checked:W}=D.target;for(const z of this._getElementsByName(I,p))t.setValue(z.id,{value:!1});t.setValue(p,{value:W})}),x.addEventListener("resetform",D=>{const I=r.defaultFieldValue;D.target.checked=null!=I&&I===r.buttonValue}),this.enableScripting&&this.hasJSActions){const D=r.buttonValue;x.addEventListener("updatefromsandbox",I=>{this._dispatchEventFromSandbox({value:z=>{const q=D===z.detail.value;for(const K of this._getElementsByName(z.target.name)){const et=q&&K.id===p;K.domElement&&(K.domElement.checked=et),t.setValue(K.id,{value:et})}}},I)}),this._setEventListeners(x,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.checked)}return this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class _ extends a{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText);const r=t.lastChild;return this.enableScripting&&this.hasJSActions&&r&&(this._setDefaultPropertiesFromJS(r),r.addEventListener("updatefromsandbox",p=>{this._dispatchEventFromSandbox({},p)})),t}}class s extends A{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,r=this.data.id,p=t.getValue(r,{value:this.data.fieldValue}),v=document.createElement("select");i.add(v),v.setAttribute("data-element-id",r),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=y;let x=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",z=>{const q=this.data.defaultFieldValue;for(const K of v.options)K.selected=K.value===q});for(const z of this.data.options){const q=document.createElement("option");q.textContent=z.displayValue,q.value=z.exportValue,p.value.includes(z.exportValue)&&(q.setAttribute("selected",!0),x=!1),v.append(q)}let D=null;if(x){const z=document.createElement("option");z.value=" ",z.setAttribute("hidden",!0),z.setAttribute("selected",!0),v.prepend(z),D=()=>{z.remove(),v.removeEventListener("input",D),D=null},v.addEventListener("input",D)}const I=(z,q)=>{const K=q?"value":"textContent",et=z.target.options;return z.target.multiple?Array.prototype.filter.call(et,J=>J.selected).map(J=>J[K]):-1===et.selectedIndex?null:et[et.selectedIndex][K]},W=z=>Array.prototype.map.call(z.target.options,K=>({displayValue:K.textContent,exportValue:K.value}));return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({value(K){D?.();const et=K.detail.value,J=new Set(Array.isArray(et)?et:[et]);for(const st of v.options)st.selected=J.has(st.value);t.setValue(r,{value:I(K,!0)})},multipleSelection(K){v.multiple=!0},remove(K){const et=v.options,J=K.detail.remove;et[J].selected=!1,v.remove(J),et.length>0&&-1===Array.prototype.findIndex.call(et,it=>it.selected)&&(et[0].selected=!0),t.setValue(r,{value:I(K,!0),items:W(K)})},clear(K){for(;0!==v.length;)v.remove(0);t.setValue(r,{value:null,items:[]})},insert(K){const{index:et,displayValue:J,exportValue:st}=K.detail.insert,it=v.children[et],at=document.createElement("option");at.textContent=J,at.value=st,it?it.before(at):v.append(at),t.setValue(r,{value:I(K,!0),items:W(K)})},items(K){const{items:et}=K.detail;for(;0!==v.length;)v.remove(0);for(const J of et){const{displayValue:st,exportValue:it}=J,at=document.createElement("option");at.textContent=st,at.value=it,v.append(at)}v.options.length>0&&(v.options[0].selected=!0),t.setValue(r,{value:I(K,!0),items:W(K)})},indices(K){const et=new Set(K.detail.indices);for(const J of K.target.options)J.selected=et.has(J.index);t.setValue(r,{value:I(K,!0)})},editable(K){K.target.disabled=!K.detail.editable}},z)}),v.addEventListener("input",z=>{const q=I(z,!0),K=I(z,!1);t.setValue(r,{value:q}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:K,changeEx:q,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],z=>z.target.checked)):v.addEventListener("input",function(z){t.setValue(r,{value:I(z,!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class l extends g{constructor(t){super(t,{isRenderable:!!(t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const p=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(0===p.length)return this.container;const v=new b({container:this.container,trigger:Array.from(p),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),x=this.page,D=n.Util.normalizeRect([this.data.parentRect[0],x.view[3]-this.data.parentRect[1]+x.view[1],this.data.parentRect[2],x.view[3]-this.data.parentRect[3]+x.view[1]]),I=D[0]+this.data.parentRect[2]-this.data.parentRect[0],W=D[1],[z,q,K,et]=this.viewport.viewBox,st=et-q;return this.container.style.left=100*(I-z)/(K-z)+"%",this.container.style.top=100*(W-q)/st+"%",this.container.append(v.render()),this.container}}class b{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const r=document.createElement("div");r.className="popupWrapper",this.hideElement=this.hideWrapper?r:this.container,this.hideElement.hidden=!0;const p=document.createElement("div");p.className="popup";const v=this.color;v&&(p.style.backgroundColor=n.Util.makeHexColor(0|.7*(255-v[0])+v[0],0|.7*(255-v[1])+v[1],0|.7*(255-v[2])+v[2]));const x=document.createElement("h1");x.dir=this.titleObj.dir,x.textContent=this.titleObj.str,p.append(x);const D=f.PDFDateString.toDateObject(this.modificationDate);if(D){const I=document.createElement("span");I.className="popupDate",I.textContent="{{date}}, {{time}}",I.dataset.l10nId="annotation_date_string",I.dataset.l10nArgs=JSON.stringify({date:D.toLocaleDateString(),time:D.toLocaleTimeString()}),p.append(I)}if(!this.richText?.str||this.contentsObj?.str&&this.contentsObj.str!==this.richText.str){const I=this._formatContents(this.contentsObj);p.append(I)}else L.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:p}),p.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const I of this.trigger)I.addEventListener("click",this._toggle.bind(this)),I.addEventListener("mouseover",this._show.bind(this,!1)),I.addEventListener("mouseout",this._hide.bind(this,!1));return p.addEventListener("click",this._hide.bind(this,!0)),r.append(p),r}_formatContents({str:t,dir:r}){const p=document.createElement("p");p.className="popupContent",p.dir=r;const v=t.split(/(?:\r\n?|\n)/);for(let x=0,D=v.length;x<D;++x)p.append(document.createTextNode(v[x])),x<D-1&&p.append(document.createElement("br"));return p}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class w extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const t=document.createElement("div");t.className="annotationTextContent",t.setAttribute("role","comment");for(const r of this.textContent){const p=document.createElement("span");p.textContent=r,t.append(p)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class R extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:r,height:p}=d(t.rect),v=this.svgFactory.create(r,p,!0),x=this.svgFactory.createElement("svg:line");return x.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),x.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),x.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),x.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),x.setAttribute("stroke-width",t.borderStyle.width||1),x.setAttribute("stroke","transparent"),x.setAttribute("fill","transparent"),v.append(x),this.container.append(v),this._createPopup(x,t),this.container}}class j extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:r,height:p}=d(t.rect),v=this.svgFactory.create(r,p,!0),x=t.borderStyle.width,D=this.svgFactory.createElement("svg:rect");return D.setAttribute("x",x/2),D.setAttribute("y",x/2),D.setAttribute("width",r-x),D.setAttribute("height",p-x),D.setAttribute("stroke-width",x||1),D.setAttribute("stroke","transparent"),D.setAttribute("fill","transparent"),v.append(D),this.container.append(v),this._createPopup(D,t),this.container}}class N extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:r,height:p}=d(t.rect),v=this.svgFactory.create(r,p,!0),x=t.borderStyle.width,D=this.svgFactory.createElement("svg:ellipse");return D.setAttribute("cx",r/2),D.setAttribute("cy",p/2),D.setAttribute("rx",r/2-x/2),D.setAttribute("ry",p/2-x/2),D.setAttribute("stroke-width",x||1),D.setAttribute("stroke","transparent"),D.setAttribute("fill","transparent"),v.append(D),this.container.append(v),this._createPopup(D,t),this.container}}class tt extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:r,height:p}=d(t.rect),v=this.svgFactory.create(r,p,!0);let x=[];for(const I of t.vertices)x.push(I.x-t.rect[0]+","+(t.rect[3]-I.y));x=x.join(" ");const D=this.svgFactory.createElement(this.svgElementName);return D.setAttribute("points",x),D.setAttribute("stroke-width",t.borderStyle.width||1),D.setAttribute("stroke","transparent"),D.setAttribute("fill","transparent"),v.append(D),this.container.append(v),this._createPopup(D,t),this.container}}class Z extends tt{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:r,height:p}=d(t.rect),v=this.svgFactory.create(r,p,!0);for(const x of t.inkLists){let D=[];for(const W of x)D.push(`${W.x-t.rect[0]},${t.rect[3]-W.y}`);D=D.join(" ");const I=this.svgFactory.createElement(this.svgElementName);I.setAttribute("points",D),I.setAttribute("stroke-width",t.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),this._createPopup(I,t),v.append(I)}return this.container.append(v),this.container}}class U extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class B extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class X extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class C extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class o extends g{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class c extends g{constructor(t){super(t,{isRenderable:!0});const{filename:r,content:p}=this.data.file;this.filename=(0,f.getFilenameFromUrl)(r),this.content=p,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:r,content:p})}render(){this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.className="popupTriggerArea",t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class S{static#t(t,r,p,v){const x=t.firstChild||t;x.id=`${f.AnnotationPrefix}${r}`,p.append(t),v?.moveElementInDOM(p,t,x,!1)}static render(t){const{annotations:r,div:p,viewport:v,accessibilityManager:x}=t;this.#e(p,v);let D=0;for(const I of r){if(I.annotationType!==n.AnnotationType.POPUP){const{width:z,height:q}=d(I.rect);if(z<=0||q<=0)continue}const W=u.create({data:I,layer:p,page:t.page,viewport:v,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new f.DOMSVGFactory,annotationStorage:t.annotationStorage||new O.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(W.isRenderable){const z=W.render();if(I.hidden&&(z.style.visibility="hidden"),Array.isArray(z))for(const q of z)q.style.zIndex=D++,S.#t(q,I.id,p,x);else z.style.zIndex=D++,W instanceof l?p.prepend(z):S.#t(z,I.id,p,x)}}this.#i(p,t.annotationCanvasMap)}static update(t){const{annotationCanvasMap:r,div:p,viewport:v}=t;this.#e(p,v),this.#i(p,r),p.hidden=!1}static#e(t,{width:r,height:p,rotation:v}){const{style:x}=t,D=v%180!=0,I=Math.floor(r)+"px",W=Math.floor(p)+"px";x.width=D?W:I,x.height=D?I:W,t.setAttribute("data-main-rotation",v)}static#i(t,r){if(r){for(const[p,v]of r){const x=t.querySelector(`[data-annotation-id="${p}"]`);if(!x)continue;const{firstChild:D}=x;D?"CANVAS"===D.nodeName?D.replaceWith(v):D.before(v):x.append(v)}r.clear()}}}e.AnnotationLayer=S},($,e)=>{function E(f){return Math.floor(255*Math.max(0,Math.min(1,f))).toString(16).padStart(2,"0")}Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0,e.ColorConverters=class n{static CMYK_G([O,k,L,y]){return["G",1-Math.min(1,.3*O+.59*L+.11*k+y)]}static G_CMYK([O]){return["CMYK",0,0,0,1-O]}static G_RGB([O]){return["RGB",O,O,O]}static G_HTML([O]){const k=E(O);return`#${k}${k}${k}`}static RGB_G([O,k,L]){return["G",.3*O+.59*k+.11*L]}static RGB_HTML([O,k,L]){return`#${E(O)}${E(k)}${E(L)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([O,k,L,y]){return["RGB",1-Math.min(1,O+y),1-Math.min(1,L+y),1-Math.min(1,k+y)]}static CMYK_HTML(O){const k=this.CMYK_RGB(O).slice(1);return this.RGB_HTML(k)}static RGB_CMYK([O,k,L]){const y=1-O,h=1-k,i=1-L;return["CMYK",y,h,i,Math.min(y,h,i)]}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=E(20);e.XfaLayer=class f{static setupStorage(k,L,y,h,i){const d=h.getValue(L,{value:null});switch(y.name){case"textarea":if(null!==d.value&&(k.textContent=d.value),"print"===i)break;k.addEventListener("input",u=>{h.setValue(L,{value:u.target.value})});break;case"input":if("radio"===y.attributes.type||"checkbox"===y.attributes.type){if(d.value===y.attributes.xfaOn?k.setAttribute("checked",!0):d.value===y.attributes.xfaOff&&k.removeAttribute("checked"),"print"===i)break;k.addEventListener("change",u=>{h.setValue(L,{value:u.target.getAttribute(u.target.checked?"xfaOn":"xfaOff")})})}else{if(null!==d.value&&k.setAttribute("value",d.value),"print"===i)break;k.addEventListener("input",u=>{h.setValue(L,{value:u.target.value})})}break;case"select":if(null!==d.value)for(const u of y.children)u.attributes.value===d.value&&(u.attributes.selected=!0);k.addEventListener("input",u=>{const g=u.target.options;h.setValue(L,{value:-1===g.selectedIndex?"":g[g.selectedIndex].value})})}}static setAttributes({html:k,element:L,storage:y=null,intent:h,linkService:i}){const{attributes:d}=L,u=k instanceof HTMLAnchorElement;"radio"===d.type&&(d.name=`${d.name}-${h}`);for(const[g,a]of Object.entries(d))if(null!=a)switch(g){case"class":a.length&&k.setAttribute(g,a.join(" "));break;case"dataId":break;case"id":k.setAttribute("data-element-id",a);break;case"style":Object.assign(k.style,a);break;case"textContent":k.textContent=a;break;default:(!u||"href"!==g&&"newWindow"!==g)&&k.setAttribute(g,a)}u&&i.addLinkAttributes(k,d.href,d.newWindow),y&&d.dataId&&this.setupStorage(k,d.dataId,L,y)}static render(k){const L=k.annotationStorage,y=k.linkService,h=k.xfaHtml,i=k.intent||"display",d=document.createElement(h.name);h.attributes&&this.setAttributes({html:d,element:h,intent:i,linkService:y});const u=[[h,-1,d]],g=k.div;if(g.append(d),k.viewport){const m=`matrix(${k.viewport.transform.join(",")})`;g.style.transform=m}"richText"!==i&&g.setAttribute("class","xfaLayer xfaFont");const a=[];for(;u.length>0;){const[m,A,M]=u.at(-1);if(A+1===m.children.length){u.pop();continue}const T=m.children[++u.at(-1)[1]];if(null===T)continue;const{name:F}=T;if("#text"===F){const s=document.createTextNode(T.value);a.push(s),M.append(s);continue}let _;if(_=T?.attributes?.xmlns?document.createElementNS(T.attributes.xmlns,F):document.createElement(F),M.append(_),T.attributes&&this.setAttributes({html:_,element:T,storage:L,intent:i,linkService:y}),T.children&&T.children.length>0)u.push([T,-1,_]);else if(T.value){const s=document.createTextNode(T.value);n.XfaText.shouldBuildText(F)&&a.push(s),_.append(s)}}for(const m of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:a}}static update(k){const L=`matrix(${k.viewport.transform.join(",")})`;k.div.style.transform=L,k.div.hidden=!1}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=function T(F){const _=new M({textContent:F.textContent,textContentStream:F.textContentStream,container:F.container,viewport:F.viewport,textDivs:F.textDivs,textContentItemsStr:F.textContentItemsStr,enhanceTextSelection:F.enhanceTextSelection});return _._render(F.timeout),_};var n=E(1),f=E(8);const k=30,y=new Map,h=/^\s+$/g;function d(F,_,s,l){const b=document.createElement("span"),w=F._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==_.str,hasEOL:_.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==_.str,hasEOL:_.hasEOL,fontSize:0};F._textDivs.push(b);const R=n.Util.transform(F._viewport.transform,_.transform);let j=Math.atan2(R[1],R[0]);const N=s[_.fontName];N.vertical&&(j+=Math.PI/2);const tt=Math.hypot(R[2],R[3]),Z=tt*function i(F,_){const s=y.get(F);if(s)return s;_.save(),_.font=`30px ${F}`;const l=_.measureText("");let b=l.fontBoundingBoxAscent,w=Math.abs(l.fontBoundingBoxDescent);if(b){_.restore();const j=b/(b+w);return y.set(F,j),j}_.strokeStyle="red",_.clearRect(0,0,k,k),_.strokeText("g",0,0);let R=_.getImageData(0,0,k,k).data;w=0;for(let j=R.length-1-3;j>=0;j-=4)if(R[j]>0){w=Math.ceil(j/4/k);break}_.clearRect(0,0,k,k),_.strokeText("A",0,k),R=_.getImageData(0,0,k,k).data,b=0;for(let j=0,N=R.length;j<N;j+=4)if(R[j]>0){b=k-Math.floor(j/4/k);break}if(_.restore(),b){const j=b/(b+w);return y.set(F,j),j}return y.set(F,.8),.8}(N.fontFamily,l);let Y,V;0===j?(Y=R[4],V=R[5]-Z):(Y=R[4]+Z*Math.sin(j),V=R[5]-Z*Math.cos(j)),b.style.left=`${Y}px`,b.style.top=`${V}px`,b.style.fontSize=`${tt}px`,b.style.fontFamily=N.fontFamily,w.fontSize=tt,b.setAttribute("role","presentation"),b.textContent=_.str,b.dir=_.dir,F._fontInspectorEnabled&&(b.dataset.fontName=_.fontName),0!==j&&(w.angle=j*(180/Math.PI));let U=!1;if(_.str.length>1||F._enhanceTextSelection&&h.test(_.str))U=!0;else if(" "!==_.str&&_.transform[0]!==_.transform[3]){const B=Math.abs(_.transform[0]),X=Math.abs(_.transform[3]);B!==X&&Math.max(B,X)/Math.min(B,X)>1.5&&(U=!0)}if(U&&(w.canvasWidth=N.vertical?_.height*F._viewport.scale:_.width*F._viewport.scale),F._textDivProperties.set(b,w),F._textContentStream&&F._layoutText(b),F._enhanceTextSelection&&w.hasText){let B=1,X=0;0!==j&&(B=Math.cos(j),X=Math.sin(j));const C=(N.vertical?_.height:_.width)*F._viewport.scale,o=tt;let c,S;0!==j?(c=[B,X,-X,B,Y,V],S=n.Util.getAxialAlignedBoundingBox([0,0,C,o],c)):S=[Y,V,Y+C,V+o],F._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:b,size:[C,o],m:c})}}function u(F){if(F._canceled)return;const _=F._textDivs,s=F._capability,l=_.length;if(l>1e5)return F._renderingDone=!0,void s.resolve();if(!F._textContentStream)for(let b=0;b<l;b++)F._layoutText(_[b]);F._renderingDone=!0,s.resolve()}function g(F,_,s){let l=0;for(let b=0;b<s;b++){const w=F[_++];w>0&&(l=l?Math.min(w,l):w)}return l}function A(F,_){_.sort(function(b,w){return b.x1-w.x1||b.index-w.index});const l=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const b of _){let w=0;for(;w<l.length&&l[w].end<=b.y1;)w++;let R=l.length-1;for(;R>=0&&l[R].start>=b.y2;)R--;let j,N,tt,Z,Y=-1/0;for(tt=w;tt<=R;tt++){let B;j=l[tt],N=j.boundary,B=N.x2>b.x1?N.index>b.index?N.x1New:b.x1:void 0===N.x2New?(N.x2+b.x1)/2:N.x2New,B>Y&&(Y=B)}for(b.x1New=Y,tt=w;tt<=R;tt++)j=l[tt],N=j.boundary,void 0===N.x2New?N.x2>b.x1?N.index>b.index&&(N.x2New=N.x2):N.x2New=Y:N.x2New>Y&&(N.x2New=Math.max(Y,N.x2));const V=[];let U=null;for(tt=w;tt<=R;tt++){j=l[tt],N=j.boundary;const B=N.x2>b.x2?N:b;U===B?V.at(-1).end=j.end:(V.push({start:j.start,end:j.end,boundary:B}),U=B)}for(l[w].start<b.y1&&(V[0].start=b.y1,V.unshift({start:l[w].start,end:b.y1,boundary:l[w].boundary})),b.y2<l[R].end&&(V.at(-1).end=b.y2,V.push({start:b.y2,end:l[R].end,boundary:l[R].boundary})),tt=w;tt<=R;tt++){if(j=l[tt],N=j.boundary,void 0!==N.x2New)continue;let B=!1;for(Z=w-1;!B&&Z>=0&&l[Z].start>=N.y1;Z--)B=l[Z].boundary===N;for(Z=R+1;!B&&Z<l.length&&l[Z].end<=N.y2;Z++)B=l[Z].boundary===N;for(Z=0;!B&&Z<V.length;Z++)B=V[Z].boundary===N;B||(N.x2New=Y)}Array.prototype.splice.apply(l,[w,R-w+1,...V])}for(const b of l){const w=b.boundary;void 0===w.x2New&&(w.x2New=Math.max(F,w.x2))}}class M{constructor({textContent:_,textContentStream:s,container:l,viewport:b,textDivs:w,textContentItemsStr:R,enhanceTextSelection:j}){j&&(0,f.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=_,this._textContentStream=s,this._container=l,this._document=l.ownerDocument,this._viewport=b,this._textDivs=w||[],this._textContentItemsStr=R||[],this._enhanceTextSelection=!!j,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(_,s){for(let l=0,b=_.length;l<b;l++)if(void 0!==_[l].str)this._textContentItemsStr.push(_[l].str),d(this,_[l],s,this._layoutTextCtx);else if("beginMarkedContentProps"===_[l].type||"beginMarkedContent"===_[l].type){const w=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==_[l].id&&this._container.setAttribute("id",`${_[l].id}`),w.append(this._container)}else"endMarkedContent"===_[l].type&&(this._container=this._container.parentNode)}_layoutText(_){const s=this._textDivProperties.get(_);let l="";if(0!==s.canvasWidth&&s.hasText){const{fontFamily:b}=_.style,{fontSize:w}=s;(w!==this._layoutTextLastFontSize||b!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${w*this._devicePixelRatio}px ${b}`,this._layoutTextLastFontSize=w,this._layoutTextLastFontFamily=b);const{width:R}=this._layoutTextCtx.measureText(_.textContent);if(R>0){const j=this._devicePixelRatio*s.canvasWidth/R;this._enhanceTextSelection&&(s.scale=j),l=`scaleX(${j})`}}if(0!==s.angle&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(this._enhanceTextSelection&&(s.originalTransform=l),_.style.transform=l),s.hasText&&this._container.append(_),s.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this._container.append(b)}}_render(_=0){const s=(0,n.createPromiseCapability)();let l=Object.create(null);const b=this._document.createElement("canvas");if(b.height=b.width=k,this._layoutTextCtx=b.getContext("2d",{alpha:!1}),this._textContent)this._processItems(this._textContent.items,this._textContent.styles),s.resolve();else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const w=()=>{this._reader.read().then(({value:R,done:j})=>{j?s.resolve():(Object.assign(l,R.styles),this._processItems(R.items,l),w())},s.reject)};this._reader=this._textContentStream.getReader(),w()}}s.promise.then(()=>{l=null,_?this._renderTimer=setTimeout(()=>{u(this),this._renderTimer=null},_):u(this)},this._capability.reject)}expandTextDivs(_=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(function a(F){const _=F._bounds,s=F._viewport,l=function m(F,_,s){const l=s.map(function(w,R){return{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom,index:R,x1New:void 0,x2New:void 0}});A(F,l);const b=new Array(s.length);for(const w of l)b[w.index]={left:w.x1New,top:0,right:w.x2New,bottom:0};s.map(function(w,R){const j=b[R],N=l[R];N.x1=w.top,N.y1=F-j.right,N.x2=w.bottom,N.y2=F-j.left,N.index=R,N.x1New=void 0,N.x2New=void 0}),A(_,l);for(const w of l){const R=w.index;b[R].top=w.x1New,b[R].bottom=w.x2New}return b}(s.width,s.height,_);for(let b=0;b<l.length;b++){const w=_[b].div,R=F._textDivProperties.get(w);if(0===R.angle){R.paddingLeft=_[b].left-l[b].left,R.paddingTop=_[b].top-l[b].top,R.paddingRight=l[b].right-_[b].right,R.paddingBottom=l[b].bottom-_[b].bottom,F._textDivProperties.set(w,R);continue}const j=l[b],N=_[b],tt=N.m,Z=tt[0],Y=tt[1],V=[[0,0],[0,N.size[1]],[N.size[0],0],N.size],U=new Float64Array(64);for(let X=0,C=V.length;X<C;X++){const o=n.Util.applyTransform(V[X],tt);U[X+0]=Z&&(j.left-o[0])/Z,U[X+4]=Y&&(j.top-o[1])/Y,U[X+8]=Z&&(j.right-o[0])/Z,U[X+12]=Y&&(j.bottom-o[1])/Y,U[X+16]=Y&&(j.left-o[0])/-Y,U[X+20]=Z&&(j.top-o[1])/Z,U[X+24]=Y&&(j.right-o[0])/-Y,U[X+28]=Z&&(j.bottom-o[1])/Z,U[X+32]=Z&&(j.left-o[0])/-Z,U[X+36]=Y&&(j.top-o[1])/-Y,U[X+40]=Z&&(j.right-o[0])/-Z,U[X+44]=Y&&(j.bottom-o[1])/-Y,U[X+48]=Y&&(j.left-o[0])/Y,U[X+52]=Z&&(j.top-o[1])/-Z,U[X+56]=Y&&(j.right-o[0])/Y,U[X+60]=Z&&(j.bottom-o[1])/-Z}const B=1+Math.min(Math.abs(Z),Math.abs(Y));R.paddingLeft=g(U,32,16)/B,R.paddingTop=g(U,48,16)/B,R.paddingRight=g(U,0,16)/B,R.paddingBottom=g(U,16,16)/B,F._textDivProperties.set(w,R)}}(this),this._bounds=null);const s=[],l=[];for(let b=0,w=this._textDivs.length;b<w;b++){const R=this._textDivs[b],j=this._textDivProperties.get(R);j.hasText&&(_?(s.length=0,l.length=0,j.originalTransform&&s.push(j.originalTransform),j.paddingTop>0?(l.push(`${j.paddingTop}px`),s.push(`translateY(${-j.paddingTop}px)`)):l.push(0),l.push(j.paddingRight>0?j.paddingRight/j.scale+"px":0),l.push(j.paddingBottom>0?`${j.paddingBottom}px`:0),j.paddingLeft>0?(l.push(j.paddingLeft/j.scale+"px"),s.push(`translateX(${-j.paddingLeft/j.scale}px)`)):l.push(0),R.style.padding=l.join(" "),s.length&&(R.style.transform=s.join(" "))):(R.style.padding=null,R.style.transform=j.originalTransform))}}}e.TextLayerRenderTask=M},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=E(8),f=E(1),O=E(3);let k=class{constructor(){(0,f.unreachable)("Not implemented: SVGGraphics")}};e.SVGGraphics=k;{let m=function(s){let l=[];const b=[];for(const w of s)"save"!==w.fn?"restore"===w.fn?l=b.pop():l.push(w):(l.push({fnId:92,fn:"group",items:[]}),b.push(l),l=l.at(-1).items);return l},A=function(s){if(Number.isInteger(s))return s.toString();const l=s.toFixed(10);let b=l.length-1;if("0"!==l[b])return l;do{b--}while("0"===l[b]);return l.substring(0,"."===l[b]?b:b+1)},M=function(s){if(0===s[4]&&0===s[5]){if(0===s[1]&&0===s[2])return 1===s[0]&&1===s[3]?"":`scale(${A(s[0])} ${A(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2]){const l=180*Math.acos(s[0])/Math.PI;return`rotate(${A(l)})`}}else if(1===s[0]&&0===s[1]&&0===s[2]&&1===s[3])return`translate(${A(s[4])} ${A(s[5])})`;return`matrix(${A(s[0])} ${A(s[1])} ${A(s[2])} ${A(s[3])} ${A(s[4])} ${A(s[5])})`};const L={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},y="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",i=["butt","round","square"],d=["miter","round","bevel"],u=function(s,l="",b=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!b)return URL.createObjectURL(new Blob([s],{type:l}));const w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let R=`data:${l};base64,`;for(let j=0,N=s.length;j<N;j+=3){const tt=255&s[j],Z=255&s[j+1],Y=255&s[j+2];R+=w[tt>>2]+w[(3&tt)<<4|Z>>4]+w[j+1<N?(15&Z)<<2|Y>>6:64]+w[j+2<N?63&Y:64]}return R},g=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),b=new Int32Array(256);for(let Y=0;Y<256;Y++){let V=Y;for(let U=0;U<8;U++)V=1&V?3988292384^V>>1&2147483647:V>>1&2147483647;b[Y]=V}function R(Y,V,U,B){let X=B;const C=V.length;U[X]=C>>24&255,U[X+1]=C>>16&255,U[X+2]=C>>8&255,U[X+3]=255&C,X+=4,U[X]=255&Y.charCodeAt(0),U[X+1]=255&Y.charCodeAt(1),U[X+2]=255&Y.charCodeAt(2),U[X+3]=255&Y.charCodeAt(3),X+=4,U.set(V,X),X+=V.length;const o=function w(Y,V,U){let B=-1;for(let X=V;X<U;X++)B=B>>>8^b[255&(B^Y[X])];return~B}(U,B+4,X);U[X]=o>>24&255,U[X+1]=o>>16&255,U[X+2]=o>>8&255,U[X+3]=255&o}function tt(Y){let V=Y.length;const U=65535,B=Math.ceil(V/U),X=new Uint8Array(2+V+5*B+4);let C=0;X[C++]=120,X[C++]=156;let o=0;for(;V>U;)X[C++]=0,X[C++]=255,X[C++]=255,X[C++]=0,X[C++]=0,X.set(Y.subarray(o,o+U),C),C+=U,o+=U,V-=U;X[C++]=1,X[C++]=255&V,X[C++]=V>>8&255,X[C++]=255&~V,X[C++]=(65535&~V)>>8&255,X.set(Y.subarray(o),C),C+=Y.length-o;const c=function j(Y,V,U){let B=1,X=0;for(let C=V;C<U;++C)B=(B+(255&Y[C]))%65521,X=(X+B)%65521;return X<<16|B}(Y,0,Y.length);return X[C++]=c>>24&255,X[C++]=c>>16&255,X[C++]=c>>8&255,X[C++]=255&c,X}return function(V,U,B){return function Z(Y,V,U,B){const X=Y.width,C=Y.height;let o,c,S;const P=Y.data;switch(V){case f.ImageKind.GRAYSCALE_1BPP:c=0,o=1,S=X+7>>3;break;case f.ImageKind.RGB_24BPP:c=2,o=8,S=3*X;break;case f.ImageKind.RGBA_32BPP:c=6,o=8,S=4*X;break;default:throw new Error("invalid format")}const t=new Uint8Array((1+S)*C);let r=0,p=0;for(let z=0;z<C;++z)t[r++]=0,t.set(P.subarray(p,p+S),r),p+=S,r+=S;if(V===f.ImageKind.GRAYSCALE_1BPP&&B){r=0;for(let z=0;z<C;z++){r++;for(let q=0;q<S;q++)t[r++]^=255}}const v=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,255&X,C>>24&255,C>>16&255,C>>8&255,255&C,o,c,0,0,0]),x=function N(Y){if(!O.isNodeJS)return tt(Y);try{let V;V=parseInt(process.versions.node)>=8?Y:Buffer.from(Y);const U=__webpack_require__(82787).deflateSync(V,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(V){(0,f.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+V)}return tt(Y)}(t),I=new Uint8Array(s.length+36+v.length+x.length);let W=0;return I.set(s,W),W+=s.length,R("IHDR",v,I,W),W+=12+v.length,R("IDATA",x,I,W),W+=12+x.length,R("IEND",new Uint8Array(0),I,W),u(I,"image/png",U)}(V,void 0===V.kind?f.ImageKind.GRAYSCALE_1BPP:V.kind,U,B)}}();class a{constructor(){this.fontSizeScale=1,this.fontWeight=L.fontWeight,this.fontSize=0,this.textMatrix=f.IDENTITY_MATRIX,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=f.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=L.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,b){this.x=l,this.y=b}}let T=0,F=0,_=0;e.SVGGraphics=k=class{constructor(s,l,b=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new a,this.transformMatrix=f.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!b,this._operatorIdMapping=[];for(const w in f.OPS)this._operatorIdMapping[f.OPS[w]]=w}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const l=s.fnArray,b=s.argsArray;for(let w=0,R=l.length;w<R;w++)if(l[w]===f.OPS.dependency)for(const j of b[w]){const N=j.startsWith("g_")?this.commonObjs:this.objs,tt=new Promise(Z=>{N.get(j,Z)});this.current.dependencies.push(tt)}return Promise.all(this.current.dependencies)}transform(s,l,b,w,R,j){this.transformMatrix=f.Util.transform(this.transformMatrix,[s,l,b,w,R,j]),this.tgrp=null}getSVG(s,l){this.viewport=l;const b=this._initialize(l);return this.loadDependencies(s).then(()=>(this.transformMatrix=f.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),b))}convertOpList(s){const l=this._operatorIdMapping,b=s.argsArray,w=s.fnArray,R=[];for(let j=0,N=w.length;j<N;j++){const tt=w[j];R.push({fnId:tt,fn:l[tt],args:b[j]})}return m(R)}executeOpTree(s){for(const l of s){const b=l.fn,R=l.args;switch(0|l.fnId){case f.OPS.beginText:this.beginText();break;case f.OPS.dependency:break;case f.OPS.setLeading:this.setLeading(R);break;case f.OPS.setLeadingMoveText:this.setLeadingMoveText(R[0],R[1]);break;case f.OPS.setFont:this.setFont(R);break;case f.OPS.showText:case f.OPS.showSpacedText:this.showText(R[0]);break;case f.OPS.endText:this.endText();break;case f.OPS.moveText:this.moveText(R[0],R[1]);break;case f.OPS.setCharSpacing:this.setCharSpacing(R[0]);break;case f.OPS.setWordSpacing:this.setWordSpacing(R[0]);break;case f.OPS.setHScale:this.setHScale(R[0]);break;case f.OPS.setTextMatrix:this.setTextMatrix(R[0],R[1],R[2],R[3],R[4],R[5]);break;case f.OPS.setTextRise:this.setTextRise(R[0]);break;case f.OPS.setTextRenderingMode:this.setTextRenderingMode(R[0]);break;case f.OPS.setLineWidth:this.setLineWidth(R[0]);break;case f.OPS.setLineJoin:this.setLineJoin(R[0]);break;case f.OPS.setLineCap:this.setLineCap(R[0]);break;case f.OPS.setMiterLimit:this.setMiterLimit(R[0]);break;case f.OPS.setFillRGBColor:this.setFillRGBColor(R[0],R[1],R[2]);break;case f.OPS.setStrokeRGBColor:this.setStrokeRGBColor(R[0],R[1],R[2]);break;case f.OPS.setStrokeColorN:this.setStrokeColorN(R);break;case f.OPS.setFillColorN:this.setFillColorN(R);break;case f.OPS.shadingFill:this.shadingFill(R[0]);break;case f.OPS.setDash:this.setDash(R[0],R[1]);break;case f.OPS.setRenderingIntent:this.setRenderingIntent(R[0]);break;case f.OPS.setFlatness:this.setFlatness(R[0]);break;case f.OPS.setGState:this.setGState(R[0]);break;case f.OPS.fill:this.fill();break;case f.OPS.eoFill:this.eoFill();break;case f.OPS.stroke:this.stroke();break;case f.OPS.fillStroke:this.fillStroke();break;case f.OPS.eoFillStroke:this.eoFillStroke();break;case f.OPS.clip:this.clip("nonzero");break;case f.OPS.eoClip:this.clip("evenodd");break;case f.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case f.OPS.paintImageXObject:this.paintImageXObject(R[0]);break;case f.OPS.paintInlineImageXObject:this.paintInlineImageXObject(R[0]);break;case f.OPS.paintImageMaskXObject:this.paintImageMaskXObject(R[0]);break;case f.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(R[0],R[1]);break;case f.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case f.OPS.closePath:this.closePath();break;case f.OPS.closeStroke:this.closeStroke();break;case f.OPS.closeFillStroke:this.closeFillStroke();break;case f.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case f.OPS.nextLine:this.nextLine();break;case f.OPS.transform:this.transform(R[0],R[1],R[2],R[3],R[4],R[5]);break;case f.OPS.constructPath:this.constructPath(R[0],R[1]);break;case f.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,f.warn)(`Unimplemented operator ${b}`)}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,l,b,w,R,j){const N=this.current;N.textMatrix=N.lineMatrix=[s,l,b,w,R,j],N.textMatrixScale=Math.hypot(s,l),N.x=N.lineX=0,N.y=N.lineY=0,N.xcoords=[],N.ycoords=[],N.tspan=this.svgFactory.createElement("svg:tspan"),N.tspan.setAttributeNS(null,"font-family",N.fontFamily),N.tspan.setAttributeNS(null,"font-size",`${A(N.fontSize)}px`),N.tspan.setAttributeNS(null,"y",A(-N.y)),N.txtElement=this.svgFactory.createElement("svg:text"),N.txtElement.append(N.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=f.IDENTITY_MATRIX,s.lineMatrix=f.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,l){const b=this.current;b.x=b.lineX+=s,b.y=b.lineY+=l,b.xcoords=[],b.ycoords=[],b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${A(b.fontSize)}px`),b.tspan.setAttributeNS(null,"y",A(-b.y))}showText(s){const l=this.current,b=l.font,w=l.fontSize;if(0===w)return;const R=l.fontSizeScale,j=l.charSpacing,N=l.wordSpacing,tt=l.fontDirection,Z=l.textHScale*tt,Y=b.vertical,V=Y?1:-1,U=b.defaultVMetrics,B=w*l.fontMatrix[0];let X=0;for(const c of s){if(null===c){X+=tt*N;continue}if("number"==typeof c){X+=V*c*w/1e3;continue}const S=(c.isSpace?N:0)+j,P=c.fontChar;let t,r,v,p=c.width;if(Y){let x;const D=c.vmetric||U;x=c.vmetric?D[1]:.5*p,x=-x*B,p=D?-D[0]:p,t=x/R,r=(X+D[2]*B)/R}else t=X/R,r=0;(c.isInFont||b.missingFile)&&(l.xcoords.push(l.x+t),Y&&l.ycoords.push(-l.y+r),l.tspan.textContent+=P),v=Y?p*B-S*tt:p*B+S*tt,X+=v}l.tspan.setAttributeNS(null,"x",l.xcoords.map(A).join(" ")),l.tspan.setAttributeNS(null,"y",Y?l.ycoords.map(A).join(" "):A(-l.y)),Y?l.y-=X:l.x+=X*Z,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${A(l.fontSize)}px`),l.fontStyle!==L.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==L.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const C=l.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;C===f.TextRenderingMode.FILL||C===f.TextRenderingMode.FILL_STROKE?(l.fillColor!==L.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.tspan.setAttributeNS(null,"fill",l.textRenderingMode===f.TextRenderingMode.ADD_TO_PATH?"transparent":"none"),(C===f.TextRenderingMode.STROKE||C===f.TextRenderingMode.FILL_STROKE)&&this._setStrokeAttributes(l.tspan,1/(l.textMatrixScale||1));let o=l.textMatrix;0!==l.textRise&&(o=o.slice(),o[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${M(o)} scale(${A(Z)}, -1)`),l.txtElement.setAttributeNS(y,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(s,l){this.setLeading(-l),this.moveText(s,l)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=u(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${l}); }\n`}setFont(s){const l=this.current,b=this.commonObjs.get(s[0]);let w=s[1];l.font=b,this.embedFonts&&!b.missingFile&&!this.embeddedFonts[b.loadedName]&&(this.addFontStyle(b),this.embeddedFonts[b.loadedName]=b),l.fontMatrix=b.fontMatrix||f.FONT_IDENTITY_MATRIX;let R="normal";b.black?R="900":b.bold&&(R="bold");const j=b.italic?"italic":"normal";w<0?(w=-w,l.fontDirection=-1):l.fontDirection=1,l.fontSize=w,l.fontFamily=b.loadedName,l.fontWeight=R,l.fontStyle=j,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",A(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){const s=this.current;s.textRenderingMode&f.TextRenderingMode.ADD_TO_PATH_FLAG&&s.txtElement?.hasChildNodes()&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=i[s]}setLineJoin(s){this.current.lineJoin=d[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,l,b){this.current.strokeColor=f.Util.makeHexColor(s,l,b)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,l,b){this.current.fillColor=f.Util.makeHexColor(s,l,b),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const l=this.viewport.width,b=this.viewport.height,w=f.Util.inverseTransform(this.transformMatrix),R=f.Util.applyTransform([0,0],w),j=f.Util.applyTransform([0,b],w),N=f.Util.applyTransform([l,0],w),tt=f.Util.applyTransform([l,b],w),Z=Math.min(R[0],j[0],N[0],tt[0]),Y=Math.min(R[1],j[1],N[1],tt[1]),V=Math.max(R[0],j[0],N[0],tt[0]),U=Math.max(R[1],j[1],N[1],tt[1]),B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x",Z),B.setAttributeNS(null,"y",Y),B.setAttributeNS(null,"width",V-Z),B.setAttributeNS(null,"height",U-Y),B.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&B.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(B)}_makeColorN_Pattern(s){return"TilingPattern"===s[0]?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const l=s[1],b=s[2],w=s[3]||f.IDENTITY_MATRIX,[R,j,N,tt]=s[4],Z=s[5],Y=s[6],V=s[7],U="shading"+_++,[B,X,C,o]=f.Util.normalizeRect([...f.Util.applyTransform([R,j],w),...f.Util.applyTransform([N,tt],w)]),[c,S]=f.Util.singularValueDecompose2dScale(w),P=Z*c,t=Y*S,r=this.svgFactory.createElement("svg:pattern");r.setAttributeNS(null,"id",U),r.setAttributeNS(null,"patternUnits","userSpaceOnUse"),r.setAttributeNS(null,"width",P),r.setAttributeNS(null,"height",t),r.setAttributeNS(null,"x",`${B}`),r.setAttributeNS(null,"y",`${X}`);const p=this.svg,v=this.transformMatrix,x=this.current.fillColor,D=this.current.strokeColor,I=this.svgFactory.create(C-B,o-X);if(this.svg=I,this.transformMatrix=w,2===V){const W=f.Util.makeHexColor(...l);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(b)),this.svg=p,this.transformMatrix=v,this.current.fillColor=x,this.current.strokeColor=D,r.append(I.childNodes[0]),this.defs.append(r),`url(#${U})`}_makeShadingPattern(s){switch("string"==typeof s&&(s=this.objs.get(s)),s[0]){case"RadialAxial":const l="shading"+_++,b=s[3];let w;switch(s[1]){case"axial":const R=s[4],j=s[5];w=this.svgFactory.createElement("svg:linearGradient"),w.setAttributeNS(null,"id",l),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"x1",R[0]),w.setAttributeNS(null,"y1",R[1]),w.setAttributeNS(null,"x2",j[0]),w.setAttributeNS(null,"y2",j[1]);break;case"radial":const N=s[4],tt=s[5],Z=s[6],Y=s[7];w=this.svgFactory.createElement("svg:radialGradient"),w.setAttributeNS(null,"id",l),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"cx",tt[0]),w.setAttributeNS(null,"cy",tt[1]),w.setAttributeNS(null,"r",Y),w.setAttributeNS(null,"fx",N[0]),w.setAttributeNS(null,"fy",N[1]),w.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const R of b){const j=this.svgFactory.createElement("svg:stop");j.setAttributeNS(null,"offset",R[0]),j.setAttributeNS(null,"stop-color",R[1]),w.append(j)}return this.defs.append(w),`url(#${l})`;case"Mesh":return(0,f.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,l){this.current.dashArray=s,this.current.dashPhase=l}constructPath(s,l){const b=this.current;let w=b.x,R=b.y,j=[],N=0;for(const tt of s)switch(0|tt){case f.OPS.rectangle:w=l[N++],R=l[N++];const V=w+l[N++],U=R+l[N++];j.push("M",A(w),A(R),"L",A(V),A(R),"L",A(V),A(U),"L",A(w),A(U),"Z");break;case f.OPS.moveTo:w=l[N++],R=l[N++],j.push("M",A(w),A(R));break;case f.OPS.lineTo:w=l[N++],R=l[N++],j.push("L",A(w),A(R));break;case f.OPS.curveTo:w=l[N+4],R=l[N+5],j.push("C",A(l[N]),A(l[N+1]),A(l[N+2]),A(l[N+3]),A(w),A(R)),N+=6;break;case f.OPS.curveTo2:j.push("C",A(w),A(R),A(l[N]),A(l[N+1]),A(l[N+2]),A(l[N+3])),w=l[N+2],R=l[N+3],N+=4;break;case f.OPS.curveTo3:w=l[N+2],R=l[N+3],j.push("C",A(l[N]),A(l[N+1]),A(w),A(R),A(w),A(R)),N+=4;break;case f.OPS.closePath:j.push("Z")}j=j.join(" "),b.path&&s.length>0&&s[0]!==f.OPS.rectangle&&s[0]!==f.OPS.moveTo?j=b.path.getAttributeNS(null,"d")+j:(b.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(b.path)),b.path.setAttributeNS(null,"d",j),b.path.setAttributeNS(null,"fill","none"),b.element=b.path,b.setCurrentPoint(w,R)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element)return void(this.pendingClip=null);const l="clippath"+T++,b=this.svgFactory.createElement("svg:clipPath");b.setAttributeNS(null,"id",l),b.setAttributeNS(null,"transform",M(this.transformMatrix));const w=s.element.cloneNode(!0);if(w.setAttributeNS(null,"clip-rule","evenodd"===this.pendingClip?"evenodd":"nonzero"),this.pendingClip=null,b.append(w),this.defs.append(b),s.activeClipUrl){s.clipGroup=null;for(const R of this.extraStack)R.clipGroup=null;b.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const l=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",l)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[l,b]of s)switch(l){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b);break;case"CA":this.setStrokeAlpha(b);break;case"ca":this.setFillAlpha(b);break;default:(0,f.warn)(`Unimplemented graphic state operator ${l}`)}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,l=1){const b=this.current;let w=b.dashArray;1!==l&&w.length>0&&(w=w.map(function(R){return l*R})),s.setAttributeNS(null,"stroke",b.strokeColor),s.setAttributeNS(null,"stroke-opacity",b.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",A(b.miterLimit)),s.setAttributeNS(null,"stroke-linecap",b.lineCap),s.setAttributeNS(null,"stroke-linejoin",b.lineJoin),s.setAttributeNS(null,"stroke-width",A(l*b.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",w.map(A).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",A(l*b.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(s)}paintImageXObject(s){const l=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);l?this.paintInlineImageXObject(l):(0,f.warn)(`Dependent image with object ID ${s} is not ready yet`)}paintInlineImageXObject(s,l){const b=s.width,w=s.height,R=g(s,this.forceDataSchema,!!l),j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x","0"),j.setAttributeNS(null,"y","0"),j.setAttributeNS(null,"width",A(b)),j.setAttributeNS(null,"height",A(w)),this.current.element=j,this.clip("nonzero");const N=this.svgFactory.createElement("svg:image");N.setAttributeNS(h,"xlink:href",R),N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y",A(-w)),N.setAttributeNS(null,"width",A(b)+"px"),N.setAttributeNS(null,"height",A(w)+"px"),N.setAttributeNS(null,"transform",`scale(${A(1/b)} ${A(-1/w)})`),l?l.append(N):this._ensureTransformGroup().append(N)}paintImageMaskXObject(s){const l=this.current,b=s.width,w=s.height,R=l.fillColor;l.maskId="mask"+F++;const j=this.svgFactory.createElement("svg:mask");j.setAttributeNS(null,"id",l.maskId);const N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",A(b)),N.setAttributeNS(null,"height",A(w)),N.setAttributeNS(null,"fill",R),N.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(j),this._ensureTransformGroup().append(N),this.paintInlineImageXObject(s,j)}paintFormXObjectBegin(s,l){if(Array.isArray(s)&&6===s.length&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),l){const b=l[2]-l[0],w=l[3]-l[1],R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x",l[0]),R.setAttributeNS(null,"y",l[1]),R.setAttributeNS(null,"width",A(b)),R.setAttributeNS(null,"height",A(w)),this.current.element=R,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const l=this.svgFactory.create(s.width,s.height),b=this.svgFactory.createElement("svg:defs");l.append(b),this.defs=b;const w=this.svgFactory.createElement("svg:g");return w.setAttributeNS(null,"transform",M(s.transform)),l.append(w),this.svg=w,l}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",M(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=E(1),f=E(33);const O=__webpack_require__(23237),k=__webpack_require__(97492),L=__webpack_require__(31815),y=__webpack_require__(66671),h=/^file:\/\/\/[a-zA-Z]:\//;e.PDFNodeStream=class d{constructor(_){this.source=_,this.url=function i(F){const _=y.parse(F);return"file:"===_.protocol||_.host?_:/^[a-z]:[/\\]/i.test(F)?y.parse(`file:///${F}`):(_.host||(_.protocol="file:"),_)}(_.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new M(this):new m(this),this._fullRequestReader}getRangeReader(_,s){if(s<=this._progressiveDataLength)return null;const l=this.isFsUrl?new T(this,_,s):new A(this,_,s);return this._rangeRequestReaders.push(l),l}cancelAllRequests(_){this._fullRequestReader&&this._fullRequestReader.cancel(_);for(const s of this._rangeRequestReaders.slice(0))s.cancel(_)}};class u{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null;const s=_.source;this._contentLength=s.length,this._loaded=0,this._filename=null,this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var _=this;return _asyncToGenerator(function*(){if(yield _._readCapability.promise,_._done)return{value:void 0,done:!0};if(_._storedError)throw _._storedError;const s=_._readableStream.read();return null===s?(_._readCapability=(0,n.createPromiseCapability)(),_.read()):(_._loaded+=s.length,_.onProgress&&_.onProgress({loaded:_._loaded,total:_._contentLength}),{value:new Uint8Array(s).buffer,done:!1})})()}cancel(_){this._readableStream?this._readableStream.destroy(_):this._error(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",s=>{this._error(s)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class g{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!_.source.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){var _=this;return _asyncToGenerator(function*(){if(yield _._readCapability.promise,_._done)return{value:void 0,done:!0};if(_._storedError)throw _._storedError;const s=_._readableStream.read();return null===s?(_._readCapability=(0,n.createPromiseCapability)(),_.read()):(_._loaded+=s.length,_.onProgress&&_.onProgress({loaded:_._loaded}),{value:new Uint8Array(s).buffer,done:!1})})()}cancel(_){this._readableStream?this._readableStream.destroy(_):this._error(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",s=>{this._error(s)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function a(F,_){return{protocol:F.protocol,auth:F.auth,host:F.hostname,port:F.port,path:F.path,method:"GET",headers:_}}class m extends u{constructor(_){super(_);const s=l=>{if(404===l.statusCode){const j=new n.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=j,void this._headersCapability.reject(j)}this._headersCapability.resolve(),this._setReadableStream(l);const b=j=>this._readableStream.headers[j.toLowerCase()],{allowRangeRequests:w,suggestedLength:R}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:b,isHttp:_.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=R||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(b)};this._request=null,this._request="http:"===this._url.protocol?k.request(a(this._url,_.httpHeaders),s):L.request(a(this._url,_.httpHeaders),s),this._request.on("error",l=>{this._storedError=l,this._headersCapability.reject(l)}),this._request.end()}}class A extends g{constructor(_,s,l){super(_),this._httpHeaders={};for(const w in _.httpHeaders){const R=_.httpHeaders[w];typeof R>"u"||(this._httpHeaders[w]=R)}this._httpHeaders.Range=`bytes=${s}-${l-1}`;const b=w=>{if(404!==w.statusCode)this._setReadableStream(w);else{const R=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R}};this._request=null,this._request="http:"===this._url.protocol?k.request(a(this._url,this._httpHeaders),b):L.request(a(this._url,this._httpHeaders),b),this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class M extends u{constructor(_){super(_);let s=decodeURIComponent(this._url.path);h.test(this._url.href)&&(s=s.replace(/^\//,"")),O.lstat(s,(l,b)=>{if(l)return"ENOENT"===l.code&&(l=new n.MissingPDFException(`Missing PDF "${s}".`)),this._storedError=l,void this._headersCapability.reject(l);this._contentLength=b.size,this._setReadableStream(O.createReadStream(s)),this._headersCapability.resolve()})}}class T extends g{constructor(_,s,l){super(_);let b=decodeURIComponent(this._url.path);h.test(this._url.href)&&(b=b.replace(/^\//,"")),this._setReadableStream(O.createReadStream(b,{start:s,end:l-1}))}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=function y(i,d){return 404===i||0===i&&d.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+d+'".'):new n.UnexpectedResponseException(`Unexpected server response (${i}) while retrieving PDF "${d}".`,i)},e.extractFilenameFromHeader=function L(i){const d=i("Content-Disposition");if(d){let u=(0,f.getFilenameFromContentDispositionHeader)(d);if(u.includes("%"))try{u=decodeURIComponent(u)}catch{}if((0,O.isPdfFile)(u))return u}return null},e.validateRangeRequestCapabilities=function k({getResponseHeader:i,isHttp:d,rangeChunkSize:u,disableRange:g}){const a={allowRangeRequests:!1,suggestedLength:void 0},m=parseInt(i("Content-Length"),10);return!Number.isInteger(m)||(a.suggestedLength=m,m<=2*u)||g||!d||"bytes"!==i("Accept-Ranges")||"identity"!==(i("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a},e.validateResponseStatus=function h(i){return 200===i||206===i};var n=E(1),f=E(34),O=E(8)},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=function f(O){let k=!0,L=y("filename\\*","i").exec(O);if(L){L=L[1];let m=u(L);return m=unescape(m),m=g(m),m=a(m),i(m)}if(L=function d(m){const A=[];let M;const T=y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(M=T.exec(m));){let[,_,s,l]=M;if(_=parseInt(_,10),_ in A){if(0===_)break}else A[_]=[s,l]}const F=[];for(let _=0;_<A.length&&_ in A;++_){let[s,l]=A[_];l=u(l),s&&(l=unescape(l),0===_&&(l=g(l))),F.push(l)}return F.join("")}(O),L)return i(a(L));if(L=y("filename","i").exec(O),L){L=L[1];let m=u(L);return m=a(m),i(m)}function y(m,A){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',A)}function h(m,A){if(m){if(!/^[\x00-\xFF]+$/.test(A))return A;try{const M=new TextDecoder(m,{fatal:!0}),T=(0,n.stringToBytes)(A);A=M.decode(T),k=!1}catch{}}return A}function i(m){return k&&/[\x80-\xff]/.test(m)&&(m=h("utf-8",m),k&&(m=h("iso-8859-1",m))),m}function u(m){if(m.startsWith('"')){const A=m.slice(1).split('\\"');for(let M=0;M<A.length;++M){const T=A[M].indexOf('"');-1!==T&&(A[M]=A[M].slice(0,T),A.length=M+1),A[M]=A[M].replace(/\\(.)/g,"$1")}m=A.join('"')}return m}function g(m){const A=m.indexOf("'");return-1===A?m:h(m.slice(0,A),m.slice(A+1).replace(/^[^']*'/,""))}function a(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(A,M,T,F){if("q"===T||"Q"===T)return h(M,F=(F=F.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(_,s){return String.fromCharCode(parseInt(s,16))}));try{F=atob(F)}catch{}return h(M,F)})}return""};var n=E(1)},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=E(1),f=E(33);class y{constructor(g,a={}){this.url=g,this.isHttp=/^https?:/i.test(g),this.httpHeaders=this.isHttp&&a.httpHeaders||Object.create(null),this.withCredentials=a.withCredentials||!1,this.getXhr=a.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(g,a,m){const A={begin:g,end:a};for(const M in m)A[M]=m[M];return this.request(A)}requestFull(g){return this.request(g)}request(g){const a=this.getXhr(),m=this.currXhrId++,A=this.pendingRequests[m]={xhr:a};a.open("GET",this.url),a.withCredentials=this.withCredentials;for(const M in this.httpHeaders){const T=this.httpHeaders[M];typeof T>"u"||a.setRequestHeader(M,T)}return this.isHttp&&"begin"in g&&"end"in g?(a.setRequestHeader("Range",`bytes=${g.begin}-${g.end-1}`),A.expectedStatus=206):A.expectedStatus=200,a.responseType="arraybuffer",g.onError&&(a.onerror=function(M){g.onError(a.status)}),a.onreadystatechange=this.onStateChange.bind(this,m),a.onprogress=this.onProgress.bind(this,m),A.onHeadersReceived=g.onHeadersReceived,A.onDone=g.onDone,A.onError=g.onError,A.onProgress=g.onProgress,a.send(null),m}onProgress(g,a){const m=this.pendingRequests[g];m&&m.onProgress?.(a)}onStateChange(g,a){const m=this.pendingRequests[g];if(!m)return;const A=m.xhr;if(A.readyState>=2&&m.onHeadersReceived&&(m.onHeadersReceived(),delete m.onHeadersReceived),4!==A.readyState||!(g in this.pendingRequests))return;if(delete this.pendingRequests[g],0===A.status&&this.isHttp)return void m.onError?.(A.status);const M=A.status||200;if((200!==M||206!==m.expectedStatus)&&M!==m.expectedStatus)return void m.onError?.(A.status);const F=function L(u){const g=u.response;return"string"!=typeof g?g:(0,n.stringToBytes)(g).buffer}(A);if(206===M){const _=A.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(_);m.onDone({begin:parseInt(s[1],10),chunk:F})}else F?m.onDone({begin:0,chunk:F}):m.onError?.(A.status)}getRequestXhr(g){return this.pendingRequests[g].xhr}isPendingRequest(g){return g in this.pendingRequests}abortRequest(g){const a=this.pendingRequests[g].xhr;delete this.pendingRequests[g],a.abort()}}e.PDFNetworkStream=class h{constructor(g){this._source=g,this._manager=new y(g.url,{httpHeaders:g.httpHeaders,withCredentials:g.withCredentials}),this._rangeChunkSize=g.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(g){const a=this._rangeRequestReaders.indexOf(g);a>=0&&this._rangeRequestReaders.splice(a,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new i(this._manager,this._source),this._fullRequestReader}getRangeReader(g,a){const m=new d(this._manager,g,a);return m.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(m),m}cancelAllRequests(g){this._fullRequestReader?.cancel(g);for(const a of this._rangeRequestReaders.slice(0))a.cancel(g)}};class i{constructor(g,a){this._manager=g;const m={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=a.url,this._fullRequestId=g.requestFull(m),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=a.disableRange||!1,this._contentLength=a.length,this._rangeChunkSize=a.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const g=this._fullRequestId,a=this._manager.getRequestXhr(g),m=T=>a.getResponseHeader(T),{allowRangeRequests:A,suggestedLength:M}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});A&&(this._isRangeSupported=!0),this._contentLength=M||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(m),this._isRangeSupported&&this._manager.abortRequest(g),this._headersReceivedCapability.resolve()}_onDone(g){if(g&&(this._requests.length>0?this._requests.shift().resolve({value:g.chunk,done:!1}):this._cachedChunks.push(g.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(g){this._storedError=(0,f.createResponseStatusError)(g,this._url),this._headersReceivedCapability.reject(this._storedError);for(const a of this._requests)a.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(g){this.onProgress?.({loaded:g.loaded,total:g.lengthComputable?g.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){var g=this;return _asyncToGenerator(function*(){if(g._storedError)throw g._storedError;if(g._cachedChunks.length>0)return{value:g._cachedChunks.shift(),done:!1};if(g._done)return{value:void 0,done:!0};const a=(0,n.createPromiseCapability)();return g._requests.push(a),a.promise})()}cancel(g){this._done=!0,this._headersReceivedCapability.reject(g);for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(g,a,m){this._manager=g;const A={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._requestId=g.requestRange(a,m,A),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(g){const a=g.chunk;this._requests.length>0?this._requests.shift().resolve({value:a,done:!1}):this._queuedChunk=a,this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(g){this._storedError=(0,f.createResponseStatusError)(g,this._url);for(const a of this._requests)a.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(g){this.isStreamingSupported||this.onProgress?.({loaded:g.loaded})}get isStreamingSupported(){return!1}read(){var g=this;return _asyncToGenerator(function*(){if(g._storedError)throw g._storedError;if(null!==g._queuedChunk){const m=g._queuedChunk;return g._queuedChunk=null,{value:m,done:!1}}if(g._done)return{value:void 0,done:!0};const a=(0,n.createPromiseCapability)();return g._requests.push(a),a.promise})()}cancel(g){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=E(1),f=E(33);function O(i,d,u){return{method:"GET",headers:i,signal:u.signal,mode:"cors",credentials:d?"include":"same-origin",redirect:"follow"}}function k(i){const d=new Headers;for(const u in i){const g=i[u];typeof g>"u"||d.append(u,g)}return d}e.PDFFetchStream=class L{constructor(d){this.source=d,this.isHttp=/^https?:/i.test(d.url),this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(d,u){if(u<=this._progressiveDataLength)return null;const g=new h(this,d,u);return this._rangeRequestReaders.push(g),g}cancelAllRequests(d){this._fullRequestReader&&this._fullRequestReader.cancel(d);for(const u of this._rangeRequestReaders.slice(0))u.cancel(d)}};class y{constructor(d){this._stream=d,this._reader=null,this._loaded=0,this._filename=null;const u=d.source;this._withCredentials=u.withCredentials||!1,this._contentLength=u.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._headers=k(this._stream.httpHeaders);const g=u.url;fetch(g,O(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!(0,f.validateResponseStatus)(a.status))throw(0,f.createResponseStatusError)(a.status,g);this._reader=a.body.getReader(),this._headersCapability.resolve();const m=T=>a.headers.get(T),{allowRangeRequests:A,suggestedLength:M}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=M||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(m),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var d=this;return _asyncToGenerator(function*(){yield d._headersCapability.promise;const{value:u,done:g}=yield d._reader.read();return g?{value:u,done:g}:(d._loaded+=u.byteLength,d.onProgress&&d.onProgress({loaded:d._loaded,total:d._contentLength}),{value:new Uint8Array(u).buffer,done:!1})})()}cancel(d){this._reader&&this._reader.cancel(d),this._abortController.abort()}}class h{constructor(d,u,g){this._stream=d,this._reader=null,this._loaded=0;const a=d.source;this._withCredentials=a.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController,this._headers=k(this._stream.httpHeaders),this._headers.append("Range",`bytes=${u}-${g-1}`);const m=a.url;fetch(m,O(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,f.validateResponseStatus)(A.status))throw(0,f.createResponseStatusError)(A.status,m);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){var d=this;return _asyncToGenerator(function*(){yield d._readCapability.promise;const{value:u,done:g}=yield d._reader.read();return g?{value:u,done:g}:(d._loaded+=u.byteLength,d.onProgress&&d.onProgress({loaded:d._loaded}),{value:new Uint8Array(u).buffer,done:!1})})()}cancel(d){this._reader&&this._reader.cancel(d),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__($){var e=__webpack_module_cache__[$];if(void 0!==e)return e.exports;var E=__webpack_module_cache__[$]={exports:{}};return __webpack_modules__[$](E,E.exports,__w_pdfjs_require__),E.exports}var __nested_webpack_exports__={};return(()=>{var $=__nested_webpack_exports__;Object.defineProperty($,"__esModule",{value:!0}),Object.defineProperty($,"AnnotationEditorLayer",{enumerable:!0,get:function(){return f.AnnotationEditorLayer}}),Object.defineProperty($,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty($,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty($,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return O.AnnotationEditorUIManager}}),Object.defineProperty($,"AnnotationLayer",{enumerable:!0,get:function(){return k.AnnotationLayer}}),Object.defineProperty($,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty($,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty($,"GlobalWorkerOptions",{enumerable:!0,get:function(){return L.GlobalWorkerOptions}}),Object.defineProperty($,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty($,"LoopbackPort",{enumerable:!0,get:function(){return E.LoopbackPort}}),Object.defineProperty($,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty($,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty($,"PDFDataRangeTransport",{enumerable:!0,get:function(){return E.PDFDataRangeTransport}}),Object.defineProperty($,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty($,"PDFWorker",{enumerable:!0,get:function(){return E.PDFWorker}}),Object.defineProperty($,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty($,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty($,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty($,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty($,"SVGGraphics",{enumerable:!0,get:function(){return i.SVGGraphics}}),Object.defineProperty($,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return e.UNSUPPORTED_FEATURES}}),Object.defineProperty($,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty($,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty($,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty($,"XfaLayer",{enumerable:!0,get:function(){return d.XfaLayer}}),Object.defineProperty($,"build",{enumerable:!0,get:function(){return E.build}}),Object.defineProperty($,"createPromiseCapability",{enumerable:!0,get:function(){return e.createPromiseCapability}}),Object.defineProperty($,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty($,"getDocument",{enumerable:!0,get:function(){return E.getDocument}}),Object.defineProperty($,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty($,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty($,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty($,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty($,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty($,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty($,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty($,"version",{enumerable:!0,get:function(){return E.version}});var e=__w_pdfjs_require__(1),E=__w_pdfjs_require__(4),n=__w_pdfjs_require__(8),f=__w_pdfjs_require__(22),O=__w_pdfjs_require__(7),k=__w_pdfjs_require__(27),L=__w_pdfjs_require__(15),y=__w_pdfjs_require__(3),h=__w_pdfjs_require__(30),i=__w_pdfjs_require__(31),d=__w_pdfjs_require__(29);if(y.isNodeJS){const{PDFNodeStream:a}=__w_pdfjs_require__(32);(0,E.setPDFNetworkStreamFactory)(m=>new a(m))}else{const{PDFNetworkStream:a}=__w_pdfjs_require__(35),{PDFFetchStream:m}=__w_pdfjs_require__(36);(0,E.setPDFNetworkStreamFactory)(A=>(0,n.isValidFetchUrl)(A.url)?new m(A):new a(A))}})(),__nested_webpack_exports__})(),module.exports=E()},17640:()=>{},23237:()=>{},97492:()=>{},31815:()=>{},66671:()=>{},82787:()=>{},29293:$=>{function e(n,f,O,k,L,y,h){try{var i=n[y](h),d=i.value}catch(u){return void O(u)}i.done?f(d):Promise.resolve(d).then(k,L)}$.exports=function E(n){return function(){var f=this,O=arguments;return new Promise(function(k,L){var y=n.apply(f,O);function h(d){e(y,k,L,h,i,"next",d)}function i(d){e(y,k,L,h,i,"throw",d)}h(void 0)})}},$.exports.__esModule=!0,$.exports.default=$.exports}}]);